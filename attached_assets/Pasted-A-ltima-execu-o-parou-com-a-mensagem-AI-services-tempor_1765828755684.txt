A √∫ltima execu√ß√£o parou com a mensagem:

"AI services temporarily unavailable. Please try again later."

Isso aconteceu quando voc√™ estava:

- Ajustando `server/storage.ts` para adicionar o m√©todo `getPushAnalysis`.
- Corrigindo a chamada de `archiveUserActivePlans` para o m√©todo real `archiveOldPlans` nas rotas de treinamento.
- Criando/ajustando os endpoints de treinamento em `server/routes.ts`.

Quero que voc√™ agora fa√ßa o seguinte, em ORDEM:

1) **Sanidade de c√≥digo (storage + rotas)**

- Abrir `shared/schema.ts`, `server/storage.ts` e `server/routes.ts`.
- Verificar se na √∫ltima edi√ß√£o algo ficou:
  - Incompleto,
  - Com nome de m√©todo divergente entre interface e implementa√ß√£o,
  - Com m√©todos chamados nas rotas que n√£o existem no storage.

Especificamente:

- Garantir que `server/storage.ts` tenha:
  - Os m√©todos relacionados a push analysis (ex.: `getPushAnalysis`, se realmente precisamos).
  - Os m√©todos de training (`getTrainingPlans`, `createTrainingPlan`, `createTrainingDrills`, `updateTrainingDrill`, `archiveOldPlans` ou equivalente).
  - Interface e implementa√ß√£o alinhadas (sem m√©todos declarados s√≥ na interface ou s√≥ na implementa√ß√£o).

- Garantir que `server/routes.ts`:
  - Esteja importando os m√©todos corretos do storage.
  - N√£o chame `archiveUserActivePlans` se o m√©todo real chama `archiveOldPlans` (usar um nome s√≥, consistente).
  - Tenha rotas completas para:
    - `GET /api/training/plans`
    - `POST /api/training/generate-from-last-push`
    - `PATCH /api/training/drills/:id`

2) **Finalizar endpoints do Centro de Treinamento**

Com base no schema e no `server/openai.ts`:

- `GET /api/training/plans`:
  - Retorna o plano ativo do usu√°rio + drills.
  - Respeita limites FREE/PRO ao decidir o que mostrar (mas n√£o precisa bloquear leitura).

- `POST /api/training/generate-from-last-push`:
  - Usa o √∫ltimo push (e, se existir, a √∫ltima push analysis) para gerar um plano de treino:
    - Chama uma fun√ß√£o `generateTrainingPlan` em `server/openai.ts` ou similar.
    - Antes de criar, arquiva planos antigos se a regra for ‚Äús√≥ 1 plano ativo‚Äù para FREE.
  - Aplica limites:
    - FREE: 1 plano com at√© 3 drills.
    - PRO: permitir mais (deixe preparado; se quiser, pode s√≥ n√£o bloquear por enquanto, mas documente).

- `PATCH /api/training/drills/:id`:
  - Permite:
    - Atualizar `status` (`pending` ‚Üí `in_progress` ‚Üí `completed`).
    - Atualizar `completed_games`.
  - Checa se o `drill` pertence ao user autenticado.

3) **Conferir integra√ß√£o com Push Analysis**

- Verificar `server/openai.ts` e `server/routes.ts`:
  - O endpoint de push analysis deve:
    - Pegar o √∫ltimo push.
    - Gerar `PushAnalysisResult` via LLM.
    - (Opcional) salvar em `push_analyses`.
  - O endpoint de treino (`generate-from-last-push`) pode:
    - Usar o resultado da an√°lise de push para gerar drills, em vez de reanalisar tudo do zero (se voc√™ j√° implementou isso).

4) **Rodar checagem de build/type**

- Rodar:
  - `npm run lint` (se existir),
  - `npm run build`
- Corrigir todos os erros de TypeScript, imports quebrados, tipos incompat√≠veis entre storage e rotas.

5) **Verificar rapidamente os fluxos no front**

Usando o c√≥digo atual (que voc√™ j√° alterou):

- `/me`:
  - Bot√£o ‚ÄúAtualizar dados‚Äù chama `/api/player/sync` e atualiza stats/push.
  - ArenaProgressBar aparece com progresso correto.
  - PushAnalysisCard √© exibido quando houver an√°lise de push.

- `/coach`:
  - FREE consegue mandar mensagens at√© o limite di√°rio (5).
  - Ao chegar no limite, aparece o banner de limite + CTA de upgrade.
  - Perguntas tipo ‚Äúpor que perdi a √∫ltima partida?‚Äù usam o last battle context.

- `/training` (ou onde estiver o Centro de Treinamento):
  - Se existir plano ativo:
    - Lista drills, permite marcar progresso/conclu√≠do.
  - Se n√£o existir:
    - Mostra estado vazio sugerindo jogar um push + atualizar dados.

6) **i18n e ajuste final**

- Todas as novas strings:
  - Bot√£o ‚ÄúAtualizar dados‚Äù,
  - Texto da √∫ltima atualiza√ß√£o,
  - Mensagens de limite FREE,
  - Tilt warning,
  - Barra de arena,
  - An√°lise de push,
  - Centro de Treinamento,
- Devem estar nos arquivos de tradu√ß√£o PT-BR e EN-US (`shared/i18n/translations/...`).

üëâ No final, me d√™ um resumo curto do que voc√™ ajustou nesta rodada:
- Quais arquivos principais mexeu (schema, storage, routes, openai, pages/components).
- Como testar rapidamente:
  - Sync,
  - Coach (FREE limit + ‚Äúpor que perdi a √∫ltima partida?‚Äù),
  - Push analysis,
  - Centro de Treinamento (gerar plano + atualizar drill).
