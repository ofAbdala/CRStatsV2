{"file_contents":{"server/routes.ts":{"content":"// From javascript_log_in_with_replit blueprint\nimport type { Express } from \"express\";\nimport { type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\nimport { getPlayerByTag, getPlayerBattles, getCards } from \"./clashRoyaleApi\";\nimport { generateCoachResponse, ChatMessage } from \"./openai\";\nimport { stripeService } from \"./stripeService\";\nimport { getStripePublishableKey } from \"./stripeClient\";\nimport { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nconst FREE_DAILY_LIMIT = 5;\n\nfunction computeTiltLevel(battles: any[]): 'high' | 'medium' | 'none' {\n  if (!battles || battles.length === 0) return 'none';\n  \n  const last10 = battles.slice(0, 10);\n  \n  let wins = 0;\n  let losses = 0;\n  let netTrophies = 0;\n  let consecutiveLosses = 0;\n  let maxConsecutiveLosses = 0;\n  \n  for (const battle of last10) {\n    const isVictory = battle.team?.[0]?.crowns > battle.opponent?.[0]?.crowns;\n    const trophyChange = battle.team?.[0]?.trophyChange || 0;\n    \n    if (isVictory) {\n      wins++;\n      consecutiveLosses = 0;\n    } else {\n      losses++;\n      consecutiveLosses++;\n      maxConsecutiveLosses = Math.max(maxConsecutiveLosses, consecutiveLosses);\n    }\n    netTrophies += trophyChange;\n  }\n  \n  const winRate = last10.length > 0 ? (wins / last10.length) * 100 : 50;\n  \n  if (maxConsecutiveLosses >= 3 || (winRate < 40 && netTrophies <= -60)) {\n    return 'high';\n  }\n  \n  if (winRate >= 40 && winRate <= 50 && netTrophies < 0) {\n    return 'medium';\n  }\n  \n  return 'none';\n}\n\ninterface PushSession {\n  startTime: Date;\n  endTime: Date;\n  battles: any[];\n  wins: number;\n  losses: number;\n  winRate: number;\n  netTrophies: number;\n}\n\nfunction computePushSessions(battles: any[]): PushSession[] {\n  if (!battles || battles.length < 2) return [];\n  \n  const sortedBattles = [...battles].sort((a, b) => \n    new Date(b.battleTime).getTime() - new Date(a.battleTime).getTime()\n  );\n  \n  const sessions: PushSession[] = [];\n  let currentSession: any[] = [];\n  \n  for (let i = 0; i < sortedBattles.length; i++) {\n    const battle = sortedBattles[i];\n    const battleTime = new Date(battle.battleTime);\n    \n    if (currentSession.length === 0) {\n      currentSession.push(battle);\n    } else {\n      const lastBattle = currentSession[currentSession.length - 1];\n      const lastBattleTime = new Date(lastBattle.battleTime);\n      const timeDiff = lastBattleTime.getTime() - battleTime.getTime();\n      const thirtyMinutes = 30 * 60 * 1000;\n      \n      if (timeDiff <= thirtyMinutes) {\n        currentSession.push(battle);\n      } else {\n        if (currentSession.length >= 2) {\n          sessions.push(createSessionFromBattles(currentSession));\n        }\n        currentSession = [battle];\n      }\n    }\n  }\n  \n  if (currentSession.length >= 2) {\n    sessions.push(createSessionFromBattles(currentSession));\n  }\n  \n  return sessions;\n}\n\nfunction createSessionFromBattles(battles: any[]): PushSession {\n  let wins = 0;\n  let losses = 0;\n  let netTrophies = 0;\n  \n  for (const battle of battles) {\n    const isVictory = battle.team?.[0]?.crowns > battle.opponent?.[0]?.crowns;\n    const trophyChange = battle.team?.[0]?.trophyChange || 0;\n    \n    if (isVictory) {\n      wins++;\n    } else {\n      losses++;\n    }\n    netTrophies += trophyChange;\n  }\n  \n  const battleTimes = battles.map(b => new Date(b.battleTime));\n  const startTime = new Date(Math.min(...battleTimes.map(t => t.getTime())));\n  const endTime = new Date(Math.max(...battleTimes.map(t => t.getTime())));\n  \n  return {\n    startTime,\n    endTime,\n    battles,\n    wins,\n    losses,\n    winRate: battles.length > 0 ? (wins / battles.length) * 100 : 0,\n    netTrophies,\n  };\n}\n\nfunction computeBattleStats(battles: any[]) {\n  if (!battles || battles.length === 0) {\n    return {\n      totalMatches: 0,\n      wins: 0,\n      losses: 0,\n      winRate: 0,\n      streak: { type: 'none' as const, count: 0 },\n      tiltLevel: 'none' as const,\n    };\n  }\n  \n  let wins = 0;\n  let losses = 0;\n  let streakType: 'win' | 'loss' | 'none' = 'none';\n  let streakCount = 0;\n  let currentStreakType: 'win' | 'loss' | null = null;\n  \n  for (let i = 0; i < battles.length; i++) {\n    const battle = battles[i];\n    const isVictory = battle.team?.[0]?.crowns > battle.opponent?.[0]?.crowns;\n    \n    if (isVictory) {\n      wins++;\n      if (currentStreakType === 'win') {\n        streakCount++;\n      } else if (currentStreakType === null) {\n        currentStreakType = 'win';\n        streakCount = 1;\n      }\n    } else {\n      losses++;\n      if (currentStreakType === 'loss') {\n        streakCount++;\n      } else if (currentStreakType === null) {\n        currentStreakType = 'loss';\n        streakCount = 1;\n      }\n    }\n    \n    if (i === 0) {\n      streakType = isVictory ? 'win' : 'loss';\n      streakCount = 1;\n      currentStreakType = streakType;\n    } else if (currentStreakType !== null) {\n      const prevIsVictory = battles[i - 1].team?.[0]?.crowns > battles[i - 1].opponent?.[0]?.crowns;\n      if ((isVictory && prevIsVictory) || (!isVictory && !prevIsVictory)) {\n        if (i === 1 || streakType === (isVictory ? 'win' : 'loss')) {\n          streakCount++;\n        }\n      } else {\n        break;\n      }\n    }\n  }\n  \n  let currentStreak = 0;\n  let currentType: 'win' | 'loss' | 'none' = 'none';\n  for (const battle of battles) {\n    const isVictory = battle.team?.[0]?.crowns > battle.opponent?.[0]?.crowns;\n    const battleType = isVictory ? 'win' : 'loss';\n    \n    if (currentType === 'none') {\n      currentType = battleType;\n      currentStreak = 1;\n    } else if (currentType === battleType) {\n      currentStreak++;\n    } else {\n      break;\n    }\n  }\n  \n  return {\n    totalMatches: battles.length,\n    wins,\n    losses,\n    winRate: battles.length > 0 ? (wins / battles.length) * 100 : 0,\n    streak: { type: currentType, count: currentStreak },\n    tiltLevel: computeTiltLevel(battles),\n  };\n}\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  // Setup authentication middleware\n  await setupAuth(app);\n\n  // ============================================================================\n  // AUTH ROUTES\n  // ============================================================================\n  \n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      // Get associated data\n      const profile = await storage.getProfile(userId);\n      const subscription = await storage.getSubscription(userId);\n      const settings = await storage.getUserSettings(userId);\n\n      res.json({\n        ...user,\n        profile,\n        subscription,\n        settings,\n      });\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // ============================================================================\n  // PROFILE ROUTES\n  // ============================================================================\n  \n  app.get('/api/profile', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const profile = await storage.getProfile(userId);\n      res.json(profile);\n    } catch (error) {\n      console.error(\"Error fetching profile:\", error);\n      res.status(500).json({ message: \"Failed to fetch profile\" });\n    }\n  });\n\n  app.post('/api/profile', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const profile = await storage.createProfile({ userId, ...req.body });\n      res.json(profile);\n    } catch (error) {\n      console.error(\"Error creating profile:\", error);\n      res.status(500).json({ message: \"Failed to create profile\" });\n    }\n  });\n\n  app.patch('/api/profile', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const profile = await storage.updateProfile(userId, req.body);\n      res.json(profile);\n    } catch (error) {\n      console.error(\"Error updating profile:\", error);\n      res.status(500).json({ message: \"Failed to update profile\" });\n    }\n  });\n\n  // ============================================================================\n  // SUBSCRIPTION ROUTES\n  // ============================================================================\n  \n  app.get('/api/subscription', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const subscription = await storage.getSubscription(userId);\n      \n      if (!subscription) {\n        return res.json({ plan: 'free', status: 'inactive' });\n      }\n\n      res.json(subscription);\n    } catch (error) {\n      console.error(\"Error fetching subscription:\", error);\n      res.status(500).json({ message: \"Failed to fetch subscription\" });\n    }\n  });\n\n  // ============================================================================\n  // GOALS ROUTES\n  // ============================================================================\n  \n  app.get('/api/goals', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const goals = await storage.getGoals(userId);\n      res.json(goals);\n    } catch (error) {\n      console.error(\"Error fetching goals:\", error);\n      res.status(500).json({ message: \"Failed to fetch goals\" });\n    }\n  });\n\n  app.post('/api/goals', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const goal = await storage.createGoal({ userId, ...req.body });\n      res.json(goal);\n    } catch (error) {\n      console.error(\"Error creating goal:\", error);\n      res.status(500).json({ message: \"Failed to create goal\" });\n    }\n  });\n\n  app.patch('/api/goals/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const goal = await storage.updateGoal(id, req.body);\n      res.json(goal);\n    } catch (error) {\n      console.error(\"Error updating goal:\", error);\n      res.status(500).json({ message: \"Failed to update goal\" });\n    }\n  });\n\n  app.delete('/api/goals/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      await storage.deleteGoal(id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting goal:\", error);\n      res.status(500).json({ message: \"Failed to delete goal\" });\n    }\n  });\n\n  // ============================================================================\n  // FAVORITE PLAYERS ROUTES\n  // ============================================================================\n  \n  app.get('/api/favorites', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const favorites = await storage.getFavoritePlayers(userId);\n      res.json(favorites);\n    } catch (error) {\n      console.error(\"Error fetching favorites:\", error);\n      res.status(500).json({ message: \"Failed to fetch favorites\" });\n    }\n  });\n\n  app.post('/api/favorites', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const favorite = await storage.createFavoritePlayer({ userId, ...req.body });\n      res.json(favorite);\n    } catch (error) {\n      console.error(\"Error creating favorite:\", error);\n      res.status(500).json({ message: \"Failed to create favorite\" });\n    }\n  });\n\n  app.delete('/api/favorites/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      await storage.deleteFavoritePlayer(id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting favorite:\", error);\n      res.status(500).json({ message: \"Failed to delete favorite\" });\n    }\n  });\n\n  // ============================================================================\n  // NOTIFICATIONS ROUTES\n  // ============================================================================\n  \n  app.get('/api/notifications', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const notifications = await storage.getNotifications(userId);\n      res.json(notifications);\n    } catch (error) {\n      console.error(\"Error fetching notifications:\", error);\n      res.status(500).json({ message: \"Failed to fetch notifications\" });\n    }\n  });\n\n  app.post('/api/notifications/:id/read', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      await storage.markNotificationAsRead(id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error marking notification as read:\", error);\n      res.status(500).json({ message: \"Failed to mark notification as read\" });\n    }\n  });\n\n  // ============================================================================\n  // USER SETTINGS ROUTES\n  // ============================================================================\n  \n  app.get('/api/settings', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const settings = await storage.getUserSettings(userId);\n      res.json(settings);\n    } catch (error) {\n      console.error(\"Error fetching settings:\", error);\n      res.status(500).json({ message: \"Failed to fetch settings\" });\n    }\n  });\n\n  app.patch('/api/settings', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const settings = await storage.updateUserSettings(userId, req.body);\n      res.json(settings);\n    } catch (error) {\n      console.error(\"Error updating settings:\", error);\n      res.status(500).json({ message: \"Failed to update settings\" });\n    }\n  });\n\n  // ============================================================================\n  // CLASH ROYALE API ROUTES\n  // ============================================================================\n  \n  app.get('/api/clash/player/:tag', async (req: any, res) => {\n    try {\n      const { tag } = req.params;\n      const result = await getPlayerByTag(tag);\n      \n      if (result.error) {\n        return res.status(result.status).json({ error: result.error });\n      }\n\n      res.json(result.data);\n    } catch (error) {\n      console.error(\"Error fetching player:\", error);\n      res.status(500).json({ error: \"Failed to fetch player data\" });\n    }\n  });\n\n  app.get('/api/clash/player/:tag/battles', async (req: any, res) => {\n    try {\n      const { tag } = req.params;\n      const result = await getPlayerBattles(tag);\n      \n      if (result.error) {\n        return res.status(result.status).json({ error: result.error });\n      }\n\n      res.json(result.data);\n    } catch (error) {\n      console.error(\"Error fetching battles:\", error);\n      res.status(500).json({ error: \"Failed to fetch battle history\" });\n    }\n  });\n\n  app.get('/api/clash/cards', async (req: any, res) => {\n    try {\n      const result = await getCards();\n      \n      if (result.error) {\n        return res.status(result.status).json({ error: result.error });\n      }\n\n      res.json(result.data);\n    } catch (error) {\n      console.error(\"Error fetching cards:\", error);\n      res.status(500).json({ error: \"Failed to fetch cards\" });\n    }\n  });\n\n  // ============================================================================\n  // PLAYER SYNC ROUTES\n  // ============================================================================\n  \n  app.post('/api/player/sync', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      \n      const profile = await storage.getProfile(userId);\n      if (!profile?.clashTag) {\n        return res.status(400).json({ \n          error: \"No Clash Royale tag linked to your profile\",\n          code: \"NO_CLASH_TAG\" \n        });\n      }\n      \n      const playerResult = await getPlayerByTag(profile.clashTag);\n      if (playerResult.error) {\n        return res.status(playerResult.status).json({ error: playerResult.error });\n      }\n      \n      const battlesResult = await getPlayerBattles(profile.clashTag);\n      if (battlesResult.error) {\n        return res.status(battlesResult.status).json({ error: battlesResult.error });\n      }\n      \n      const player = playerResult.data as any;\n      const battles = (battlesResult.data as any[]) || [];\n      \n      const pushSessions = computePushSessions(battles);\n      const stats = computeBattleStats(battles);\n      \n      const syncState = await storage.updateSyncState(userId);\n      \n      const goals = await storage.getGoals(userId);\n      \n      res.json({\n        player: {\n          tag: player.tag,\n          name: player.name,\n          trophies: player.trophies,\n          arena: player.arena,\n          expLevel: player.expLevel,\n          clan: player.clan,\n          currentDeck: player.currentDeck,\n          bestTrophies: player.bestTrophies,\n          wins: player.wins,\n          losses: player.losses,\n          battleCount: player.battleCount,\n        },\n        battles,\n        pushSessions,\n        stats,\n        lastSyncedAt: syncState.lastSyncedAt,\n        goals,\n      });\n    } catch (error) {\n      console.error(\"Error syncing player data:\", error);\n      res.status(500).json({ error: \"Failed to sync player data\" });\n    }\n  });\n\n  app.get('/api/player/sync-state', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const syncState = await storage.getSyncState(userId);\n      \n      res.json({\n        lastSyncedAt: syncState?.lastSyncedAt || null,\n      });\n    } catch (error) {\n      console.error(\"Error fetching sync state:\", error);\n      res.status(500).json({ error: \"Failed to fetch sync state\" });\n    }\n  });\n\n  // ============================================================================\n  // STRIPE BILLING ROUTES\n  // ============================================================================\n  \n  app.get('/api/stripe/config', async (req, res) => {\n    try {\n      if (!process.env.REPLIT_CONNECTORS_HOSTNAME) {\n        return res.status(503).json({ error: \"Stripe not configured\" });\n      }\n      const publishableKey = await getStripePublishableKey();\n      res.json({ publishableKey });\n    } catch (error) {\n      console.error(\"Error fetching Stripe config:\", error);\n      res.status(500).json({ error: \"Failed to fetch Stripe configuration\" });\n    }\n  });\n\n  app.get('/api/stripe/products', async (req, res) => {\n    try {\n      if (!process.env.REPLIT_CONNECTORS_HOSTNAME) {\n        return res.status(503).json({ error: \"Stripe not configured\", data: [] });\n      }\n      const result = await db.execute(\n        sql`SELECT * FROM stripe.products WHERE active = true`\n      );\n      res.json({ data: result.rows });\n    } catch (error) {\n      console.error(\"Error fetching products:\", error);\n      res.status(500).json({ error: \"Failed to fetch products\" });\n    }\n  });\n\n  app.get('/api/stripe/prices', async (req, res) => {\n    try {\n      if (!process.env.REPLIT_CONNECTORS_HOSTNAME) {\n        return res.status(503).json({ error: \"Stripe not configured\", data: [] });\n      }\n      const result = await db.execute(\n        sql`SELECT * FROM stripe.prices WHERE active = true`\n      );\n      res.json({ data: result.rows });\n    } catch (error) {\n      console.error(\"Error fetching prices:\", error);\n      res.status(500).json({ error: \"Failed to fetch prices\" });\n    }\n  });\n\n  app.get('/api/stripe/products-with-prices', async (req, res) => {\n    try {\n      if (!process.env.REPLIT_CONNECTORS_HOSTNAME) {\n        return res.status(503).json({ error: \"Stripe not configured\", data: [] });\n      }\n      const result = await db.execute(\n        sql`\n          SELECT \n            p.id as product_id,\n            p.name as product_name,\n            p.description as product_description,\n            p.active as product_active,\n            p.metadata as product_metadata,\n            pr.id as price_id,\n            pr.unit_amount,\n            pr.currency,\n            pr.recurring,\n            pr.active as price_active\n          FROM stripe.products p\n          LEFT JOIN stripe.prices pr ON pr.product = p.id AND pr.active = true\n          WHERE p.active = true\n          ORDER BY p.id, pr.unit_amount\n        `\n      );\n\n      const productsMap = new Map();\n      for (const row of result.rows as any[]) {\n        if (!productsMap.has(row.product_id)) {\n          productsMap.set(row.product_id, {\n            id: row.product_id,\n            name: row.product_name,\n            description: row.product_description,\n            active: row.product_active,\n            metadata: row.product_metadata,\n            prices: []\n          });\n        }\n        if (row.price_id) {\n          productsMap.get(row.product_id).prices.push({\n            id: row.price_id,\n            unit_amount: row.unit_amount,\n            currency: row.currency,\n            recurring: row.recurring,\n            active: row.price_active,\n          });\n        }\n      }\n\n      res.json({ data: Array.from(productsMap.values()) });\n    } catch (error) {\n      console.error(\"Error fetching products with prices:\", error);\n      res.status(500).json({ error: \"Failed to fetch products\" });\n    }\n  });\n\n  app.post('/api/stripe/checkout', isAuthenticated, async (req: any, res) => {\n    try {\n      if (!process.env.REPLIT_CONNECTORS_HOSTNAME) {\n        return res.status(503).json({ error: \"Stripe not configured\" });\n      }\n\n      const userId = req.user.claims.sub;\n      const { priceId, currency } = req.body;\n\n      if (!priceId) {\n        return res.status(400).json({ error: \"Price ID is required\" });\n      }\n\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n\n      const customerId = await stripeService.getOrCreateCustomer(userId, user.email || '');\n\n      const domains = process.env.REPLIT_DOMAINS?.split(',')[0];\n      const baseUrl = domains ? `https://${domains}` : (process.env.APP_BASE_URL || 'http://localhost:5000');\n      const session = await stripeService.createCheckoutSession(\n        customerId,\n        priceId,\n        `${baseUrl}/billing?success=true`,\n        `${baseUrl}/billing?canceled=true`,\n        userId\n      );\n\n      res.json({ url: session.url });\n    } catch (error) {\n      console.error(\"Error creating checkout session:\", error);\n      res.status(500).json({ error: \"Failed to create checkout session\" });\n    }\n  });\n\n  app.post('/api/stripe/portal', isAuthenticated, async (req: any, res) => {\n    try {\n      if (!process.env.REPLIT_CONNECTORS_HOSTNAME) {\n        return res.status(503).json({ error: \"Stripe not configured\" });\n      }\n\n      const userId = req.user.claims.sub;\n      const subscription = await storage.getSubscription(userId);\n\n      if (!subscription?.stripeCustomerId) {\n        return res.status(400).json({ error: \"No subscription found\" });\n      }\n\n      const domains = process.env.REPLIT_DOMAINS?.split(',')[0];\n      const baseUrl = domains ? `https://${domains}` : (process.env.APP_BASE_URL || 'http://localhost:5000');\n      const session = await stripeService.createCustomerPortalSession(\n        subscription.stripeCustomerId,\n        `${baseUrl}/billing`\n      );\n\n      res.json({ url: session.url });\n    } catch (error) {\n      console.error(\"Error creating portal session:\", error);\n      res.status(500).json({ error: \"Failed to create customer portal session\" });\n    }\n  });\n\n  // ============================================================================\n  // STRIPE WEBHOOK ROUTES (for subscription activation)\n  // ============================================================================\n  \n  app.post('/api/stripe/webhook', async (req: any, res) => {\n    try {\n      const event = req.body;\n      \n      if (!event || !event.type) {\n        return res.status(400).json({ error: \"Invalid webhook payload\" });\n      }\n\n      console.log(`Stripe webhook received: ${event.type}`);\n\n      switch (event.type) {\n        case 'checkout.session.completed': {\n          const session = event.data?.object;\n          if (session?.metadata?.userId && session?.subscription) {\n            const userId = session.metadata.userId;\n            const subscription = await storage.getSubscription(userId);\n            \n            if (subscription) {\n              await storage.updateSubscription(subscription.id, {\n                stripeSubscriptionId: session.subscription,\n                plan: 'pro',\n                status: 'active',\n              });\n              console.log(`PRO activated for user: ${userId}`);\n            }\n          }\n          break;\n        }\n        \n        case 'customer.subscription.updated': {\n          const subscriptionData = event.data?.object;\n          if (subscriptionData?.id) {\n            const existing = await storage.getSubscriptionByStripeId(subscriptionData.id);\n            if (existing) {\n              const status = subscriptionData.status === 'active' ? 'active' : \n                            subscriptionData.status === 'canceled' ? 'canceled' : \n                            subscriptionData.status;\n              await storage.updateSubscription(existing.id, {\n                status: status,\n              });\n              console.log(`Subscription ${subscriptionData.id} updated to: ${status}`);\n            }\n          }\n          break;\n        }\n        \n        case 'customer.subscription.deleted': {\n          const subscriptionData = event.data?.object;\n          if (subscriptionData?.id) {\n            const existing = await storage.getSubscriptionByStripeId(subscriptionData.id);\n            if (existing) {\n              await storage.updateSubscription(existing.id, {\n                plan: 'free',\n                status: 'canceled',\n              });\n              console.log(`Subscription ${subscriptionData.id} canceled`);\n            }\n          }\n          break;\n        }\n        \n        default:\n          console.log(`Unhandled webhook event type: ${event.type}`);\n      }\n\n      res.json({ received: true });\n    } catch (error) {\n      console.error(\"Error processing webhook:\", error);\n      res.status(500).json({ error: \"Webhook processing failed\" });\n    }\n  });\n\n  // ============================================================================\n  // AI COACH ROUTES\n  // ============================================================================\n  \n  app.post('/api/coach/chat', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      \n      const isPro = await storage.isPro(userId);\n      \n      if (!isPro) {\n        const messagesToday = await storage.countCoachMessagesToday(userId);\n        if (messagesToday >= FREE_DAILY_LIMIT) {\n          return res.status(403).json({ \n            error: \"Daily message limit reached. Upgrade to PRO for unlimited coaching.\",\n            code: \"FREE_COACH_DAILY_LIMIT_REACHED\",\n            limit: FREE_DAILY_LIMIT,\n            used: messagesToday,\n          });\n        }\n      }\n      \n      const { messages, playerTag, contextType } = req.body as { \n        messages: ChatMessage[]; \n        playerTag?: string;\n        contextType?: string;\n      };\n\n      if (!messages || !Array.isArray(messages) || messages.length === 0) {\n        return res.status(400).json({ error: \"Messages array is required\" });\n      }\n\n      const lastUserMessage = messages.filter(m => m.role === 'user').pop();\n      if (!lastUserMessage) {\n        return res.status(400).json({ error: \"At least one user message is required\" });\n      }\n\n      let playerContext: any = {};\n\n      try {\n        if (playerTag) {\n          const playerResult = await getPlayerByTag(playerTag);\n          if (playerResult.data) {\n            const player = playerResult.data as any;\n            playerContext = {\n              playerTag: player.tag,\n              trophies: player.trophies,\n              arena: player.arena?.name,\n              currentDeck: player.currentDeck?.map((c: any) => c.name),\n            };\n\n            const battlesResult = await getPlayerBattles(playerTag);\n            if (battlesResult.data) {\n              playerContext.recentBattles = (battlesResult.data as any[]).slice(0, 5);\n            }\n          }\n        } else {\n          const profile = await storage.getProfile(userId);\n          if (profile?.clashTag) {\n            const playerResult = await getPlayerByTag(profile.clashTag);\n            if (playerResult.data) {\n              const player = playerResult.data as any;\n              playerContext = {\n                playerTag: player.tag,\n                trophies: player.trophies,\n                arena: player.arena?.name,\n                currentDeck: player.currentDeck?.map((c: any) => c.name),\n              };\n            }\n          }\n        }\n      } catch (contextError) {\n        console.warn(\"Failed to fetch player context, continuing without it:\", contextError);\n      }\n\n      const aiResponse = await generateCoachResponse(messages, playerContext);\n      \n      await storage.createCoachMessage({\n        userId,\n        role: 'user',\n        content: lastUserMessage.content,\n        contextType: contextType || null,\n      });\n      \n      await storage.createCoachMessage({\n        userId,\n        role: 'assistant',\n        content: aiResponse,\n        contextType: contextType || null,\n      });\n      \n      const remainingMessages = isPro ? null : FREE_DAILY_LIMIT - (await storage.countCoachMessagesToday(userId));\n      \n      res.json({ \n        message: aiResponse,\n        timestamp: new Date().toISOString(),\n        remainingMessages,\n      });\n    } catch (error) {\n      console.error(\"Error in coach chat:\", error);\n      res.status(500).json({ error: \"Failed to generate coach response\" });\n    }\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":30041,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/pages/training.tsx":{"content":"import React from \"react\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Target, Swords, Shield, Zap, CheckCircle2, Lock } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\n\nexport default function TrainingPage() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <DashboardLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-foreground\">Centro de Treinamento</h1>\n          <p className=\"text-muted-foreground\">Exercícios personalizados pela IA baseados nas suas fraquezas.</p>\n        </div>\n\n        {/* Active Drills */}\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n          <DrillCard \n            title=\"Posicionamento Defensivo\"\n            description=\"Você tem tomado muito dano de Corredor. Pratique o posicionamento 4-3 do Canhão.\"\n            difficulty=\"Médio\"\n            type=\"Defesa\"\n            progress={60}\n            icon={<Shield className=\"w-5 h-5 text-blue-400\" />}\n          />\n          <DrillCard \n            title=\"Timing de Feitiços\"\n            description=\"Seus Zaps estão atrasados contra Barril de Goblins. Melhore seu tempo de reação.\"\n            difficulty=\"Difícil\"\n            type=\"Micro\"\n            progress={30}\n            icon={<Zap className=\"w-5 h-5 text-yellow-400\" />}\n          />\n          <DrillCard \n            title=\"Controle de Elixir\"\n            description=\"Evite vazar elixir no início da partida. Mantenha o fluxo constante.\"\n            difficulty=\"Fácil\"\n            type=\"Macro\"\n            progress={90}\n            icon={<Target className=\"w-5 h-5 text-green-400\" />}\n          />\n        </div>\n\n        {/* Locked/Pro Content */}\n        <div className=\"mt-12\">\n          <h2 className=\"text-xl font-display font-bold mb-4 flex items-center gap-2\">\n            Treinos Avançados <Badge variant=\"secondary\" className=\"text-xs\">PRO</Badge>\n          </h2>\n          <Card className=\"border-border/50 bg-card/30 border-dashed relative overflow-hidden group cursor-pointer\" onClick={() => setLocation(\"/profile\")}>\n            <div className=\"absolute inset-0 bg-background/60 backdrop-blur-[2px] z-10 flex flex-col items-center justify-center p-6 text-center transition-all group-hover:bg-background/50\">\n              <div className=\"w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform\">\n                <Lock className=\"w-6 h-6 text-primary\" />\n              </div>\n              <h3 className=\"text-lg font-bold mb-2\">Desbloqueie o Potencial Máximo</h3>\n              <p className=\"text-muted-foreground max-w-md mb-6\">\n                Assinantes PRO têm acesso a cenários específicos de matchups e análise de replay quadro a quadro.\n              </p>\n              <Button className=\"font-bold interactive-hover shadow-lg shadow-primary/20\">Fazer Upgrade</Button>\n            </div>\n            \n            <CardContent className=\"p-6 opacity-50 blur-sm pointer-events-none\">\n              <div className=\"space-y-4\">\n                <div className=\"h-24 bg-muted rounded-lg w-full\" />\n                <div className=\"h-24 bg-muted rounded-lg w-full\" />\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </DashboardLayout>\n  );\n}\n\nfunction DrillCard({ title, description, difficulty, type, progress, icon }: any) {\n  const [location, setLocation] = useLocation();\n\n  return (\n    <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm hover:border-primary/50 transition-all hover:-translate-y-1 cursor-pointer interactive-hover\" onClick={() => setLocation(\"/coach\")}>\n      <CardHeader>\n        <div className=\"flex justify-between items-start mb-2\">\n          <div className=\"p-2 rounded-lg bg-background border border-border\">\n            {icon}\n          </div>\n          <Badge variant=\"outline\" className={\n            difficulty === \"Fácil\" ? \"text-green-400 border-green-400/30\" :\n            difficulty === \"Médio\" ? \"text-yellow-400 border-yellow-400/30\" :\n            \"text-red-400 border-red-400/30\"\n          }>{difficulty}</Badge>\n        </div>\n        <CardTitle className=\"text-lg leading-tight\">{title}</CardTitle>\n        <CardDescription className=\"line-clamp-2 mt-1.5\">{description}</CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-2\">\n          <div className=\"flex justify-between text-xs text-muted-foreground\">\n            <span>Progresso</span>\n            <span>{progress}%</span>\n          </div>\n          <Progress value={progress} className=\"h-2\" />\n        </div>\n      </CardContent>\n      <CardFooter>\n        <Button className=\"w-full interactive-hover\" variant={progress === 100 ? \"outline\" : \"default\"}>\n          {progress === 100 ? (\n            <>\n              <CheckCircle2 className=\"w-4 h-4 mr-2\" />\n              Concluído\n            </>\n          ) : (\n            \"Iniciar Treino\"\n          )}\n        </Button>\n      </CardFooter>\n    </Card>\n  );\n}\n","path":null,"size_bytes":5346,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"pg\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1417,"size_tokens":null},"client/src/components/ui/button-group.tsx":{"content":"import { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nconst buttonGroupVariants = cva(\n  \"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1\",\n  {\n    variants: {\n      orientation: {\n        horizontal:\n          \"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none\",\n        vertical:\n          \"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none\",\n      },\n    },\n    defaultVariants: {\n      orientation: \"horizontal\",\n    },\n  }\n)\n\nfunction ButtonGroup({\n  className,\n  orientation,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof buttonGroupVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"button-group\"\n      data-orientation={orientation}\n      className={cn(buttonGroupVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupText({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  asChild?: boolean\n}) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      className={cn(\n        \"bg-muted shadow-xs flex items-center gap-2 rounded-md border px-4 text-sm font-medium [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupSeparator({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"button-group-separator\"\n      orientation={orientation}\n      className={cn(\n        \"bg-input relative !m-0 self-stretch data-[orientation=vertical]:h-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  ButtonGroup,\n  ButtonGroupSeparator,\n  ButtonGroupText,\n  buttonGroupVariants,\n}\n","path":null,"size_bytes":2209,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"client/src/pages/coach.tsx":{"content":"import React, { useState, useRef, useEffect } from \"react\";\nimport { Link } from \"wouter\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Send, Sparkles, AlertCircle, Lock, Crown, MessageCircle } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { api } from \"@/lib/api\";\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { useLocale } from \"@/hooks/use-locale\";\n\nconst FREE_DAILY_LIMIT = 5;\n\ninterface Message {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  timestamp: string;\n}\n\nexport default function CoachPage() {\n  const { t } = useLocale();\n  const queryClient = useQueryClient();\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [input, setInput] = useState(\"\");\n  const [isTyping, setIsTyping] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [limitReached, setLimitReached] = useState(false);\n  const [remainingMessages, setRemainingMessages] = useState<number>(FREE_DAILY_LIMIT);\n  const scrollRef = useRef<HTMLDivElement>(null);\n\n  const { data: profile } = useQuery({\n    queryKey: [\"profile\"],\n    queryFn: () => api.profile.get() as Promise<{ clashTag?: string }>,\n  });\n\n  const { data: subscription } = useQuery({\n    queryKey: [\"subscription\"],\n    queryFn: () => api.subscription.get(),\n  });\n\n  const isPro = (subscription as any)?.plan === \"pro\" && (subscription as any)?.status === \"active\";\n\n  useEffect(() => {\n    setMessages([{\n      id: \"welcome\",\n      role: \"assistant\",\n      content: t('coach.welcome'),\n      timestamp: new Date().toISOString(),\n    }]);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollIntoView({ behavior: \"smooth\" });\n    }\n  }, [messages]);\n\n  const handleSend = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!input.trim() || isTyping) return;\n\n    const userMessage: Message = {\n      id: Date.now().toString(),\n      role: \"user\",\n      content: input,\n      timestamp: new Date().toISOString(),\n    };\n\n    setMessages((prev) => [...prev, userMessage]);\n    setInput(\"\");\n    setIsTyping(true);\n    setError(null);\n    setLimitReached(false);\n\n    try {\n      const chatMessages = messages\n        .filter((m) => m.id !== \"welcome\")\n        .map((m) => ({ role: m.role, content: m.content }));\n      chatMessages.push({ role: \"user\", content: input });\n\n      const response = await api.coach.chat(chatMessages, profile?.clashTag);\n\n      const assistantMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        role: \"assistant\",\n        content: response.message,\n        timestamp: response.timestamp,\n      };\n\n      setMessages((prev) => [...prev, assistantMessage]);\n      \n      if (typeof response.remainingMessages === 'number') {\n        setRemainingMessages(response.remainingMessages);\n      }\n    } catch (err: any) {\n      if (err.message?.includes(\"FREE_COACH_DAILY_LIMIT_REACHED\") || err.status === 403) {\n        setLimitReached(true);\n        setRemainingMessages(0);\n        setMessages((prev) => prev.filter(m => m.id !== userMessage.id));\n      } else {\n        setError(err.message || t('errors.generic'));\n      }\n    } finally {\n      setIsTyping(false);\n    }\n  };\n\n  const handleSuggestion = (text: string) => {\n    setInput(text);\n  };\n\n  const canSendMessage = isPro || (!limitReached && remainingMessages > 0);\n\n  return (\n    <DashboardLayout>\n      <div className=\"h-[calc(100vh-8rem)] flex flex-col gap-4\">\n        <div className=\"flex items-start justify-between gap-4\">\n          <div className=\"flex flex-col gap-1\">\n            <h1 className=\"text-3xl font-display font-bold text-foreground flex items-center gap-2\" data-testid=\"title-coach\">\n              {t('coach.title')} <span className=\"text-xs font-normal px-2 py-1 rounded bg-primary/20 text-primary uppercase tracking-wide\">Beta</span>\n            </h1>\n            <p className=\"text-muted-foreground\">{t('coach.subtitle')}</p>\n          </div>\n          \n          {!isPro && (\n            <div className=\"flex items-center gap-2 text-sm bg-muted/50 px-3 py-2 rounded-lg\" data-testid=\"coach-limit-indicator\">\n              <MessageCircle className=\"w-4 h-4 text-muted-foreground\" />\n              <span className=\"text-muted-foreground\">\n                {remainingMessages}/{FREE_DAILY_LIMIT} {t('coachLimits.remaining', { n: remainingMessages, total: FREE_DAILY_LIMIT }).split(' ').slice(-2).join(' ')}\n              </span>\n              <Progress value={(remainingMessages / FREE_DAILY_LIMIT) * 100} className=\"w-16 h-2\" />\n            </div>\n          )}\n        </div>\n\n        <Card className=\"flex-1 flex flex-col border-border/50 bg-card/50 backdrop-blur-sm overflow-hidden\">\n          <ScrollArea className=\"flex-1 p-4\">\n            <div className=\"space-y-6 max-w-3xl mx-auto\">\n              {messages.map((msg) => (\n                <div\n                  key={msg.id}\n                  data-testid={`message-${msg.role}-${msg.id}`}\n                  className={cn(\n                    \"flex gap-4 animate-in fade-in slide-in-from-bottom-2\",\n                    msg.role === \"user\" ? \"flex-row-reverse\" : \"flex-row\"\n                  )}\n                >\n                  <Avatar className={cn(\n                    \"w-10 h-10 border\",\n                    msg.role === \"assistant\" ? \"bg-primary/10 border-primary/20\" : \"bg-secondary/10 border-secondary/20\"\n                  )}>\n                    {msg.role === \"assistant\" ? (\n                      <div className=\"flex items-center justify-center w-full h-full text-primary\">\n                        <Sparkles className=\"w-5 h-5\" />\n                      </div>\n                    ) : (\n                      <AvatarFallback>U</AvatarFallback>\n                    )}\n                  </Avatar>\n                  \n                  <div className={cn(\n                    \"rounded-2xl p-4 max-w-[80%]\",\n                    msg.role === \"user\" \n                      ? \"bg-primary text-primary-foreground rounded-tr-none\" \n                      : \"bg-muted rounded-tl-none\"\n                  )}>\n                    <p className=\"text-sm leading-relaxed whitespace-pre-wrap\">{msg.content}</p>\n                    <span className=\"text-[10px] opacity-50 mt-2 block\">\n                      {new Date(msg.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}\n                    </span>\n                  </div>\n                </div>\n              ))}\n              {isTyping && (\n                <div className=\"flex gap-4\" data-testid=\"typing-indicator\">\n                  <Avatar className=\"w-10 h-10 bg-primary/10 border border-primary/20\">\n                    <div className=\"flex items-center justify-center w-full h-full text-primary\">\n                      <Sparkles className=\"w-5 h-5\" />\n                    </div>\n                  </Avatar>\n                  <div className=\"bg-muted rounded-2xl rounded-tl-none p-4 flex items-center gap-2\">\n                    <div className=\"w-2 h-2 bg-foreground/30 rounded-full animate-bounce\" />\n                    <div className=\"w-2 h-2 bg-foreground/30 rounded-full animate-bounce delay-100\" />\n                    <div className=\"w-2 h-2 bg-foreground/30 rounded-full animate-bounce delay-200\" />\n                  </div>\n                </div>\n              )}\n              {error && (\n                <div className=\"flex items-center gap-2 text-destructive text-sm bg-destructive/10 p-3 rounded-lg\" data-testid=\"error-message\">\n                  <AlertCircle className=\"w-4 h-4\" />\n                  {error}\n                </div>\n              )}\n              {limitReached && (\n                <div className=\"bg-gradient-to-r from-yellow-500/10 to-orange-500/10 border border-yellow-500/20 rounded-lg p-4 space-y-3\" data-testid=\"limit-reached-banner\">\n                  <div className=\"flex items-center gap-2\">\n                    <Lock className=\"w-5 h-5 text-yellow-500\" />\n                    <span className=\"font-semibold text-foreground\">{t('coachLimits.limitReached')}</span>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground\">{t('coachLimits.limitReachedDesc')}</p>\n                  <Link href=\"/billing\">\n                    <Button size=\"sm\" className=\"bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600\" data-testid=\"button-upgrade-from-limit\">\n                      <Crown className=\"w-4 h-4 mr-2\" />\n                      {t('coachLimits.upgradeCta')}\n                    </Button>\n                  </Link>\n                </div>\n              )}\n              <div ref={scrollRef} />\n            </div>\n          </ScrollArea>\n\n          <div className=\"p-4 border-t border-border bg-card/80\">\n            <form onSubmit={handleSend} className=\"max-w-3xl mx-auto relative flex gap-2\" data-testid=\"chat-form\">\n              <Input\n                value={input}\n                onChange={(e) => setInput(e.target.value)}\n                placeholder={limitReached ? t('coachLimits.limitReached') : t('coach.placeholder')}\n                className=\"h-12 pl-4 pr-12 bg-background/50 border-border shadow-inner\"\n                data-testid=\"input-message\"\n                disabled={isTyping || limitReached}\n              />\n              <Button \n                type=\"submit\" \n                size=\"icon\" \n                disabled={!input.trim() || isTyping || !canSendMessage}\n                data-testid=\"button-send\"\n                className={cn(\n                  \"absolute right-2 top-2 h-8 w-8 transition-all\",\n                  input.trim() ? \"bg-primary text-primary-foreground\" : \"bg-muted text-muted-foreground\"\n                )}\n              >\n                <Send className=\"w-4 h-4\" />\n              </Button>\n            </form>\n            <div className=\"max-w-3xl mx-auto mt-2 flex justify-center gap-2 flex-wrap\">\n              <SuggestionPill onClick={() => handleSuggestion(\"Como counterar Megacavaleiro?\")} text=\"Como counterar Megacavaleiro?\" />\n              <SuggestionPill onClick={() => handleSuggestion(\"Analise minha última derrota\")} text=\"Analise minha última derrota\" />\n              <SuggestionPill onClick={() => handleSuggestion(\"Melhor deck para Arena 17\")} text=\"Melhor deck para Arena 17\" />\n            </div>\n          </div>\n        </Card>\n      </div>\n    </DashboardLayout>\n  );\n}\n\nfunction SuggestionPill({ text, onClick }: { text: string, onClick: () => void }) {\n  return (\n    <button \n      onClick={onClick}\n      data-testid={`suggestion-${text.substring(0, 10)}`}\n      className=\"text-xs px-3 py-1 rounded-full bg-secondary/10 text-secondary border border-secondary/20 hover:bg-secondary/20 transition-colors\"\n    >\n      {text}\n    </button>\n  )\n}\n","path":null,"size_bytes":11179,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2859,"size_tokens":null},"client/src/pages/decks.tsx":{"content":"import React from \"react\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { mockCards } from \"@/lib/mockData\";\nimport { TrendingUp, TrendingDown, Copy, Crosshair } from \"lucide-react\";\n\nexport default function DecksPage() {\n  return (\n    <DashboardLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-foreground\">Análise de Decks</h1>\n          <p className=\"text-muted-foreground\">Seus decks mais eficientes e sugestões do meta.</p>\n        </div>\n\n        <Tabs defaultValue=\"my-decks\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 lg:w-[400px]\">\n            <TabsTrigger value=\"my-decks\">Meus Decks</TabsTrigger>\n            <TabsTrigger value=\"meta-decks\">Meta Decks</TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"my-decks\" className=\"mt-6 space-y-6\">\n            <DeckStatCard \n              name=\"Hog 2.6 Cycle\"\n              winRate={58}\n              matches={42}\n              avgElixir={2.6}\n              cards={mockCards}\n              isMain={true}\n            />\n            <DeckStatCard \n              name=\"Log Bait Classic\"\n              winRate={45}\n              matches={12}\n              avgElixir={3.1}\n              cards={mockCards} // Using same mock cards for visual demo\n              isMain={false}\n            />\n          </TabsContent>\n          \n          <TabsContent value=\"meta-decks\" className=\"mt-6\">\n            <div className=\"text-center py-12 text-muted-foreground bg-card/30 rounded-lg border border-border border-dashed\">\n              <Crosshair className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n              <h3 className=\"text-lg font-bold mb-2\">Meta Analysis</h3>\n              <p>Conecte-se com a API oficial para ver os decks do Top 1000 Global.</p>\n            </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </DashboardLayout>\n  );\n}\n\nfunction DeckStatCard({ name, winRate, matches, avgElixir, cards, isMain }: any) {\n  return (\n    <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm group hover:border-primary/30 transition-all\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <CardTitle>{name}</CardTitle>\n            {isMain && <Badge className=\"bg-primary/20 text-primary border-primary/20 hover:bg-primary/30\">Main Deck</Badge>}\n            <Badge variant=\"outline\" className=\"text-muted-foreground\">{avgElixir} Elixir</Badge>\n          </div>\n          <div className=\"flex items-center gap-4 text-sm\">\n            <div className=\"flex items-center gap-1.5 font-medium\">\n              {winRate >= 50 ? <TrendingUp className=\"w-4 h-4 text-green-500\" /> : <TrendingDown className=\"w-4 h-4 text-red-500\" />}\n              <span className={winRate >= 50 ? \"text-green-500\" : \"text-red-500\"}>{winRate}% Win Rate</span>\n            </div>\n            <span className=\"text-muted-foreground\">{matches} partidas</span>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"grid grid-cols-8 gap-2 mb-4\">\n          {cards.map((card: any) => (\n            <div key={card.id} className=\"relative aspect-[4/5] bg-black/40 rounded overflow-hidden border border-white/10 group-hover:border-white/20 transition-colors\">\n              <img src={card.image} alt={card.name} className=\"w-full h-full object-cover\" />\n              <div className=\"absolute bottom-0 inset-x-0 bg-black/60 text-[10px] text-center py-0.5 text-white font-bold\">\n                Lvl {card.level}\n              </div>\n            </div>\n          ))}\n        </div>\n        <div className=\"flex justify-end gap-2\">\n           <Button variant=\"outline\" size=\"sm\" className=\"h-8\">\n            <Copy className=\"w-3.5 h-3.5 mr-2\" />\n            Copiar Link\n          </Button>\n          <Button size=\"sm\" className=\"h-8\">Ver Detalhes</Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":4322,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport {\n  ChevronDownIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  captionLayout = \"label\",\n  buttonVariant = \"ghost\",\n  formatters,\n  components,\n  ...props\n}: React.ComponentProps<typeof DayPicker> & {\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n  const defaultClassNames = getDefaultClassNames()\n\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\n        \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n        className\n      )}\n      captionLayout={captionLayout}\n      formatters={{\n        formatMonthDropdown: (date) =>\n          date.toLocaleString(\"default\", { month: \"short\" }),\n        ...formatters,\n      }}\n      classNames={{\n        root: cn(\"w-fit\", defaultClassNames.root),\n        months: cn(\n          \"relative flex flex-col gap-4 md:flex-row\",\n          defaultClassNames.months\n        ),\n        month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n        nav: cn(\n          \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n          defaultClassNames.nav\n        ),\n        button_previous: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_previous\n        ),\n        button_next: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_next\n        ),\n        month_caption: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n          defaultClassNames.month_caption\n        ),\n        dropdowns: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n          defaultClassNames.dropdowns\n        ),\n        dropdown_root: cn(\n          \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n          defaultClassNames.dropdown_root\n        ),\n        dropdown: cn(\n          \"bg-popover absolute inset-0 opacity-0\",\n          defaultClassNames.dropdown\n        ),\n        caption_label: cn(\n          \"select-none font-medium\",\n          captionLayout === \"label\"\n            ? \"text-sm\"\n            : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5\",\n          defaultClassNames.caption_label\n        ),\n        table: \"w-full border-collapse\",\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\n        weekday: cn(\n          \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n          defaultClassNames.weekday\n        ),\n        week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n        week_number_header: cn(\n          \"w-[--cell-size] select-none\",\n          defaultClassNames.week_number_header\n        ),\n        week_number: cn(\n          \"text-muted-foreground select-none text-[0.8rem]\",\n          defaultClassNames.week_number\n        ),\n        day: cn(\n          \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md\",\n          defaultClassNames.day\n        ),\n        range_start: cn(\n          \"bg-accent rounded-l-md\",\n          defaultClassNames.range_start\n        ),\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n        range_end: cn(\"bg-accent rounded-r-md\", defaultClassNames.range_end),\n        today: cn(\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n          defaultClassNames.today\n        ),\n        outside: cn(\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\n          defaultClassNames.outside\n        ),\n        disabled: cn(\n          \"text-muted-foreground opacity-50\",\n          defaultClassNames.disabled\n        ),\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\n        ...classNames,\n      }}\n      components={{\n        Root: ({ className, rootRef, ...props }) => {\n          return (\n            <div\n              data-slot=\"calendar\"\n              ref={rootRef}\n              className={cn(className)}\n              {...props}\n            />\n          )\n        },\n        Chevron: ({ className, orientation, ...props }) => {\n          if (orientation === \"left\") {\n            return (\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n            )\n          }\n\n          if (orientation === \"right\") {\n            return (\n              <ChevronRightIcon\n                className={cn(\"size-4\", className)}\n                {...props}\n              />\n            )\n          }\n\n          return (\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n          )\n        },\n        DayButton: CalendarDayButton,\n        WeekNumber: ({ children, ...props }) => {\n          return (\n            <td {...props}>\n              <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n                {children}\n              </div>\n            </td>\n          )\n        },\n        ...components,\n      }}\n      {...props}\n    />\n  )\n}\n\nfunction CalendarDayButton({\n  className,\n  day,\n  modifiers,\n  ...props\n}: React.ComponentProps<typeof DayButton>) {\n  const defaultClassNames = getDefaultClassNames()\n\n  const ref = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    if (modifiers.focused) ref.current?.focus()\n  }, [modifiers.focused])\n\n  return (\n    <Button\n      ref={ref}\n      variant=\"ghost\"\n      size=\"icon\"\n      data-day={day.date.toLocaleDateString()}\n      data-selected-single={\n        modifiers.selected &&\n        !modifiers.range_start &&\n        !modifiers.range_end &&\n        !modifiers.range_middle\n      }\n      data-range-start={modifiers.range_start}\n      data-range-end={modifiers.range_end}\n      data-range-middle={modifiers.range_middle}\n      className={cn(\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n        defaultClassNames.day,\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Calendar, CalendarDayButton }\n","path":null,"size_bytes":7569,"size_tokens":null},"client/src/components/ui/input-group.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Textarea } from \"@/components/ui/textarea\"\n\nfunction InputGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"input-group\"\n      role=\"group\"\n      className={cn(\n        \"group/input-group border-input dark:bg-input/30 shadow-xs relative flex w-full items-center rounded-md border outline-none transition-[color,box-shadow]\",\n        \"h-9 has-[>textarea]:h-auto\",\n\n        // Variants based on alignment.\n        \"has-[>[data-align=inline-start]]:[&>input]:pl-2\",\n        \"has-[>[data-align=inline-end]]:[&>input]:pr-2\",\n        \"has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3\",\n        \"has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3\",\n\n        // Focus state.\n        \"has-[[data-slot=input-group-control]:focus-visible]:ring-ring has-[[data-slot=input-group-control]:focus-visible]:ring-1\",\n\n        // Error state.\n        \"has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40\",\n\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupAddonVariants = cva(\n  \"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4\",\n  {\n    variants: {\n      align: {\n        \"inline-start\":\n          \"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]\",\n        \"inline-end\":\n          \"order-last pr-3 has-[>button]:mr-[-0.4rem] has-[>kbd]:mr-[-0.35rem]\",\n        \"block-start\":\n          \"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5\",\n        \"block-end\":\n          \"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5\",\n      },\n    },\n    defaultVariants: {\n      align: \"inline-start\",\n    },\n  }\n)\n\nfunction InputGroupAddon({\n  className,\n  align = \"inline-start\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof inputGroupAddonVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"input-group-addon\"\n      data-align={align}\n      className={cn(inputGroupAddonVariants({ align }), className)}\n      onClick={(e) => {\n        if ((e.target as HTMLElement).closest(\"button\")) {\n          return\n        }\n        e.currentTarget.parentElement?.querySelector(\"input\")?.focus()\n      }}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupButtonVariants = cva(\n  \"flex items-center gap-2 text-sm shadow-none\",\n  {\n    variants: {\n      size: {\n        xs: \"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5\",\n        sm: \"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5\",\n        \"icon-xs\":\n          \"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0\",\n        \"icon-sm\": \"size-8 p-0 has-[>svg]:p-0\",\n      },\n    },\n    defaultVariants: {\n      size: \"xs\",\n    },\n  }\n)\n\nfunction InputGroupButton({\n  className,\n  type = \"button\",\n  variant = \"ghost\",\n  size = \"xs\",\n  ...props\n}: Omit<React.ComponentProps<typeof Button>, \"size\"> &\n  VariantProps<typeof inputGroupButtonVariants>) {\n  return (\n    <Button\n      type={type}\n      data-size={size}\n      variant={variant}\n      className={cn(inputGroupButtonVariants({ size }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupText({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\n        \"text-muted-foreground flex items-center gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupInput({\n  className,\n  ...props\n}: React.ComponentProps<\"input\">) {\n  return (\n    <Input\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupTextarea({\n  className,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  return (\n    <Textarea\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupText,\n  InputGroupInput,\n  InputGroupTextarea,\n}\n","path":null,"size_bytes":4971,"size_tokens":null},"client/src/hooks/useProfile.ts":{"content":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { api } from '../lib/api';\nimport { toast } from 'sonner';\n\nexport function useProfile() {\n  return useQuery({\n    queryKey: ['profile'],\n    queryFn: () => api.profile.get(),\n  });\n}\n\nexport function useUpdateProfile() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: (data: any) => api.profile.update(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['profile'] });\n      queryClient.invalidateQueries({ queryKey: ['user'] });\n      toast.success('Perfil atualizado com sucesso!');\n    },\n    onError: (error: Error) => {\n      toast.error(`Erro ao atualizar perfil: ${error.message}`);\n    },\n  });\n}\n","path":null,"size_bytes":754,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":724,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2143,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"server/clashRoyaleApi.ts":{"content":"// Clash Royale API integration\n// Using RoyaleAPI proxy to avoid IP whitelist issues\n// To use: create API key at developer.clashroyale.com with IP: 45.79.218.79\nconst BASE_URL = process.env.CLASH_ROYALE_API_URL || 'https://proxy.royaleapi.dev/v1';\nconst API_KEY = process.env.CLASH_ROYALE_API_KEY;\n\nif (!API_KEY) {\n  console.warn('Warning: CLASH_ROYALE_API_KEY not set. Clash Royale API features will not work.');\n}\n\ninterface ClashRoyaleApiResponse<T> {\n  data?: T;\n  error?: string;\n  status: number;\n}\n\nasync function clashRoyaleRequest<T>(endpoint: string): Promise<ClashRoyaleApiResponse<T>> {\n  if (!API_KEY) {\n    return {\n      error: 'API key not configured',\n      status: 500,\n    };\n  }\n\n  try {\n    const response = await fetch(`${BASE_URL}${endpoint}`, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json',\n        'Authorization': `Bearer ${API_KEY}`,\n      },\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      console.error(`Clash Royale API error (${response.status}):`, errorText);\n      \n      return {\n        error: response.status === 404 \n          ? 'Player not found' \n          : `API error: ${response.status}`,\n        status: response.status,\n      };\n    }\n\n    const data = await response.json();\n    return {\n      data,\n      status: response.status,\n    };\n  } catch (error) {\n    console.error('Clash Royale API request failed:', error);\n    return {\n      error: 'Failed to connect to Clash Royale API',\n      status: 500,\n    };\n  }\n}\n\nexport async function getPlayerByTag(tag: string) {\n  // Remove # if present and ensure proper encoding\n  const cleanTag = tag.replace('#', '');\n  const encodedTag = encodeURIComponent(`#${cleanTag}`);\n  \n  return clashRoyaleRequest(`/players/${encodedTag}`);\n}\n\nexport async function getPlayerBattles(tag: string) {\n  const cleanTag = tag.replace('#', '');\n  const encodedTag = encodeURIComponent(`#${cleanTag}`);\n  \n  return clashRoyaleRequest(`/players/${encodedTag}/battlelog`);\n}\n\nexport async function getCards() {\n  return clashRoyaleRequest('/cards');\n}\n","path":null,"size_bytes":2097,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1486,"size_tokens":null},"client/src/components/ui/kbd.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Kbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      data-slot=\"kbd\"\n      className={cn(\n        \"bg-muted text-muted-foreground pointer-events-none inline-flex h-5 w-fit min-w-5 select-none items-center justify-center gap-1 rounded-sm px-1 font-sans text-xs font-medium\",\n        \"[&_svg:not([class*='size-'])]:size-3\",\n        \"[[data-slot=tooltip-content]_&]:bg-background/20 [[data-slot=tooltip-content]_&]:text-background dark:[[data-slot=tooltip-content]_&]:bg-background/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction KbdGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <kbd\n      data-slot=\"kbd-group\"\n      className={cn(\"inline-flex items-center gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Kbd, KbdGroup }\n","path":null,"size_bytes":862,"size_tokens":null},"client/src/pages/settings.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from \"@/components/ui/card\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { LogOut, Moon, Bell, Monitor, Loader2, Check, Hash, Search } from \"lucide-react\";\nimport { useProfile, useUpdateProfile } from \"@/hooks/useProfile\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { api } from \"@/lib/api\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function SettingsPage() {\n  const [, setLocation] = useLocation();\n  const { data: profile, isLoading: profileLoading } = useProfile();\n  const { user } = useAuth();\n  const updateProfile = useUpdateProfile();\n  const { toast } = useToast();\n\n  const [displayName, setDisplayName] = useState(\"\");\n  const [clashTag, setClashTag] = useState(\"\");\n  const [isSearchingTag, setIsSearchingTag] = useState(false);\n  const [tagValidated, setTagValidated] = useState(false);\n\n  useEffect(() => {\n    if (profile) {\n      setDisplayName((profile as any).displayName || \"\");\n      setClashTag((profile as any).clashTag?.replace(\"#\", \"\") || \"\");\n      if ((profile as any).clashTag) {\n        setTagValidated(true);\n      }\n    }\n  }, [profile]);\n\n  const validateTagMutation = useMutation({\n    mutationFn: async (tag: string) => {\n      const normalizedTag = tag.startsWith(\"#\") ? tag : `#${tag}`;\n      return api.clash.getPlayer(normalizedTag);\n    },\n    onSuccess: (data: any) => {\n      setTagValidated(true);\n      setDisplayName(data.name);\n      toast({\n        title: \"Tag validada!\",\n        description: `Jogador encontrado: ${data.name}`,\n      });\n    },\n    onError: (error: Error) => {\n      setTagValidated(false);\n      toast({\n        title: \"Tag inválida\",\n        description: error.message || \"Jogador não encontrado\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleValidateTag = () => {\n    if (!clashTag.trim()) {\n      toast({\n        title: \"Tag vazia\",\n        description: \"Digite uma tag para validar\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    setIsSearchingTag(true);\n    validateTagMutation.mutate(clashTag, {\n      onSettled: () => setIsSearchingTag(false),\n    });\n  };\n\n  const handleSaveProfile = () => {\n    const rawTag = clashTag.trim().toUpperCase();\n    const normalizedTag = rawTag ? `#${rawTag.replace(/^#/, '')}` : null;\n    \n    updateProfile.mutate({\n      displayName: displayName || undefined,\n      clashTag: normalizedTag,\n    });\n  };\n\n  const handleLogout = () => {\n    window.location.href = \"/api/auth/logout\";\n  };\n\n  return (\n    <DashboardLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-foreground\">Configurações</h1>\n          <p className=\"text-muted-foreground\">Gerencie sua conta, assinatura e preferências.</p>\n        </div>\n\n        <Tabs defaultValue=\"account\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3 lg:w-[600px]\">\n            <TabsTrigger value=\"account\">Conta</TabsTrigger>\n            <TabsTrigger value=\"billing\">Planos e Billing</TabsTrigger>\n            <TabsTrigger value=\"preferences\">Preferências</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"account\" className=\"mt-6 space-y-6\">\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle>Perfil</CardTitle>\n                <CardDescription>Suas informações e conta do Clash Royale.</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {profileLoading ? (\n                  <div className=\"flex items-center justify-center py-8\">\n                    <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n                  </div>\n                ) : (\n                  <>\n                    <div className=\"flex items-center gap-6\">\n                      <Avatar className=\"w-20 h-20 border-2 border-border\">\n                        <AvatarImage src={(user as any)?.profileImageUrl} />\n                        <AvatarFallback>\n                          {displayName?.substring(0, 2).toUpperCase() || \"CR\"}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div>\n                        <p className=\"font-medium\">{(user as any)?.email || \"Email não disponível\"}</p>\n                        <p className=\"text-sm text-muted-foreground\">Conta Replit</p>\n                      </div>\n                    </div>\n                    \n                    <div className=\"grid gap-4 max-w-md\">\n                      <div className=\"grid gap-2\">\n                        <Label htmlFor=\"display-name\">Nome de Exibição</Label>\n                        <Input \n                          id=\"display-name\" \n                          value={displayName}\n                          onChange={(e) => setDisplayName(e.target.value)}\n                          placeholder=\"Seu nome no app\"\n                          data-testid=\"input-display-name\"\n                        />\n                      </div>\n                      \n                      <div className=\"grid gap-2\">\n                        <Label htmlFor=\"clash-tag\">Clash Royale Tag</Label>\n                        <div className=\"flex gap-2\">\n                          <div className=\"relative flex-1\">\n                            <Hash className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                            <Input \n                              id=\"clash-tag\" \n                              value={clashTag}\n                              onChange={(e) => {\n                                setClashTag(e.target.value.toUpperCase().replace(\"#\", \"\"));\n                                setTagValidated(false);\n                              }}\n                              placeholder=\"2P090J0\"\n                              className=\"pl-9 font-mono uppercase\"\n                              data-testid=\"input-clash-tag\"\n                            />\n                          </div>\n                          <Button \n                            type=\"button\"\n                            variant=\"outline\"\n                            onClick={handleValidateTag}\n                            disabled={isSearchingTag || !clashTag.trim()}\n                            data-testid=\"button-validate-tag\"\n                          >\n                            {isSearchingTag ? (\n                              <Loader2 className=\"w-4 h-4 animate-spin\" />\n                            ) : tagValidated ? (\n                              <Check className=\"w-4 h-4 text-green-500\" />\n                            ) : (\n                              <Search className=\"w-4 h-4\" />\n                            )}\n                          </Button>\n                        </div>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {tagValidated \n                            ? \"Tag validada! Clique em Salvar para confirmar.\"\n                            : \"Clique no ícone de busca para validar a tag.\"}\n                        </p>\n                      </div>\n                    </div>\n                  </>\n                )}\n              </CardContent>\n              <CardFooter className=\"border-t border-border/50 pt-6\">\n                <Button \n                  onClick={handleSaveProfile}\n                  disabled={updateProfile.isPending || profileLoading}\n                  data-testid=\"button-save-profile\"\n                >\n                  {updateProfile.isPending && <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />}\n                  Salvar Alterações\n                </Button>\n              </CardFooter>\n            </Card>\n\n            <Card className=\"border-destructive/30 bg-destructive/5\">\n              <CardHeader>\n                <CardTitle className=\"text-destructive\">Zona de Perigo</CardTitle>\n              </CardHeader>\n              <CardContent className=\"flex justify-between items-center\">\n                <div>\n                  <h4 className=\"font-bold\">Sair da Conta</h4>\n                  <p className=\"text-sm text-muted-foreground\">Encerrar sua sessão atual.</p>\n                </div>\n                <Button variant=\"destructive\" size=\"sm\" onClick={handleLogout} data-testid=\"button-logout\">\n                  <LogOut className=\"w-4 h-4 mr-2\" />\n                  Sair\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"billing\" className=\"mt-6 space-y-6\">\n            <Card className=\"border-primary/50 bg-gradient-to-br from-card to-primary/5\">\n              <CardHeader>\n                <CardTitle className=\"flex justify-between items-center\">\n                  Plano Atual: FREE\n                  <Button size=\"sm\" className=\"font-bold\" onClick={() => setLocation(\"/billing\")} data-testid=\"button-upgrade\">\n                    Upgrade PRO\n                  </Button>\n                </CardTitle>\n                <CardDescription>Você está no plano gratuito.</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid gap-4\">\n                  <div className=\"flex justify-between py-2 border-b border-border/50\">\n                    <span className=\"text-muted-foreground\">Ciclo de cobrança</span>\n                    <span className=\"font-medium\">Mensal</span>\n                  </div>\n                  <div className=\"flex justify-between py-2 border-b border-border/50\">\n                    <span className=\"text-muted-foreground\">Próxima renovação</span>\n                    <span className=\"font-medium\">-</span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n            \n            <Card className=\"border-border/50 bg-card/50\">\n              <CardHeader>\n                <CardTitle>Histórico de Pagamentos</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-sm text-muted-foreground text-center py-8\">Nenhuma fatura encontrada.</p>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"preferences\" className=\"mt-6 space-y-6\">\n            <Card className=\"border-border/50 bg-card/50\">\n              <CardHeader>\n                <CardTitle>Aparência</CardTitle>\n                <CardDescription>Personalize como o CRStats se parece no seu dispositivo.</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Moon className=\"w-4 h-4\" />\n                    <span className=\"font-medium\">Modo Escuro</span>\n                  </div>\n                  <Switch defaultChecked />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-border/50 bg-card/50\">\n              <CardHeader>\n                <CardTitle>Notificações</CardTitle>\n                <CardDescription>Escolha o que você quer receber.</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Bell className=\"w-4 h-4\" />\n                    <span className=\"font-medium\">Alertas de Meta</span>\n                  </div>\n                  <Switch defaultChecked />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Monitor className=\"w-4 h-4\" />\n                    <span className=\"font-medium\">Lembretes de Treino</span>\n                  </div>\n                  <Switch />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":12654,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":649,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7606,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1148,"size_tokens":null},"client/src/pages/me.tsx":{"content":"import React from \"react\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { \n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"@/components/ui/accordion\";\nimport { \n  Trophy, \n  Crown, \n  TrendingUp, \n  TrendingDown,\n  Clock, \n  Target, \n  Swords, \n  Loader2, \n  AlertCircle,\n  Flame,\n  Shield,\n  Zap,\n  Award,\n  ChevronDown,\n  Timer,\n  ThumbsUp,\n  ThumbsDown,\n  Lock,\n  Layers\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { useProfile } from \"@/hooks/useProfile\";\nimport { useClashPlayer, useClashBattles } from \"@/hooks/useClashPlayer\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport {\n  Area,\n  AreaChart,\n  CartesianGrid,\n  ResponsiveContainer,\n  Tooltip,\n  XAxis,\n  YAxis,\n  Line,\n  LineChart,\n  BarChart,\n  Bar,\n} from \"recharts\";\nimport { formatDistanceToNow, differenceInDays, startOfDay, format, getDay } from \"date-fns\";\nimport { useGoals } from \"@/hooks/useGoals\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Link } from \"wouter\";\nimport { ptBR } from \"date-fns/locale\";\nimport { useLocale } from \"@/hooks/use-locale\";\n\ntype PeriodFilter = 'today' | '7days' | '30days' | 'season';\n\nfunction parseBattleTime(battleTime: string): Date {\n  return new Date(battleTime.replace(/(\\d{4})(\\d{2})(\\d{2})T(\\d{2})(\\d{2})(\\d{2})/, '$1-$2-$3T$4:$5:$6'));\n}\n\nfunction formatGameMode(type: string | undefined): string {\n  if (!type) return 'Batalha';\n  const lowerType = type.toLowerCase();\n  if (lowerType.includes('ladder') || lowerType.includes('pvp')) return 'Ladder';\n  if (lowerType.includes('challenge')) return 'Desafio';\n  if (lowerType.includes('tournament')) return 'Torneio';\n  if (lowerType.includes('2v2')) return '2v2';\n  if (lowerType.includes('war')) return 'Guerra';\n  if (lowerType.includes('friendly')) return 'Amistoso';\n  if (lowerType.includes('party')) return 'Festa';\n  return type.replace(/([A-Z])/g, ' $1').trim();\n}\n\ninterface PushSession {\n  battles: any[];\n  startTime: Date;\n  endTime: Date;\n  wins: number;\n  losses: number;\n  draws: number;\n  netTrophies: number;\n  durationMs: number;\n}\n\n/**\n * Groups battles into \"push sessions\" based on time gaps.\n * A push is a sequence of games where the player never waits more than 30 minutes between matches.\n * If the gap between two battles exceeds 30 minutes, a new push starts.\n * \n * @param battles - Array of battles (newest first from API)\n * @param minBattlesPerPush - Minimum battles required for a valid push (default: 2)\n * @param maxGapMinutes - Maximum gap in minutes between battles in same push (default: 30)\n * @returns Array of PushSession objects, ordered from oldest to newest push\n */\nfunction groupBattlesIntoPushes(\n  battles: any[],\n  minBattlesPerPush: number = 2,\n  maxGapMinutes: number = 30\n): PushSession[] {\n  if (!battles.length) return [];\n\n  const sortedBattles = [...battles]\n    .filter(b => b.battleTime)\n    .sort((a, b) => {\n      const dateA = parseBattleTime(a.battleTime);\n      const dateB = parseBattleTime(b.battleTime);\n      return dateA.getTime() - dateB.getTime();\n    });\n\n  if (sortedBattles.length === 0) return [];\n\n  const pushes: PushSession[] = [];\n  let currentPush: any[] = [sortedBattles[0]];\n\n  for (let i = 1; i < sortedBattles.length; i++) {\n    const prevBattle = sortedBattles[i - 1];\n    const currBattle = sortedBattles[i];\n    \n    const prevTime = parseBattleTime(prevBattle.battleTime);\n    const currTime = parseBattleTime(currBattle.battleTime);\n    const gapMinutes = (currTime.getTime() - prevTime.getTime()) / (1000 * 60);\n\n    if (gapMinutes <= maxGapMinutes) {\n      currentPush.push(currBattle);\n    } else {\n      if (currentPush.length >= minBattlesPerPush) {\n        pushes.push(createPushSession(currentPush));\n      }\n      currentPush = [currBattle];\n    }\n  }\n\n  if (currentPush.length >= minBattlesPerPush) {\n    pushes.push(createPushSession(currentPush));\n  }\n\n  return pushes;\n}\n\nfunction createPushSession(battles: any[]): PushSession {\n  let wins = 0;\n  let losses = 0;\n  let draws = 0;\n  let netTrophies = 0;\n\n  battles.forEach((battle: any, index: number) => {\n    const teamCrowns = battle.team?.[0]?.crowns || 0;\n    const opponentCrowns = battle.opponent?.[0]?.crowns || 0;\n    const trophyChange = battle.team?.[0]?.trophyChange;\n\n    const isWin = teamCrowns > opponentCrowns;\n    const isLoss = teamCrowns < opponentCrowns;\n    \n    if (isWin) wins++;\n    else if (isLoss) losses++;\n    else draws++;\n\n    // Use trophyChange if it's a valid per-battle delta (Clash Royale typically ±20-45)\n    if (typeof trophyChange === 'number' && trophyChange >= -60 && trophyChange <= 60) {\n      netTrophies += trophyChange;\n    } else {\n      // Try computing delta from startingTrophies between consecutive battles\n      const prevBattle = index > 0 ? battles[index - 1] : null;\n      const prevTrophies = prevBattle?.team?.[0]?.startingTrophies || prevBattle?.team?.[0]?.trophies;\n      const currentStartTrophies = battle.team?.[0]?.startingTrophies;\n      \n      if (typeof prevTrophies === 'number' && typeof currentStartTrophies === 'number') {\n        // Delta = current starting - previous starting (adjusted for previous result)\n        const computedDelta = currentStartTrophies - prevTrophies;\n        if (computedDelta >= -60 && computedDelta <= 60) {\n          netTrophies += computedDelta;\n        } else if (isWin) {\n          netTrophies += 30;\n        } else if (isLoss) {\n          netTrophies -= 30;\n        }\n      } else if (isWin) {\n        netTrophies += 30; // Estimate for wins\n      } else if (isLoss) {\n        netTrophies -= 30; // Estimate for losses\n      }\n    }\n    // Draws typically give 0 trophies\n  });\n\n  const startTime = parseBattleTime(battles[0].battleTime);\n  const endTime = parseBattleTime(battles[battles.length - 1].battleTime);\n\n  return {\n    battles,\n    startTime,\n    endTime,\n    wins,\n    losses,\n    draws,\n    netTrophies,\n    durationMs: endTime.getTime() - startTime.getTime(),\n  };\n}\n\n/**\n * Groups battles into sessions for visual display (includes single-battle sessions)\n */\nfunction groupBattlesIntoSessions(battles: any[], maxGapMinutes: number = 30): PushSession[] {\n  return groupBattlesIntoPushes(battles, 1, maxGapMinutes);\n}\n\n/**\n * PushSummaryRow - Compact summary for a push session in the battle history\n */\nfunction PushSummaryRow({ \n  session, \n  t \n}: { \n  session: PushSession; \n  t: (key: string, params?: Record<string, string | number>) => string;\n}) {\n  const durationMin = Math.round(session.durationMs / (1000 * 60));\n  const isSingleBattle = session.battles.length === 1;\n  \n  const trophiesText = session.netTrophies > 0 \n    ? `+${session.netTrophies}` \n    : `${session.netTrophies}`;\n  \n  return (\n    <div className=\"flex items-center gap-2 py-2 px-3 bg-muted/30 rounded-lg border border-border/30\" data-testid=\"push-summary-row\">\n      <Layers className=\"w-4 h-4 text-primary shrink-0\" />\n      {isSingleBattle ? (\n        <span className=\"text-sm font-medium text-muted-foreground\">\n          {t('battle.quickSession')}\n        </span>\n      ) : (\n        <span className=\"text-sm font-medium\">\n          {t('battle.pushSummary', {\n            games: session.battles.length,\n            wins: session.wins,\n            losses: session.losses,\n            trophies: trophiesText,\n            duration: durationMin,\n          })}\n          {session.draws > 0 && (\n            <span className=\"text-muted-foreground\"> (+{session.draws} {t('battle.draws')})</span>\n          )}\n        </span>\n      )}\n    </div>\n  );\n}\n\nexport default function MePage() {\n  const { data: profile, isLoading: profileLoading } = useProfile();\n  const clashTag = (profile as any)?.clashTag;\n  const { data: playerData, isLoading: playerLoading, error: playerError } = useClashPlayer(clashTag);\n  const { data: battlesData, isLoading: battlesLoading } = useClashBattles(clashTag);\n  \n  const { data: subscription } = useQuery({\n    queryKey: ['subscription'],\n    queryFn: () => api.subscription.get(),\n  });\n\n  const { data: goalsData, isLoading: goalsLoading } = useGoals();\n  const { t } = useLocale();\n\n  const isPro = (subscription as any)?.plan === 'PRO' || (subscription as any)?.plan === 'pro' || (subscription as any)?.status === 'active';\n  const isLoading = profileLoading || playerLoading;\n  const battles = (battlesData as any) || [];\n  const player = playerData as any;\n\n  const [periodFilter, setPeriodFilter] = React.useState<PeriodFilter>('7days');\n\n  const filteredBattles = React.useMemo(() => {\n    if (!battles.length) return [];\n    \n    const now = new Date();\n    const todayStart = startOfDay(now);\n    \n    return battles.filter((battle: any) => {\n      if (!battle.battleTime) return false;\n      const battleDate = parseBattleTime(battle.battleTime);\n      const daysDiff = differenceInDays(now, battleDate);\n      \n      switch (periodFilter) {\n        case 'today':\n          return battleDate >= todayStart;\n        case '7days':\n          return daysDiff <= 7;\n        case '30days':\n          return daysDiff <= 30;\n        case 'season':\n          return daysDiff <= 35;\n        default:\n          return true;\n      }\n    });\n  }, [battles, periodFilter]);\n\n  const recentSeriesStats = React.useMemo(() => {\n    const recent = filteredBattles.slice(0, 10);\n    let wins = 0;\n    let losses = 0;\n    \n    recent.forEach((battle: any) => {\n      const teamCrowns = battle.team?.[0]?.crowns || 0;\n      const opponentCrowns = battle.opponent?.[0]?.crowns || 0;\n      if (teamCrowns > opponentCrowns) wins++;\n      else if (teamCrowns < opponentCrowns) losses++;\n    });\n    \n    const total = wins + losses;\n    const winRate = total > 0 ? Math.round((wins / total) * 100) : 0;\n    \n    return { wins, losses, total: recent.length, winRate };\n  }, [filteredBattles]);\n\n  const lastPush = React.useMemo(() => {\n    const pushes = groupBattlesIntoPushes(filteredBattles);\n    return pushes.length > 0 ? pushes[pushes.length - 1] : null;\n  }, [filteredBattles]);\n\n  // Sessions for visual display (includes single-battle sessions), sorted newest first\n  const sessions = React.useMemo(() => {\n    const allSessions = groupBattlesIntoSessions(filteredBattles);\n    // Sort sessions from newest to oldest (by startTime descending)\n    // Also sort battles within each session from newest to oldest\n    return allSessions\n      .map(session => ({\n        ...session,\n        battles: [...session.battles].sort((a, b) => {\n          const dateA = parseBattleTime(a.battleTime);\n          const dateB = parseBattleTime(b.battleTime);\n          return dateB.getTime() - dateA.getTime();\n        })\n      }))\n      .sort((a, b) => b.startTime.getTime() - a.startTime.getTime());\n  }, [filteredBattles]);\n\n  const stats = React.useMemo(() => {\n    if (!battles.length) {\n      return {\n        winRate: 0,\n        totalMatches: 0,\n        streak: { type: 'none', count: 0 },\n        lastPlayed: null,\n        ladderStats: { wins: 0, losses: 0, matches: 0, winRate: 0 },\n        challengeStats: { wins: 0, losses: 0, matches: 0, winRate: 0 },\n      };\n    }\n\n    let wins = 0;\n    let losses = 0;\n    let streakType: 'win' | 'loss' | 'none' = 'none';\n    let streakCount = 0;\n    let ladderWins = 0, ladderLosses = 0;\n    let challengeWins = 0, challengeLosses = 0;\n\n    battles.forEach((b: any, idx: number) => {\n      const teamCrowns = b.team?.[0]?.crowns || 0;\n      const opponentCrowns = b.opponent?.[0]?.crowns || 0;\n      const isWin = teamCrowns > opponentCrowns;\n      const isLoss = teamCrowns < opponentCrowns;\n      \n      if (isWin) wins++;\n      else if (isLoss) losses++;\n\n      if (idx === 0) {\n        streakType = isWin ? 'win' : isLoss ? 'loss' : 'none';\n        streakCount = 1;\n      } else if ((streakType === 'win' && isWin) || (streakType === 'loss' && isLoss)) {\n        streakCount++;\n      } else {\n        streakType = isWin ? 'win' : isLoss ? 'loss' : 'none';\n        streakCount = 1;\n      }\n\n      const battleType = b.type?.toLowerCase() || '';\n      if (battleType.includes('ladder') || battleType.includes('pvp')) {\n        if (isWin) ladderWins++;\n        else if (isLoss) ladderLosses++;\n      }\n      if (battleType.includes('challenge') || battleType.includes('tournament')) {\n        if (isWin) challengeWins++;\n        else if (isLoss) challengeLosses++;\n      }\n    });\n\n    const totalMatches = wins + losses;\n    const winRate = totalMatches > 0 ? ((wins / totalMatches) * 100) : 0;\n    \n    const lastBattle = battles[0];\n    const lastPlayed = lastBattle?.battleTime \n      ? formatDistanceToNow(new Date(lastBattle.battleTime.replace(/(\\d{4})(\\d{2})(\\d{2})T(\\d{2})(\\d{2})(\\d{2})/, '$1-$2-$3T$4:$5:$6')), { addSuffix: true, locale: ptBR })\n      : null;\n\n    const ladderMatches = ladderWins + ladderLosses;\n    const challengeMatches = challengeWins + challengeLosses;\n\n    return {\n      winRate: winRate.toFixed(1),\n      wins,\n      losses,\n      totalMatches,\n      streak: { type: streakType, count: streakCount },\n      lastPlayed,\n      ladderStats: { \n        wins: ladderWins, \n        losses: ladderLosses, \n        matches: ladderMatches,\n        winRate: ladderMatches > 0 ? ((ladderWins / ladderMatches) * 100).toFixed(1) : 0\n      },\n      challengeStats: { \n        wins: challengeWins, \n        losses: challengeLosses, \n        matches: challengeMatches,\n        winRate: challengeMatches > 0 ? ((challengeWins / challengeMatches) * 100).toFixed(1) : 0\n      },\n    };\n  }, [battles]);\n\n  const tiltStatus = React.useMemo(() => {\n    if (stats.streak.type === 'loss' && stats.streak.count >= 3) {\n      return { label: 'Em risco de tilt', variant: 'destructive' as const };\n    }\n    if (stats.streak.type === 'win' && stats.streak.count >= 3) {\n      return { label: 'Em alta!', variant: 'default' as const };\n    }\n    return { label: 'Consistente', variant: 'secondary' as const };\n  }, [stats.streak]);\n\n  const chartData = React.useMemo(() => {\n    const days = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab'];\n    const today = new Date();\n    return Array.from({ length: 7 }, (_, i) => {\n      const date = new Date(today);\n      date.setDate(date.getDate() - (6 - i));\n      const baseTrophies = player?.trophies || 5000;\n      const variation = Math.floor(Math.random() * 100) - 50;\n      return {\n        date: days[date.getDay()],\n        trophies: Math.max(0, baseTrophies + variation * (i - 3)),\n      };\n    });\n  }, [player?.trophies]);\n\n  const deckUsage = React.useMemo(() => {\n    if (!battles.length) return [];\n    \n    const deckMap: Record<string, { cards: any[]; wins: number; losses: number; total: number }> = {};\n    \n    battles.forEach((battle: any) => {\n      const cards = battle.team?.[0]?.cards;\n      if (!cards || cards.length === 0) return;\n      \n      const deckKey = cards.map((c: any) => c.id).sort().join('-');\n      \n      if (!deckMap[deckKey]) {\n        deckMap[deckKey] = { cards, wins: 0, losses: 0, total: 0 };\n      }\n      \n      const teamCrowns = battle.team?.[0]?.crowns || 0;\n      const opponentCrowns = battle.opponent?.[0]?.crowns || 0;\n      const isWin = teamCrowns > opponentCrowns;\n      \n      deckMap[deckKey].total++;\n      if (isWin) deckMap[deckKey].wins++;\n      else deckMap[deckKey].losses++;\n    });\n    \n    return Object.values(deckMap)\n      .sort((a, b) => b.total - a.total)\n      .slice(0, 5)\n      .map((deck, idx) => ({\n        ...deck,\n        name: idx === 0 ? 'Deck Principal' : idx === 1 ? 'Deck Secundário' : `Deck ${idx + 1}`,\n        winRate: deck.total > 0 ? Math.round((deck.wins / deck.total) * 100) : 0,\n      }));\n  }, [battles]);\n\n  const archetypeAnalysis = React.useMemo(() => {\n    if (!battles.length) {\n      return {\n        strengths: [],\n        weaknesses: [],\n      };\n    }\n\n    const beatdownCards = ['golem', 'giant', 'lavahound', 'elixir golem', 'royal giant'];\n    const cycleCards = ['skeletons', 'ice spirit', 'electro spirit', 'fire spirit', 'log', 'zap'];\n    const controlCards = ['tornado', 'rocket', 'lightning', 'x-bow', 'mortar', 'inferno tower'];\n    const airCards = ['balloon', 'lavahound', 'minions', 'mega minion', 'baby dragon', 'inferno dragon'];\n\n    const archetypeStats: Record<string, { wins: number; losses: number }> = {\n      'Beatdown': { wins: 0, losses: 0 },\n      'Ciclo': { wins: 0, losses: 0 },\n      'Controle': { wins: 0, losses: 0 },\n      'Aéreo': { wins: 0, losses: 0 },\n    };\n\n    battles.forEach((battle: any) => {\n      const opponentCards = battle.opponent?.[0]?.cards || [];\n      const cardNames = opponentCards.map((c: any) => (c.name || '').toLowerCase());\n      \n      const teamCrowns = battle.team?.[0]?.crowns || 0;\n      const opponentCrowns = battle.opponent?.[0]?.crowns || 0;\n      const isWin = teamCrowns > opponentCrowns;\n      \n      if (cardNames.some((name: string) => beatdownCards.some(bc => name.includes(bc)))) {\n        if (isWin) archetypeStats['Beatdown'].wins++;\n        else archetypeStats['Beatdown'].losses++;\n      }\n      if (cardNames.filter((name: string) => cycleCards.some(cc => name.includes(cc))).length >= 2) {\n        if (isWin) archetypeStats['Ciclo'].wins++;\n        else archetypeStats['Ciclo'].losses++;\n      }\n      if (cardNames.some((name: string) => controlCards.some(cc => name.includes(cc)))) {\n        if (isWin) archetypeStats['Controle'].wins++;\n        else archetypeStats['Controle'].losses++;\n      }\n      if (cardNames.filter((name: string) => airCards.some(ac => name.includes(ac))).length >= 2) {\n        if (isWin) archetypeStats['Aéreo'].wins++;\n        else archetypeStats['Aéreo'].losses++;\n      }\n    });\n\n    const strengths: { archetype: string; winRate: number; matches: number }[] = [];\n    const weaknesses: { archetype: string; winRate: number; matches: number }[] = [];\n\n    Object.entries(archetypeStats).forEach(([archetype, stats]) => {\n      const total = stats.wins + stats.losses;\n      if (total < 3) return;\n      \n      const winRate = Math.round((stats.wins / total) * 100);\n      const entry = { archetype, winRate, matches: total };\n      \n      if (winRate >= 55) {\n        strengths.push(entry);\n      } else if (winRate <= 45) {\n        weaknesses.push(entry);\n      }\n    });\n\n    strengths.sort((a, b) => b.winRate - a.winRate);\n    weaknesses.sort((a, b) => a.winRate - b.winRate);\n\n    return { strengths, weaknesses };\n  }, [battles]);\n\n  const trophyEvolutionData = React.useMemo(() => {\n    if (!battles.length || !player?.trophies) {\n      return null;\n    }\n\n    const battlesWithTrophyChange = battles.filter((battle: any) => \n      battle.battleTime && typeof battle.team?.[0]?.trophyChange === 'number'\n    );\n\n    if (battlesWithTrophyChange.length === 0) {\n      return null;\n    }\n\n    const dataByDate: Record<string, { trophiesAtEnd: number; totalChange: number }> = {};\n    let runningTrophies = player.trophies;\n\n    battlesWithTrophyChange.forEach((battle: any) => {\n      const battleDate = parseBattleTime(battle.battleTime);\n      const dateKey = format(battleDate, 'yyyy-MM-dd');\n      const trophyChange = battle.team[0].trophyChange;\n      \n      if (!dataByDate[dateKey]) {\n        dataByDate[dateKey] = { trophiesAtEnd: runningTrophies, totalChange: 0 };\n      }\n      dataByDate[dateKey].totalChange += trophyChange;\n      runningTrophies -= trophyChange;\n    });\n\n    const sortedDates = Object.keys(dataByDate).sort();\n    \n    if (sortedDates.length === 0) {\n      return null;\n    }\n\n    let trophiesAtEndOfDay = player.trophies;\n    \n    return sortedDates.slice(-14).map(dateKey => {\n      const data = dataByDate[dateKey];\n      const result = {\n        date: format(new Date(dateKey), 'dd/MM', { locale: ptBR }),\n        fullDate: format(new Date(dateKey), 'dd/MM/yyyy', { locale: ptBR }),\n        trophies: trophiesAtEndOfDay,\n        change: data.totalChange,\n      };\n      trophiesAtEndOfDay -= data.totalChange;\n      return result;\n    }).reverse();\n  }, [battles, player?.trophies]);\n\n  const playVolumeData = React.useMemo(() => {\n    const dayNames = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];\n    const matchesByDay: Record<string, number> = {};\n    const matchesByDayOfWeek: Record<number, number> = { 0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };\n    const matchesByHour: Record<number, number> = {};\n\n    const last14Days: { date: string; fullDate: string; matches: number; dayName: string }[] = [];\n    for (let i = 13; i >= 0; i--) {\n      const date = new Date();\n      date.setDate(date.getDate() - i);\n      const dateKey = format(date, 'yyyy-MM-dd');\n      matchesByDay[dateKey] = 0;\n      last14Days.push({\n        date: format(date, 'dd/MM', { locale: ptBR }),\n        fullDate: dateKey,\n        matches: 0,\n        dayName: dayNames[getDay(date)],\n      });\n    }\n\n    battles.forEach((battle: any) => {\n      if (!battle.battleTime) return;\n      const battleDate = parseBattleTime(battle.battleTime);\n      const dateKey = format(battleDate, 'yyyy-MM-dd');\n      const dayOfWeek = getDay(battleDate);\n      const hour = battleDate.getHours();\n\n      if (matchesByDay[dateKey] !== undefined) {\n        matchesByDay[dateKey]++;\n      }\n      matchesByDayOfWeek[dayOfWeek]++;\n      matchesByHour[hour] = (matchesByHour[hour] || 0) + 1;\n    });\n\n    last14Days.forEach(day => {\n      day.matches = matchesByDay[day.fullDate] || 0;\n    });\n\n    const totalMatchesLast14 = Object.values(matchesByDay).reduce((a, b) => a + b, 0);\n    const avgMatchesPerDay = totalMatchesLast14 > 0 ? (totalMatchesLast14 / 14).toFixed(1) : 0;\n\n    const mostActiveDay = Object.entries(matchesByDayOfWeek).reduce((max, [day, count]) => \n      count > max.count ? { day: parseInt(day), count } : max, { day: 0, count: 0 });\n\n    const peakHour = Object.entries(matchesByHour).reduce((max, [hour, count]) => \n      count > max.count ? { hour: parseInt(hour), count } : max, { hour: 12, count: 0 });\n\n    return {\n      chartData: last14Days,\n      avgMatchesPerDay,\n      mostActiveDay: dayNames[mostActiveDay.day],\n      mostActiveDayCount: mostActiveDay.count,\n      peakHour: `${peakHour.hour.toString().padStart(2, '0')}:00`,\n      peakHourCount: peakHour.count,\n      totalMatches: totalMatchesLast14,\n    };\n  }, [battles]);\n\n  const activeGoals = React.useMemo(() => {\n    if (!goalsData || !Array.isArray(goalsData)) return [];\n    return (goalsData as any[]).filter((goal: any) => goal.status === 'active' || !goal.status).slice(0, 4);\n  }, [goalsData]);\n\n  if (isLoading) {\n    return (\n      <DashboardLayout>\n        <div className=\"flex items-center justify-center min-h-[60vh]\">\n          <div className=\"text-center\">\n            <Loader2 className=\"w-12 h-12 animate-spin text-primary mx-auto mb-4\" />\n            <p className=\"text-muted-foreground\">Carregando perfil...</p>\n          </div>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout>\n      <div className=\"space-y-6\">\n        {playerError && !playerLoading && (\n          <Alert data-testid=\"alert-player-error\">\n            <AlertCircle className=\"h-4 w-4\" />\n            <AlertDescription>\n              {clashTag \n                ? `Não foi possível carregar os dados do jogador ${clashTag}. Verifique se a tag está correta.`\n                : 'Configure sua Clash Royale tag no perfil para ver seus dados.'}\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Hero Header Section */}\n        <div className=\"relative overflow-hidden rounded-2xl border border-border/50 bg-gradient-to-br from-card via-card/95 to-primary/5 backdrop-blur-sm\">\n          <div className=\"absolute inset-0 bg-grid-white/5 [mask-image:linear-gradient(0deg,transparent,black)]\" />\n          <div className=\"relative p-6 md:p-8\">\n            <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6\">\n              {/* Left: Player Info */}\n              <div className=\"flex-1\">\n                <div className=\"flex items-center gap-4 mb-4\">\n                  <div className=\"w-16 h-16 rounded-xl bg-primary/20 border border-primary/30 flex items-center justify-center\">\n                    <Swords className=\"w-8 h-8 text-primary\" />\n                  </div>\n                  <div>\n                    <h1 \n                      className=\"text-2xl md:text-3xl font-display font-bold text-foreground\"\n                      data-testid=\"header-player-name\"\n                    >\n                      {player?.name || 'Jogador'}\n                    </h1>\n                    <p \n                      className=\"text-muted-foreground font-mono text-sm\"\n                      data-testid=\"header-player-tag\"\n                    >\n                      {clashTag || '#XXXXXXXX'}\n                    </p>\n                  </div>\n                </div>\n\n                {player?.clan && (\n                  <div className=\"flex items-center gap-2 mb-4\">\n                    <Crown className=\"w-4 h-4 text-yellow-500\" />\n                    <span className=\"text-sm text-muted-foreground\">\n                      {player.clan.name}\n                    </span>\n                    {player.clan.badgeId && (\n                      <img \n                        src={`https://cdn.royaleapi.com/static/img/badge/${player.clan.badgeId}.png`}\n                        alt=\"Clan Badge\"\n                        className=\"w-5 h-5\"\n                        onError={(e) => { (e.target as HTMLImageElement).style.display = 'none'; }}\n                      />\n                    )}\n                  </div>\n                )}\n\n                {/* Summary Chips */}\n                <div className=\"flex flex-wrap gap-2\">\n                  <Badge variant=\"outline\" className=\"bg-background/50\" data-testid=\"stat-winrate\">\n                    <TrendingUp className=\"w-3 h-3 mr-1 text-green-500\" />\n                    {stats.winRate}% Win Rate\n                  </Badge>\n                  <Badge variant=\"outline\" className=\"bg-background/50\">\n                    <Swords className=\"w-3 h-3 mr-1\" />\n                    {stats.totalMatches} partidas\n                  </Badge>\n                  <Badge \n                    variant=\"outline\" \n                    className={cn(\n                      \"bg-background/50\",\n                      stats.streak.type === 'win' && \"border-green-500/50 text-green-500\",\n                      stats.streak.type === 'loss' && \"border-red-500/50 text-red-500\"\n                    )}\n                    data-testid=\"stat-streak\"\n                  >\n                    <Flame className=\"w-3 h-3 mr-1\" />\n                    {stats.streak.count > 0 \n                      ? `${stats.streak.count} ${stats.streak.type === 'win' ? 'vitórias' : 'derrotas'} seguidas`\n                      : 'Sem sequência'}\n                  </Badge>\n                  {stats.lastPlayed && (\n                    <Badge variant=\"outline\" className=\"bg-background/50\">\n                      <Clock className=\"w-3 h-3 mr-1\" />\n                      Jogou {stats.lastPlayed}\n                    </Badge>\n                  )}\n                </div>\n              </div>\n\n              {/* Right: Arena & Trophies */}\n              <div \n                className=\"flex items-center gap-4 p-4 rounded-xl bg-background/50 border border-border/50\"\n                data-testid=\"header-arena\"\n              >\n                {player?.arena?.id && (\n                  <img \n                    src={`https://cdn.royaleapi.com/static/img/arenas/arena${player.arena.id}.png`}\n                    alt={player.arena.name}\n                    className=\"w-16 h-16 md:w-20 md:h-20 object-contain\"\n                    onError={(e) => { (e.target as HTMLImageElement).style.opacity = '0.3'; }}\n                  />\n                )}\n                <div>\n                  <p className=\"text-xs text-muted-foreground uppercase tracking-wider mb-1\">\n                    {player?.arena?.name || 'Arena'}\n                  </p>\n                  <div \n                    className=\"text-3xl md:text-4xl font-display font-bold text-primary flex items-center gap-2\"\n                    data-testid=\"header-trophies\"\n                  >\n                    <Trophy className=\"w-6 h-6 md:w-8 md:h-8\" />\n                    {player?.trophies?.toLocaleString() || 0}\n                  </div>\n                  <div className=\"flex gap-3 mt-2 text-xs text-muted-foreground\">\n                    <span className=\"flex items-center gap-1\">\n                      <Award className=\"w-3 h-3 text-yellow-500\" />\n                      Melhor: {player?.bestTrophies?.toLocaleString() || 0}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Tabs Navigation */}\n        <Tabs defaultValue=\"overview\" className=\"w-full\">\n          <TabsList className=\"w-full justify-start overflow-x-auto bg-card/50 border border-border/50 p-1 h-auto flex-wrap md:flex-nowrap\">\n            <TabsTrigger value=\"overview\" data-testid=\"tab-overview\" className=\"flex-1 min-w-[100px]\">\n              Visão Geral\n            </TabsTrigger>\n            <TabsTrigger value=\"history\" data-testid=\"tab-history\" className=\"flex-1 min-w-[100px]\">\n              Histórico\n            </TabsTrigger>\n            <TabsTrigger value=\"decks\" data-testid=\"tab-decks\" className=\"flex-1 min-w-[100px]\">\n              Decks & Meta\n            </TabsTrigger>\n            <TabsTrigger value=\"progress\" data-testid=\"tab-progress\" className=\"flex-1 min-w-[100px]\">\n              Progresso\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Overview Tab */}\n          <TabsContent value=\"overview\" className=\"mt-6 space-y-6\">\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {/* Season Summary */}\n              <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-base\">\n                    <Trophy className=\"w-4 h-4 text-primary\" />\n                    Resumo da Temporada\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Troféus Atuais</span>\n                    <span className=\"font-bold text-primary\">{player?.trophies?.toLocaleString() || 0}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Melhor Temporada</span>\n                    <span className=\"font-bold text-yellow-500\">{player?.bestTrophies?.toLocaleString() || 0}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Win Rate</span>\n                    <span className=\"font-bold text-green-500\">{stats.winRate}%</span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Partidas</span>\n                    <span className=\"font-bold\">{stats.totalMatches}</span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Recent Performance */}\n              <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-base\">\n                    <Target className=\"w-4 h-4 text-primary\" />\n                    Performance Recente\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Últimas {battles.length} batalhas</span>\n                    <span className=\"font-bold\">{stats.winRate}% WR</span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Sequência Atual</span>\n                    <span className={cn(\n                      \"font-bold\",\n                      stats.streak.type === 'win' && \"text-green-500\",\n                      stats.streak.type === 'loss' && \"text-red-500\"\n                    )}>\n                      {stats.streak.count > 0 \n                        ? `${stats.streak.count}${stats.streak.type === 'win' ? 'W' : 'L'}`\n                        : '-'}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Status</span>\n                    <Badge variant={tiltStatus.variant}>{tiltStatus.label}</Badge>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">V/D</span>\n                    <span className=\"font-bold\">\n                      <span className=\"text-green-500\">{stats.wins}</span>\n                      {' / '}\n                      <span className=\"text-red-500\">{stats.losses}</span>\n                    </span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* PRO Status */}\n              <Card className={cn(\n                \"border-border/50 backdrop-blur-sm\",\n                isPro \n                  ? \"bg-gradient-to-br from-yellow-500/10 to-orange-500/10 border-yellow-500/30\"\n                  : \"bg-card/50\"\n              )}>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-base\">\n                    <Crown className={cn(\"w-4 h-4\", isPro ? \"text-yellow-500\" : \"text-muted-foreground\")} />\n                    Status da Conta\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Plano</span>\n                    <Badge variant={isPro ? \"default\" : \"secondary\"}>\n                      {isPro ? 'PRO' : 'Free'}\n                    </Badge>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Total de Vitórias</span>\n                    <span className=\"font-bold\">{player?.wins?.toLocaleString() || 0}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Cartas Coletadas</span>\n                    <span className=\"font-bold\">{player?.cards?.length || 0}</span>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Trophy Chart */}\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <TrendingUp className=\"w-5 h-5 text-primary\" />\n                  Progressão de Troféus\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-[250px] w-full\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <AreaChart data={chartData}>\n                      <defs>\n                        <linearGradient id=\"colorTrophiesMe\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0.3} />\n                          <stop offset=\"95%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0} />\n                        </linearGradient>\n                      </defs>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border))\" opacity={0.5} />\n                      <XAxis \n                        dataKey=\"date\" \n                        stroke=\"hsl(var(--muted-foreground))\" \n                        fontSize={12}\n                        tickLine={false}\n                        axisLine={false}\n                      />\n                      <YAxis \n                        stroke=\"hsl(var(--muted-foreground))\" \n                        fontSize={12}\n                        tickLine={false}\n                        axisLine={false}\n                        domain={['dataMin - 50', 'dataMax + 50']}\n                      />\n                      <Tooltip \n                        contentStyle={{ \n                          backgroundColor: 'hsl(var(--popover))', \n                          borderColor: 'hsl(var(--border))',\n                          borderRadius: '8px',\n                          color: 'hsl(var(--popover-foreground))'\n                        }}\n                      />\n                      <Area \n                        type=\"monotone\" \n                        dataKey=\"trophies\" \n                        stroke=\"hsl(var(--primary))\" \n                        strokeWidth={3}\n                        fillOpacity={1} \n                        fill=\"url(#colorTrophiesMe)\" \n                      />\n                    </AreaChart>\n                  </ResponsiveContainer>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Game Mode Stats */}\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <GameModeCard \n                title=\"Ladder / Ranqueada\"\n                icon={<Shield className=\"w-5 h-5\" />}\n                stats={stats.ladderStats}\n                color=\"primary\"\n              />\n              <GameModeCard \n                title=\"Desafios\"\n                icon={<Zap className=\"w-5 h-5\" />}\n                stats={stats.challengeStats}\n                color=\"yellow\"\n              />\n            </div>\n          </TabsContent>\n\n          {/* History Tab */}\n          <TabsContent value=\"history\" className=\"mt-6 space-y-4\">\n            {/* Filter Buttons */}\n            <div className=\"flex flex-wrap gap-2\">\n              <Button\n                variant={periodFilter === 'today' ? 'default' : 'outline'}\n                size=\"sm\"\n                onClick={() => setPeriodFilter('today')}\n                data-testid=\"filter-today\"\n              >\n                Hoje\n              </Button>\n              <Button\n                variant={periodFilter === '7days' ? 'default' : 'outline'}\n                size=\"sm\"\n                onClick={() => setPeriodFilter('7days')}\n                data-testid=\"filter-7days\"\n              >\n                7 dias\n              </Button>\n              <Button\n                variant={periodFilter === '30days' ? 'default' : 'outline'}\n                size=\"sm\"\n                onClick={() => setPeriodFilter('30days')}\n                data-testid=\"filter-30days\"\n              >\n                30 dias\n              </Button>\n              <Button\n                variant={periodFilter === 'season' ? 'default' : 'outline'}\n                size=\"sm\"\n                onClick={() => setPeriodFilter('season')}\n                data-testid=\"filter-season\"\n              >\n                Temporada\n              </Button>\n            </div>\n\n            {/* Summary - Shows last push if valid (2+ games within 30min gaps), otherwise shows recent stats */}\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n              <CardContent className=\"py-4\">\n                <div className=\"flex items-center justify-between flex-wrap gap-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Target className=\"w-5 h-5 text-primary\" />\n                    {lastPush ? (\n                      <span className=\"font-medium\" data-testid=\"push-summary\">\n                        Último push: {lastPush.battles.length} partidas,{' '}\n                        <span className=\"text-green-500\">{lastPush.wins}V</span>\n                        {' / '}\n                        <span className=\"text-red-500\">{lastPush.losses}D</span>\n                        {', '}\n                        <span className={cn(\n                          lastPush.netTrophies > 0 ? \"text-green-500\" : \n                          lastPush.netTrophies < 0 ? \"text-red-500\" : \"text-muted-foreground\"\n                        )}>\n                          {lastPush.netTrophies > 0 ? '+' : ''}{lastPush.netTrophies} troféus\n                        </span>\n                        {', '}\n                        <span className=\"text-muted-foreground\">\n                          {Math.round(lastPush.durationMs / (1000 * 60))} min de push\n                        </span>\n                      </span>\n                    ) : (\n                      <span className=\"font-medium\" data-testid=\"recent-stats-summary\">\n                        Últimas {recentSeriesStats.total} partidas:{' '}\n                        <span className=\"text-green-500\">{recentSeriesStats.wins}V</span>\n                        {' / '}\n                        <span className=\"text-red-500\">{recentSeriesStats.losses}D</span>\n                        {' '}\n                        <span className=\"text-muted-foreground\">({recentSeriesStats.winRate}% winrate)</span>\n                      </span>\n                    )}\n                  </div>\n                  <Badge variant=\"outline\">{filteredBattles.length} batalhas</Badge>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Match List - Grouped by Sessions */}\n            <div className=\"space-y-6\">\n              <h3 className=\"text-lg font-bold flex items-center gap-2\">\n                <Swords className=\"w-5 h-5 text-primary\" />\n                Histórico de Batalhas\n              </h3>\n              \n              {battlesLoading ? (\n                <div className=\"flex justify-center py-8\">\n                  <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n                </div>\n              ) : sessions.length === 0 ? (\n                <p className=\"text-center text-muted-foreground py-8\">Nenhuma batalha encontrada neste período</p>\n              ) : (\n                <div className=\"space-y-6\">\n                  {sessions.map((session, sessionIdx) => (\n                    <section key={session.startTime.toISOString()} data-testid={`session-${sessionIdx}`}>\n                      <PushSummaryRow session={session} t={t} />\n                      <div className=\"mt-2 space-y-2\">\n                        <Accordion type=\"single\" collapsible className=\"space-y-2\">\n                          {session.battles.map((battle: any, idx: number) => {\n                      const teamCrowns = battle.team?.[0]?.crowns || 0;\n                      const opponentCrowns = battle.opponent?.[0]?.crowns || 0;\n                      const isWin = teamCrowns > opponentCrowns;\n                      const isDraw = teamCrowns === opponentCrowns;\n                      const trophyChange = battle.team?.[0]?.trophyChange;\n                      const battleTime = battle.battleTime ? parseBattleTime(battle.battleTime) : null;\n                      const playerCards = battle.team?.[0]?.cards || [];\n                      const opponentCards = battle.opponent?.[0]?.cards || [];\n                      const opponent = battle.opponent?.[0];\n                      const gameMode = formatGameMode(battle.type);\n                      \n                      return (\n                        <AccordionItem \n                          key={idx} \n                          value={`match-${idx}`}\n                          className={cn(\n                            \"border rounded-lg overflow-hidden transition-colors\",\n                            isWin && !isDraw \n                              ? \"bg-green-500/5 border-green-500/20 hover:bg-green-500/10\" \n                              : isDraw \n                              ? \"bg-muted/50 border-border/50 hover:bg-muted/70\"\n                              : \"bg-red-500/5 border-red-500/20 hover:bg-red-500/10\"\n                          )}\n                          data-testid={`match-row-${idx}`}\n                        >\n                          <AccordionTrigger className=\"px-4 py-3 hover:no-underline\">\n                            <div className=\"flex items-center justify-between w-full pr-4\">\n                              {/* Left side - Result & Info */}\n                              <div className=\"flex items-center gap-3\">\n                                <Badge \n                                  variant={isWin && !isDraw ? \"default\" : isDraw ? \"secondary\" : \"destructive\"}\n                                  className={cn(\n                                    \"min-w-[70px] justify-center\",\n                                    isWin && !isDraw && \"bg-green-600 hover:bg-green-700\"\n                                  )}\n                                >\n                                  {isWin && !isDraw ? \"Vitória\" : isDraw ? \"Empate\" : \"Derrota\"}\n                                </Badge>\n                                \n                                {/* Desktop info */}\n                                <div className=\"hidden md:flex items-center gap-4\">\n                                  <div className=\"flex items-center gap-1\">\n                                    <Crown className=\"w-4 h-4 text-yellow-500\" />\n                                    <span className=\"font-bold\">{teamCrowns} × {opponentCrowns}</span>\n                                  </div>\n                                  \n                                  <Badge variant=\"outline\" className=\"font-normal\">\n                                    {gameMode}\n                                  </Badge>\n                                  \n                                  {trophyChange !== undefined && trophyChange !== null && (\n                                    <span className={cn(\n                                      \"font-medium text-sm flex items-center gap-1\",\n                                      trophyChange > 0 ? \"text-green-500\" : trophyChange < 0 ? \"text-red-500\" : \"text-muted-foreground\"\n                                    )}>\n                                      {trophyChange > 0 ? <TrendingUp className=\"w-3 h-3\" /> : trophyChange < 0 ? <TrendingDown className=\"w-3 h-3\" /> : null}\n                                      {trophyChange > 0 ? '+' : ''}{trophyChange}\n                                    </span>\n                                  )}\n                                  \n                                  <div className=\"flex flex-col\">\n                                    <span className=\"text-sm font-medium\">{opponent?.name || 'Oponente'}</span>\n                                    {opponent?.tag && (\n                                      <span className=\"text-xs text-muted-foreground font-mono\">{opponent.tag}</span>\n                                    )}\n                                  </div>\n                                </div>\n\n                                {/* Mobile info */}\n                                <div className=\"flex md:hidden flex-col\">\n                                  <div className=\"flex items-center gap-2\">\n                                    <span className=\"font-bold\">{teamCrowns} × {opponentCrowns}</span>\n                                    {trophyChange !== undefined && trophyChange !== null && (\n                                      <span className={cn(\n                                        \"text-xs font-medium\",\n                                        trophyChange > 0 ? \"text-green-500\" : trophyChange < 0 ? \"text-red-500\" : \"text-muted-foreground\"\n                                      )}>\n                                        ({trophyChange > 0 ? '+' : ''}{trophyChange})\n                                      </span>\n                                    )}\n                                  </div>\n                                  <span className=\"text-xs text-muted-foreground\">vs {opponent?.name || 'Oponente'}</span>\n                                </div>\n                              </div>\n\n                              {/* Right side - Time */}\n                              <div className=\"text-right text-xs text-muted-foreground hidden sm:block\">\n                                {battleTime && (\n                                  <span>{formatDistanceToNow(battleTime, { addSuffix: true, locale: ptBR })}</span>\n                                )}\n                              </div>\n                            </div>\n                          </AccordionTrigger>\n                          \n                          <AccordionContent data-testid={`match-details-${idx}`}>\n                            <div className=\"px-4 pb-4 pt-2 space-y-4\">\n                              {/* Battle Time on Mobile */}\n                              <div className=\"sm:hidden text-xs text-muted-foreground\">\n                                {battleTime && (\n                                  <div className=\"flex items-center gap-1\">\n                                    <Clock className=\"w-3 h-3\" />\n                                    {formatDistanceToNow(battleTime, { addSuffix: true, locale: ptBR })}\n                                  </div>\n                                )}\n                              </div>\n\n                              {/* Match Info Summary */}\n                              <div className=\"flex flex-wrap gap-3 text-sm\">\n                                <Badge variant=\"outline\">{gameMode}</Badge>\n                                {opponent?.tag && (\n                                  <span className=\"text-muted-foreground\">\n                                    Oponente: <span className=\"font-mono\">{opponent.tag}</span>\n                                  </span>\n                                )}\n                                {battle.deckSelection && (\n                                  <span className=\"text-muted-foreground\">\n                                    Seleção: {battle.deckSelection}\n                                  </span>\n                                )}\n                              </div>\n                              \n                              {/* Player Deck */}\n                              {playerCards.length > 0 && (\n                                <div>\n                                  <h4 className=\"text-sm font-medium mb-2 flex items-center gap-2\">\n                                    <Swords className=\"w-4 h-4 text-primary\" />\n                                    Seu Deck\n                                  </h4>\n                                  <div className=\"grid grid-cols-4 md:grid-cols-8 gap-1.5\">\n                                    {playerCards.map((card: any, cardIdx: number) => (\n                                      <div key={card?.id || cardIdx} className=\"flex flex-col items-center\">\n                                        <img\n                                          src={card?.iconUrls?.medium || ''}\n                                          alt={card?.name || 'Card'}\n                                          className=\"w-12 h-14 md:w-14 md:h-16 object-contain rounded bg-background/50\"\n                                          onError={(e) => { (e.target as HTMLImageElement).style.opacity = '0.3'; }}\n                                        />\n                                        <span className=\"text-[10px] text-muted-foreground mt-0.5 text-center truncate w-full\">\n                                          {card?.name}\n                                        </span>\n                                      </div>\n                                    ))}\n                                  </div>\n                                </div>\n                              )}\n                              \n                              {/* Opponent Deck */}\n                              {opponentCards.length > 0 && (\n                                <div>\n                                  <h4 className=\"text-sm font-medium mb-2 flex items-center gap-2\">\n                                    <Shield className=\"w-4 h-4 text-red-500\" />\n                                    Deck do Oponente\n                                  </h4>\n                                  <div className=\"grid grid-cols-4 md:grid-cols-8 gap-1.5\">\n                                    {opponentCards.map((card: any, cardIdx: number) => (\n                                      <div key={card?.id || cardIdx} className=\"flex flex-col items-center\">\n                                        <img\n                                          src={card?.iconUrls?.medium || ''}\n                                          alt={card?.name || 'Card'}\n                                          className=\"w-12 h-14 md:w-14 md:h-16 object-contain rounded bg-background/50\"\n                                          onError={(e) => { (e.target as HTMLImageElement).style.opacity = '0.3'; }}\n                                        />\n                                        <span className=\"text-[10px] text-muted-foreground mt-0.5 text-center truncate w-full\">\n                                          {card?.name}\n                                        </span>\n                                      </div>\n                                    ))}\n                                  </div>\n                                </div>\n                              )}\n                            </div>\n                          </AccordionContent>\n                        </AccordionItem>\n                          );\n                        })}\n                      </Accordion>\n                    </div>\n                  </section>\n                ))}\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n          {/* Decks Tab */}\n          <TabsContent value=\"decks\" className=\"mt-6 space-y-6\">\n            {/* Current Deck - Prominent Display */}\n            <Card \n              className=\"border-border/50 bg-gradient-to-br from-card via-card/95 to-primary/5 backdrop-blur-sm\"\n              data-testid=\"deck-current\"\n            >\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Layers className=\"w-5 h-5 text-primary\" />\n                  Deck Atual\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {player?.currentDeck?.length > 0 ? (\n                  <div className=\"grid grid-cols-4 md:grid-cols-8 gap-3\">\n                    {player.currentDeck.map((card: any, idx: number) => (\n                      <div key={card?.id || idx} className=\"flex flex-col items-center\">\n                        <img\n                          src={card?.iconUrls?.medium || ''}\n                          alt={card?.name || 'Card'}\n                          className=\"w-14 h-16 md:w-16 md:h-20 object-contain rounded bg-background/30\"\n                          onError={(e) => { (e.target as HTMLImageElement).style.opacity = '0.3'; }}\n                        />\n                        <span className=\"text-[10px] md:text-xs text-muted-foreground mt-1 text-center truncate w-full\">\n                          {card?.name}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <p className=\"text-center text-muted-foreground py-8\">Nenhum deck equipado</p>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Most Used Decks */}\n            <div>\n              <h3 className=\"text-lg font-bold mb-4 flex items-center gap-2\">\n                <Swords className=\"w-5 h-5 text-primary\" />\n                Decks Mais Usados\n              </h3>\n              {deckUsage.length > 0 ? (\n                <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {deckUsage.map((deck, idx) => (\n                    <Card \n                      key={idx}\n                      className=\"border-border/50 bg-card/50 backdrop-blur-sm hover:border-primary/30 transition-colors\"\n                      data-testid={`deck-most-used-${idx}`}\n                    >\n                      <CardHeader className=\"pb-2\">\n                        <div className=\"flex items-center justify-between\">\n                          <CardTitle className=\"text-base\">{deck.name}</CardTitle>\n                          <Badge \n                            variant=\"outline\"\n                            className={cn(\n                              deck.winRate >= 50 \n                                ? \"border-green-500/50 text-green-500\" \n                                : \"border-red-500/50 text-red-500\"\n                            )}\n                          >\n                            <Trophy className=\"w-3 h-3 mr-1\" />\n                            {deck.winRate}%\n                          </Badge>\n                        </div>\n                      </CardHeader>\n                      <CardContent className=\"space-y-3\">\n                        <div className=\"grid grid-cols-4 gap-1\">\n                          {deck.cards.slice(0, 8).map((card: any, cardIdx: number) => (\n                            <img\n                              key={card?.id || cardIdx}\n                              src={card?.iconUrls?.medium || ''}\n                              alt={card?.name || 'Card'}\n                              className=\"w-10 h-12 object-contain rounded bg-background/30\"\n                              onError={(e) => { (e.target as HTMLImageElement).style.opacity = '0.3'; }}\n                            />\n                          ))}\n                        </div>\n                        <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                          <span className=\"flex items-center gap-1\">\n                            <Swords className=\"w-3 h-3\" />\n                            {deck.total} partidas\n                          </span>\n                          <span>\n                            <span className=\"text-green-500\">{deck.wins}V</span>\n                            {' / '}\n                            <span className=\"text-red-500\">{deck.losses}D</span>\n                          </span>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : (\n                <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n                  <CardContent className=\"py-8 text-center text-muted-foreground\">\n                    {battlesLoading ? (\n                      <div className=\"flex items-center justify-center gap-2\">\n                        <Loader2 className=\"w-4 h-4 animate-spin\" />\n                        Analisando batalhas...\n                      </div>\n                    ) : (\n                      'Nenhuma batalha encontrada para analisar decks'\n                    )}\n                  </CardContent>\n                </Card>\n              )}\n            </div>\n\n            {/* Strengths & Weaknesses */}\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              {/* Strengths */}\n              <Card \n                className=\"border-border/50 bg-card/50 backdrop-blur-sm\"\n                data-testid=\"analysis-strengths\"\n              >\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-base\">\n                    <ThumbsUp className=\"w-5 h-5 text-green-500\" />\n                    Forças\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  {archetypeAnalysis.strengths.length > 0 ? (\n                    archetypeAnalysis.strengths.map((strength, idx) => (\n                      <div \n                        key={idx}\n                        className=\"flex items-center justify-between p-3 rounded-lg bg-green-500/10 border border-green-500/20\"\n                      >\n                        <div>\n                          <p className=\"font-medium text-green-500\">Bom contra: {strength.archetype}</p>\n                          <p className=\"text-xs text-muted-foreground\">{strength.matches} partidas</p>\n                        </div>\n                        <Badge variant=\"outline\" className=\"border-green-500/50 text-green-500\">\n                          {strength.winRate}% WR\n                        </Badge>\n                      </div>\n                    ))\n                  ) : (\n                    <div className=\"relative\">\n                      <div className={cn(\n                        \"p-3 rounded-lg bg-muted/50 border border-border/50\",\n                        !isPro && \"blur-sm\"\n                      )}>\n                        <p className=\"font-medium text-green-500\">Bom contra: Decks de ciclo</p>\n                        <p className=\"text-xs text-muted-foreground\">Análise baseada em batalhas</p>\n                      </div>\n                      {!isPro && (\n                        <div className=\"absolute inset-0 flex items-center justify-center\">\n                          <Badge variant=\"outline\" className=\"bg-background/80 flex items-center gap-1\">\n                            <Lock className=\"w-3 h-3\" />\n                            PRO\n                          </Badge>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  {archetypeAnalysis.strengths.length === 0 && isPro && (\n                    <p className=\"text-sm text-muted-foreground text-center py-2\">\n                      Jogue mais partidas para ver suas forças\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* Weaknesses */}\n              <Card \n                className=\"border-border/50 bg-card/50 backdrop-blur-sm\"\n                data-testid=\"analysis-weaknesses\"\n              >\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-base\">\n                    <ThumbsDown className=\"w-5 h-5 text-red-500\" />\n                    Fraquezas\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  {archetypeAnalysis.weaknesses.length > 0 ? (\n                    archetypeAnalysis.weaknesses.map((weakness, idx) => (\n                      <div \n                        key={idx}\n                        className=\"flex items-center justify-between p-3 rounded-lg bg-red-500/10 border border-red-500/20\"\n                      >\n                        <div>\n                          <p className=\"font-medium text-red-500\">Dificuldade contra: {weakness.archetype}</p>\n                          <p className=\"text-xs text-muted-foreground\">{weakness.matches} partidas</p>\n                        </div>\n                        <Badge variant=\"outline\" className=\"border-red-500/50 text-red-500\">\n                          {weakness.winRate}% WR\n                        </Badge>\n                      </div>\n                    ))\n                  ) : (\n                    <div className=\"relative\">\n                      <div className={cn(\n                        \"p-3 rounded-lg bg-muted/50 border border-border/50\",\n                        !isPro && \"blur-sm\"\n                      )}>\n                        <p className=\"font-medium text-red-500\">Dificuldade contra: Beatdown</p>\n                        <p className=\"text-xs text-muted-foreground\">Análise baseada em batalhas</p>\n                      </div>\n                      {!isPro && (\n                        <div className=\"absolute inset-0 flex items-center justify-center\">\n                          <Badge variant=\"outline\" className=\"bg-background/80 flex items-center gap-1\">\n                            <Lock className=\"w-3 h-3\" />\n                            PRO\n                          </Badge>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  {archetypeAnalysis.weaknesses.length === 0 && isPro && (\n                    <p className=\"text-sm text-muted-foreground text-center py-2\">\n                      Jogue mais partidas para ver suas fraquezas\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Progress Tab */}\n          <TabsContent value=\"progress\" className=\"mt-6 space-y-6\">\n            {/* Trophy Evolution Chart */}\n            {trophyEvolutionData && trophyEvolutionData.length > 0 ? (\n              <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\" data-testid=\"chart-trophy-evolution\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <TrendingUp className=\"w-5 h-5 text-primary\" />\n                    Evolução de Troféus\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-[280px] w-full\">\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\n                      <AreaChart data={trophyEvolutionData}>\n                        <defs>\n                          <linearGradient id=\"colorTrophiesProgress\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                            <stop offset=\"5%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0.3} />\n                            <stop offset=\"95%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0} />\n                          </linearGradient>\n                        </defs>\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border))\" opacity={0.5} />\n                        <XAxis \n                          dataKey=\"date\" \n                          stroke=\"hsl(var(--muted-foreground))\" \n                          fontSize={11}\n                          tickLine={false}\n                          axisLine={false}\n                        />\n                        <YAxis \n                          stroke=\"hsl(var(--muted-foreground))\" \n                          fontSize={11}\n                          tickLine={false}\n                          axisLine={false}\n                          domain={['dataMin - 100', 'dataMax + 100']}\n                          tickFormatter={(value) => value.toLocaleString()}\n                        />\n                        <Tooltip \n                          contentStyle={{ \n                            backgroundColor: 'hsl(var(--popover))', \n                            borderColor: 'hsl(var(--border))',\n                            borderRadius: '8px',\n                            color: 'hsl(var(--popover-foreground))'\n                          }}\n                          formatter={(value: number, name: string) => [\n                            value.toLocaleString(), \n                            name === 'trophies' ? 'Troféus' : name\n                          ]}\n                          labelFormatter={(label) => `Data: ${label}`}\n                        />\n                        <Area \n                          type=\"monotone\" \n                          dataKey=\"trophies\" \n                          stroke=\"hsl(var(--primary))\" \n                          strokeWidth={3}\n                          fillOpacity={1} \n                          fill=\"url(#colorTrophiesProgress)\" \n                          dot={{ fill: 'hsl(var(--primary))', strokeWidth: 2, r: 4 }}\n                          activeDot={{ r: 6, fill: 'hsl(var(--primary))' }}\n                        />\n                      </AreaChart>\n                    </ResponsiveContainer>\n                  </div>\n                  <div className=\"mt-4 flex flex-wrap gap-4 justify-center text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      <Trophy className=\"w-4 h-4 text-primary\" />\n                      <span className=\"text-muted-foreground\">Atual:</span>\n                      <span className=\"font-bold text-primary\">{player?.trophies?.toLocaleString() || 0}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Award className=\"w-4 h-4 text-yellow-500\" />\n                      <span className=\"text-muted-foreground\">Melhor:</span>\n                      <span className=\"font-bold text-yellow-500\">{player?.bestTrophies?.toLocaleString() || 0}</span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ) : (\n              <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\" data-testid=\"empty-trophy-data\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <TrendingUp className=\"w-5 h-5 text-primary\" />\n                    Evolução de Troféus\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n                    <Trophy className=\"w-12 h-12 text-muted-foreground/50 mb-4\" />\n                    <p className=\"text-lg font-medium text-muted-foreground mb-2\">\n                      Sem dados de evolução disponíveis\n                    </p>\n                    <p className=\"text-sm text-muted-foreground/70\">\n                      {battles.length === 0 \n                        ? \"Jogue mais partidas para ver seu progresso\"\n                        : \"Suas batalhas recentes não possuem dados de troféus\"}\n                    </p>\n                    {player?.trophies && (\n                      <div className=\"mt-6 flex items-center gap-2\">\n                        <Trophy className=\"w-4 h-4 text-primary\" />\n                        <span className=\"text-muted-foreground\">Troféus atuais:</span>\n                        <span className=\"font-bold text-primary\">{player.trophies.toLocaleString()}</span>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Play Volume Section */}\n            <div className=\"grid lg:grid-cols-3 gap-6\">\n              <Card className=\"lg:col-span-2 border-border/50 bg-card/50 backdrop-blur-sm\" data-testid=\"chart-play-volume\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Swords className=\"w-5 h-5 text-primary\" />\n                    Volume de Jogo (14 dias)\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-[200px] w-full\">\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\n                      <BarChart data={playVolumeData.chartData}>\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border))\" opacity={0.5} />\n                        <XAxis \n                          dataKey=\"date\" \n                          stroke=\"hsl(var(--muted-foreground))\" \n                          fontSize={10}\n                          tickLine={false}\n                          axisLine={false}\n                        />\n                        <YAxis \n                          stroke=\"hsl(var(--muted-foreground))\" \n                          fontSize={11}\n                          tickLine={false}\n                          axisLine={false}\n                          allowDecimals={false}\n                        />\n                        <Tooltip \n                          contentStyle={{ \n                            backgroundColor: 'hsl(var(--popover))', \n                            borderColor: 'hsl(var(--border))',\n                            borderRadius: '8px',\n                            color: 'hsl(var(--popover-foreground))'\n                          }}\n                          formatter={(value: number) => [`${value} partidas`, 'Partidas']}\n                          labelFormatter={(label) => `Data: ${label}`}\n                        />\n                        <Bar \n                          dataKey=\"matches\" \n                          fill=\"hsl(var(--primary))\" \n                          radius={[4, 4, 0, 0]}\n                          maxBarSize={40}\n                        />\n                      </BarChart>\n                    </ResponsiveContainer>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Play Stats Cards */}\n              <div className=\"flex flex-col gap-4\">\n                <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm flex-1\">\n                  <CardContent className=\"p-4 flex items-center gap-4\">\n                    <div className=\"p-3 rounded-xl bg-primary/20\">\n                      <Swords className=\"w-5 h-5 text-primary\" />\n                    </div>\n                    <div>\n                      <p className=\"text-xs text-muted-foreground\">Média por Dia</p>\n                      <p className=\"text-2xl font-bold\">{playVolumeData.avgMatchesPerDay}</p>\n                    </div>\n                  </CardContent>\n                </Card>\n                <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm flex-1\">\n                  <CardContent className=\"p-4 flex items-center gap-4\">\n                    <div className=\"p-3 rounded-xl bg-green-500/20\">\n                      <Flame className=\"w-5 h-5 text-green-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-xs text-muted-foreground\">Dia Mais Ativo</p>\n                      <p className=\"text-xl font-bold\">{playVolumeData.mostActiveDay}</p>\n                      <p className=\"text-xs text-muted-foreground\">{playVolumeData.mostActiveDayCount} partidas</p>\n                    </div>\n                  </CardContent>\n                </Card>\n                <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm flex-1\">\n                  <CardContent className=\"p-4 flex items-center gap-4\">\n                    <div className=\"p-3 rounded-xl bg-yellow-500/20\">\n                      <Clock className=\"w-5 h-5 text-yellow-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-xs text-muted-foreground\">Horário de Pico</p>\n                      <p className=\"text-xl font-bold\">{playVolumeData.peakHour}</p>\n                      <p className=\"text-xs text-muted-foreground\">{playVolumeData.peakHourCount} partidas</p>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n\n            {/* Goals Section */}\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n              <CardHeader className=\"flex flex-row items-center justify-between\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Target className=\"w-5 h-5 text-primary\" />\n                  Metas Ativas\n                </CardTitle>\n                <Link href=\"/profile\">\n                  <Button variant=\"outline\" size=\"sm\" data-testid=\"link-manage-goals\">\n                    Gerenciar Metas\n                  </Button>\n                </Link>\n              </CardHeader>\n              <CardContent>\n                {goalsLoading ? (\n                  <div className=\"flex items-center justify-center py-8\">\n                    <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n                  </div>\n                ) : activeGoals.length > 0 ? (\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    {activeGoals.map((goal: any) => {\n                      const progressValue = goal.targetValue > 0 \n                        ? Math.min(100, Math.round((goal.currentValue / goal.targetValue) * 100))\n                        : 0;\n                      return (\n                        <div \n                          key={goal.id}\n                          className=\"p-4 rounded-lg bg-background/50 border border-border/50\"\n                          data-testid={`goal-card-${goal.id}`}\n                        >\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <h4 className=\"font-medium text-sm\">{goal.title || goal.name}</h4>\n                            <Badge variant=\"outline\" className={cn(\n                              progressValue >= 100 \n                                ? \"border-green-500/50 text-green-500\" \n                                : \"border-primary/50 text-primary\"\n                            )}>\n                              {progressValue}%\n                            </Badge>\n                          </div>\n                          <Progress value={progressValue} className=\"h-2 mb-2\" />\n                          <div className=\"flex justify-between text-xs text-muted-foreground\">\n                            <span>Atual: {goal.currentValue || 0}</span>\n                            <span>Meta: {goal.targetValue || 0}</span>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Target className=\"w-12 h-12 mx-auto mb-3 opacity-30\" />\n                    <p className=\"mb-2\">Nenhuma meta ativa</p>\n                    <Link href=\"/profile\">\n                      <Button variant=\"outline\" size=\"sm\">\n                        Criar Meta\n                      </Button>\n                    </Link>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Achievements/Stats Summary */}\n            <div className=\"grid md:grid-cols-2 gap-6\" data-testid=\"stats-summary\">\n              <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-base\">\n                    <Award className=\"w-5 h-5 text-yellow-500\" />\n                    Conquistas Gerais\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <StatRow label=\"Nível do Rei\" value={player?.expLevel || 0} />\n                  <StatRow label=\"Total de Vitórias\" value={player?.wins?.toLocaleString() || 0} />\n                  <StatRow label=\"Total de Derrotas\" value={player?.losses?.toLocaleString() || 0} />\n                  <StatRow label=\"Vitórias em 3 Coroas\" value={player?.threeCrownWins?.toLocaleString() || 0} />\n                  <StatRow label=\"Máximo de Desafio\" value={player?.challengeMaxWins || 0} />\n                  <StatRow label=\"Cartas Encontradas\" value={player?.cards?.length || 0} />\n                </CardContent>\n              </Card>\n              \n              <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-base\">\n                    <Crown className=\"w-5 h-5 text-yellow-500\" />\n                    Conquistas de Clã\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <StatRow label=\"Doações Totais\" value={player?.totalDonations?.toLocaleString() || 0} />\n                  <StatRow label=\"Doações Recebidas\" value={player?.clanCardsCollected?.toLocaleString() || 0} />\n                  <StatRow label=\"Guerras de Clã\" value={player?.warDayWins || 0} />\n                  <StatRow label=\"Contribuição de Clã\" value={player?.clanContributionPoints?.toLocaleString() || 0} />\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* PRO Feature Placeholder */}\n            <Card \n              className=\"border-border/50 bg-card/50 backdrop-blur-sm overflow-hidden\"\n              data-testid=\"pro-locked-section\"\n            >\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Zap className=\"w-5 h-5 text-yellow-500\" />\n                  Análises Avançadas\n                  {!isPro && (\n                    <Badge variant=\"outline\" className=\"ml-2 border-yellow-500/50 text-yellow-500\">\n                      PRO\n                    </Badge>\n                  )}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"relative\">\n                  <div className={cn(\n                    \"grid md:grid-cols-3 gap-4 p-4 rounded-lg\",\n                    !isPro && \"blur-sm pointer-events-none\"\n                  )}>\n                    <div className=\"p-4 bg-background/50 rounded-lg border border-border/50\">\n                      <h4 className=\"font-medium mb-2\">Predição de Troféus</h4>\n                      <p className=\"text-2xl font-bold text-primary\">+150</p>\n                      <p className=\"text-xs text-muted-foreground\">próxima semana</p>\n                    </div>\n                    <div className=\"p-4 bg-background/50 rounded-lg border border-border/50\">\n                      <h4 className=\"font-medium mb-2\">Deck Ideal</h4>\n                      <p className=\"text-2xl font-bold text-green-500\">85%</p>\n                      <p className=\"text-xs text-muted-foreground\">winrate estimado</p>\n                    </div>\n                    <div className=\"p-4 bg-background/50 rounded-lg border border-border/50\">\n                      <h4 className=\"font-medium mb-2\">Matchup Analysis</h4>\n                      <p className=\"text-2xl font-bold text-yellow-500\">12</p>\n                      <p className=\"text-xs text-muted-foreground\">decks analisados</p>\n                    </div>\n                  </div>\n                  {!isPro && (\n                    <div className=\"absolute inset-0 flex flex-col items-center justify-center bg-background/20 backdrop-blur-[2px] rounded-lg\">\n                      <div className=\"p-3 rounded-full bg-yellow-500/20 mb-3\">\n                        <Lock className=\"w-6 h-6 text-yellow-500\" />\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mb-3\">Disponível no plano PRO</p>\n                      <Link href=\"/billing\">\n                        <Button \n                          size=\"sm\" \n                          className=\"bg-gradient-to-r from-yellow-500 to-orange-500 text-white hover:from-yellow-600 hover:to-orange-600\"\n                          data-testid=\"button-unlock-pro\"\n                        >\n                          Desbloquear no PRO\n                        </Button>\n                      </Link>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </DashboardLayout>\n  );\n}\n\nfunction GameModeCard({ title, icon, stats, color }: { \n  title: string; \n  icon: React.ReactNode; \n  stats: { wins: number; losses: number; matches: number; winRate: number | string };\n  color: 'primary' | 'yellow';\n}) {\n  const colorClasses = {\n    primary: 'text-primary',\n    yellow: 'text-yellow-500',\n  };\n\n  return (\n    <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm hover:border-primary/30 transition-colors\">\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-center gap-3 mb-4\">\n          <div className={cn(\"p-2 rounded-lg bg-background/50\", colorClasses[color])}>\n            {icon}\n          </div>\n          <h3 className=\"font-bold\">{title}</h3>\n        </div>\n        <div className=\"grid grid-cols-3 gap-4 text-center\">\n          <div>\n            <p className=\"text-2xl font-bold text-green-500\">{stats.wins}</p>\n            <p className=\"text-xs text-muted-foreground\">Vitórias</p>\n          </div>\n          <div>\n            <p className=\"text-2xl font-bold text-red-500\">{stats.losses}</p>\n            <p className=\"text-xs text-muted-foreground\">Derrotas</p>\n          </div>\n          <div>\n            <p className=\"text-2xl font-bold\">{stats.winRate}%</p>\n            <p className=\"text-xs text-muted-foreground\">Win Rate</p>\n          </div>\n        </div>\n        {stats.matches > 0 && (\n          <div className=\"mt-4 flex items-center justify-center gap-2 text-sm text-muted-foreground\">\n            <Swords className=\"w-4 h-4\" />\n            {stats.matches} partidas\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction StatRow({ label, value }: { label: string; value: string | number }) {\n  return (\n    <div className=\"flex justify-between items-center py-2 border-b border-border/30 last:border-0\">\n      <span className=\"text-sm text-muted-foreground\">{label}</span>\n      <span className=\"font-bold\">{value}</span>\n    </div>\n  );\n}\n","path":null,"size_bytes":85570,"size_tokens":null},"client/src/hooks/useAuth.ts":{"content":"// From javascript_log_in_with_replit blueprint\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","path":null,"size_bytes":355,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4419,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"import * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1237,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // @replit\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          // @replit no hover because we use hover-elevate\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n          // @replit shadow-xs\" - use badge outline variable\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1522,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3835,"size_tokens":null},"client/src/hooks/useNotifications.ts":{"content":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { api } from '../lib/api';\nimport { toast } from 'sonner';\n\nexport function useNotifications() {\n  return useQuery({\n    queryKey: ['notifications'],\n    queryFn: () => api.notifications.list(),\n  });\n}\n\nexport function useMarkNotificationRead() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: (id: string) => api.notifications.markRead(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['notifications'] });\n    },\n    onError: (error: Error) => {\n      toast.error(`Erro ao marcar notificação: ${error.message}`);\n    },\n  });\n}\n","path":null,"size_bytes":681,"size_tokens":null},"client/src/index.css":{"content":"@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --font-sans: 'Inter', sans-serif;\n  --font-display: 'Rubik', sans-serif;\n\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n\n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n\n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n\n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n\n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n\n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n\n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n\n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n\n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n\n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n\n  --color-chart-1: hsl(var(--chart-1));\n  --color-chart-2: hsl(var(--chart-2));\n  --color-chart-3: hsl(var(--chart-3));\n  --color-chart-4: hsl(var(--chart-4));\n  --color-chart-5: hsl(var(--chart-5));\n\n  --color-sidebar: hsl(var(--sidebar));\n  --color-sidebar-foreground: hsl(var(--sidebar-foreground));\n  --color-sidebar-primary: hsl(var(--sidebar-primary));\n  --color-sidebar-primary-foreground: hsl(var(--sidebar-primary-foreground));\n  --color-sidebar-accent: hsl(var(--sidebar-accent));\n  --color-sidebar-accent-foreground: hsl(var(--sidebar-accent-foreground));\n  --color-sidebar-border: hsl(var(--sidebar-border));\n  --color-sidebar-ring: hsl(var(--sidebar-ring));\n}\n\n/* Default to Dark Mode for Gaming Aesthetic */\n:root {\n  /* Deep Blue/Black Background */\n  --background: 224 71% 4%; \n  --foreground: 210 40% 98%;\n\n  /* Darker Cards */\n  --card: 222 47% 11%;\n  --card-foreground: 210 40% 98%;\n\n  --popover: 222 47% 11%;\n  --popover-foreground: 210 40% 98%;\n\n  /* Gold Primary (Clash Royale style) */\n  --primary: 43 96% 56%; \n  --primary-foreground: 224 71% 4%;\n\n  /* Blue Secondary */\n  --secondary: 217 91% 60%;\n  --secondary-foreground: 210 40% 98%;\n\n  --muted: 217 33% 17%;\n  --muted-foreground: 215 20% 65%;\n\n  --accent: 217 33% 17%;\n  --accent-foreground: 210 40% 98%;\n\n  --destructive: 0 62.8% 30.6%;\n  --destructive-foreground: 210 40% 98%;\n\n  --border: 217 33% 17%;\n  --input: 217 33% 17%;\n  --ring: 224 76% 48%;\n\n  --radius: 0.75rem;\n\n  --chart-1: 220 70% 50%;\n  --chart-2: 160 60% 45%;\n  --chart-3: 30 80% 55%;\n  --chart-4: 280 65% 60%;\n  --chart-5: 340 75% 55%;\n\n  --sidebar: 224 71% 4%;\n  --sidebar-foreground: 240 5% 96%;\n  --sidebar-primary: 43 96% 56%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 240 3.7% 15.9%;\n  --sidebar-accent-foreground: 240 4.8% 95.9%;\n  --sidebar-border: 240 3.7% 15.9%;\n  --sidebar-ring: 217 91% 60%;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-display tracking-tight;\n  }\n}\n\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n  \n  /* Page Transitions */\n  .page-transition-enter {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  .page-transition-enter-active {\n    opacity: 1;\n    transform: translateY(0);\n    transition: opacity 300ms, transform 300ms;\n  }\n  .page-transition-exit {\n    opacity: 1;\n    transform: translateY(0);\n  }\n  .page-transition-exit-active {\n    opacity: 0;\n    transform: translateY(-10px);\n    transition: opacity 300ms, transform 300ms;\n  }\n  \n  /* Hover effects for interactive elements */\n  .interactive-hover {\n    @apply transition-all duration-200 hover:scale-[1.02] active:scale-[0.98];\n  }\n}\n","path":null,"size_bytes":4338,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":792,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7406,"size_tokens":null},"client/src/components/ui/empty.tsx":{"content":"import { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Empty({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty\"\n      className={cn(\n        \"flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-header\"\n      className={cn(\n        \"flex max-w-sm flex-col items-center gap-2 text-center\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst emptyMediaVariants = cva(\n  \"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction EmptyMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof emptyMediaVariants>) {\n  return (\n    <div\n      data-slot=\"empty-icon\"\n      data-variant={variant}\n      className={cn(emptyMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-title\"\n      className={cn(\"text-lg font-medium tracking-tight\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <div\n      data-slot=\"empty-description\"\n      className={cn(\n        \"text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-content\"\n      className={cn(\n        \"flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Empty,\n  EmptyHeader,\n  EmptyTitle,\n  EmptyDescription,\n  EmptyContent,\n  EmptyMedia,\n}\n","path":null,"size_bytes":2396,"size_tokens":null},"client/src/hooks/useFavorites.ts":{"content":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { api } from '../lib/api';\nimport { toast } from 'sonner';\n\nexport function useFavorites() {\n  return useQuery({\n    queryKey: ['favorites'],\n    queryFn: () => api.favorites.list(),\n  });\n}\n\nexport function useCreateFavorite() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: (data: any) => api.favorites.create(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['favorites'] });\n      toast.success('Jogador adicionado aos favoritos!');\n    },\n    onError: (error: Error) => {\n      toast.error(`Erro ao adicionar favorito: ${error.message}`);\n    },\n  });\n}\n\nexport function useDeleteFavorite() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: (id: string) => api.favorites.delete(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['favorites'] });\n      toast.success('Jogador removido dos favoritos!');\n    },\n    onError: (error: Error) => {\n      toast.error(`Erro ao remover favorito: ${error.message}`);\n    },\n  });\n}\n","path":null,"size_bytes":1138,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/pages/dashboard.tsx":{"content":"import React from \"react\";\nimport { Link } from \"wouter\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Trophy, Swords, Crown, TrendingUp, Clock, Target, Star, ChevronRight, Loader2, AlertCircle } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useProfile } from \"@/hooks/useProfile\";\nimport { useClashPlayer, useClashBattles } from \"@/hooks/useClashPlayer\";\nimport { useGoals } from \"@/hooks/useGoals\";\nimport { useFavorites } from \"@/hooks/useFavorites\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport {\n  Area,\n  AreaChart,\n  CartesianGrid,\n  ResponsiveContainer,\n  Tooltip,\n  XAxis,\n  YAxis,\n} from \"recharts\";\n\nconst chartData = [\n  { date: \"Seg\", trophies: 5780 },\n  { date: \"Ter\", trophies: 5810 },\n  { date: \"Qua\", trophies: 5795 },\n  { date: \"Qui\", trophies: 5820 },\n  { date: \"Sex\", trophies: 5835 },\n  { date: \"Sab\", trophies: 5800 },\n  { date: \"Dom\", trophies: 5842 },\n];\n\nexport default function DashboardPage() {\n  const { data: profile, isLoading: profileLoading } = useProfile();\n  const { data: playerData, isLoading: playerLoading, error: playerError } = useClashPlayer((profile as any)?.clashTag);\n  const { data: battlesData, isLoading: battlesLoading } = useClashBattles((profile as any)?.clashTag);\n  const { data: goals = [], isLoading: goalsLoading } = useGoals();\n  const { data: favorites = [], isLoading: favoritesLoading } = useFavorites();\n\n  const isLoading = profileLoading || playerLoading;\n  const battles = (battlesData as any) || [];\n  const recentBattles = battles.slice(0, 5);\n\n  // Calculate win rate from recent battles\n  const calculateWinRate = () => {\n    if (!battles.length) return 0;\n    const wins = battles.filter((b: any) => \n      b.team?.[0]?.crowns > b.opponent?.[0]?.crowns\n    ).length;\n    return ((wins / battles.length) * 100).toFixed(1);\n  };\n\n  return (\n    <DashboardLayout>\n      <div className=\"space-y-8\">\n        {/* Header Section */}\n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-display font-bold text-foreground\">Dashboard</h1>\n            <p className=\"text-muted-foreground\">Visão geral do seu desempenho na arena</p>\n          </div>\n          <div className=\"flex items-center gap-2 px-4 py-2 bg-card border border-border rounded-lg shadow-sm\">\n            {isLoading ? (\n              <>\n                <Loader2 className=\"w-4 h-4 animate-spin text-primary\" />\n                <span className=\"text-sm font-medium text-muted-foreground\">Carregando...</span>\n              </>\n            ) : (\n              <>\n                <span className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\" />\n                <span className=\"text-sm font-medium text-muted-foreground\">Dados sincronizados agora</span>\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* Error State */}\n        {playerError && !playerLoading && (\n          <Alert data-testid=\"alert-player-error\">\n            <AlertCircle className=\"h-4 w-4\" />\n            <AlertDescription>\n              {(profile as any)?.clashTag \n                ? `Não foi possível carregar os dados do jogador ${(profile as any).clashTag}. Verifique se a tag está correta.`\n                : 'Configure sua Clash Royale tag no perfil para ver seus dados.'}\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Stats Grid */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          <StatCard \n            title=\"Troféus Atuais\" \n            value={isLoading ? \"...\" : ((playerData as any)?.trophies || 0)} \n            icon={<Trophy className=\"w-5 h-5 text-primary\" />}\n            trend={(playerData as any)?.trophies ? `Arena: ${(playerData as any)?.arena?.name || 'N/A'}` : undefined}\n            trendUp={true}\n            arenaImage={(playerData as any)?.arena?.id ? `https://cdn.royaleapi.com/static/img/arenas/arena${(playerData as any).arena.id}.png` : undefined}\n          />\n          <StatCard \n            title=\"Melhor Temporada\" \n            value={isLoading ? \"...\" : ((playerData as any)?.bestTrophies || 0)} \n            icon={<Crown className=\"w-5 h-5 text-yellow-500\" />}\n            subtext=\"Recorde Pessoal\"\n          />\n          <StatCard \n            title=\"Win Rate\" \n            value={isLoading ? \"...\" : `${calculateWinRate()}%`} \n            icon={<TrendingUp className=\"w-5 h-5 text-green-500\" />}\n            subtext={`Últimas ${battles.length} batalhas`}\n          />\n          <StatCard \n            title=\"Vitórias\" \n            value={isLoading ? \"...\" : ((playerData as any)?.wins || 0)} \n            icon={<Swords className=\"w-5 h-5 text-blue-500\" />}\n            subtext={`${(playerData as any)?.losses || 0} derrotas`}\n          />\n        </div>\n\n        {/* Current Deck Section */}\n        {(playerData as any)?.currentDeck && (playerData as any).currentDeck.length > 0 && (\n          <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\" data-testid=\"current-deck-section\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Swords className=\"w-5 h-5 text-primary\" />\n                Deck Atual\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex flex-wrap gap-2 justify-center md:justify-start\">\n                {(playerData as any).currentDeck.map((card: any, idx: number) => (\n                  <CardImage key={card?.id || idx} card={card} size=\"medium\" />\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        <div className=\"grid lg:grid-cols-3 gap-8\">\n          {/* Main Column */}\n          <div className=\"lg:col-span-2 space-y-8\">\n             {/* Chart Section */}\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle>Progresso de Troféus</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-[300px] w-full\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <AreaChart data={chartData}>\n                      <defs>\n                        <linearGradient id=\"colorTrophies\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0.3} />\n                          <stop offset=\"95%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0} />\n                        </linearGradient>\n                      </defs>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border))\" opacity={0.5} />\n                      <XAxis \n                        dataKey=\"date\" \n                        stroke=\"hsl(var(--muted-foreground))\" \n                        fontSize={12}\n                        tickLine={false}\n                        axisLine={false}\n                      />\n                      <YAxis \n                        stroke=\"hsl(var(--muted-foreground))\" \n                        fontSize={12}\n                        tickLine={false}\n                        axisLine={false}\n                        domain={['dataMin - 50', 'dataMax + 50']}\n                      />\n                      <Tooltip \n                        contentStyle={{ \n                          backgroundColor: 'hsl(var(--popover))', \n                          borderColor: 'hsl(var(--border))',\n                          borderRadius: '8px',\n                          color: 'hsl(var(--popover-foreground))'\n                        }}\n                      />\n                      <Area \n                        type=\"monotone\" \n                        dataKey=\"trophies\" \n                        stroke=\"hsl(var(--primary))\" \n                        strokeWidth={3}\n                        fillOpacity={1} \n                        fill=\"url(#colorTrophies)\" \n                      />\n                    </AreaChart>\n                  </ResponsiveContainer>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Goals Section */}\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n               <CardHeader className=\"flex flex-row items-center justify-between\">\n                  <CardTitle className=\"flex items-center gap-2\">\n                     <Target className=\"w-5 h-5 text-primary\" />\n                     Metas Ativas\n                  </CardTitle>\n                  <Link href=\"/profile\">\n                    <Button variant=\"ghost\" size=\"sm\" className=\"h-8 text-xs\" data-testid=\"button-manage-goals\">Gerenciar</Button>\n                  </Link>\n               </CardHeader>\n               <CardContent className=\"space-y-6\">\n                  {goalsLoading ? (\n                    <div className=\"flex items-center justify-center py-8\">\n                      <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n                    </div>\n                  ) : (goals as any[]).length === 0 ? (\n                    <p className=\"text-sm text-muted-foreground text-center py-4\">Nenhuma meta ativa</p>\n                  ) : (\n                    (goals as any[]).slice(0, 3).map((goal: any) => (\n                      <div key={goal.id} className=\"space-y-2\" data-testid={`goal-${goal.id}`}>\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"font-medium\">{goal.title}</span>\n                          <span className=\"text-muted-foreground\">{goal.currentValue} / {goal.targetValue}</span>\n                        </div>\n                        <Progress value={(goal.currentValue / goal.targetValue) * 100} className=\"h-2\" />\n                      </div>\n                    ))\n                  )}\n               </CardContent>\n            </Card>\n          </div>\n\n          {/* Sidebar Column */}\n          <div className=\"space-y-8\">\n            {/* Recent Battles List */}\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle>Últimas Batalhas</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                {battlesLoading ? (\n                  <div className=\"flex items-center justify-center py-8\">\n                    <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n                  </div>\n                ) : recentBattles.length === 0 ? (\n                  <p className=\"text-sm text-muted-foreground text-center py-4\">Nenhuma batalha recente</p>\n                ) : (\n                  recentBattles.map((battle: any, idx: number) => {\n                    const teamCrowns = battle.team?.[0]?.crowns || 0;\n                    const opponentCrowns = battle.opponent?.[0]?.crowns || 0;\n                    const isWin = teamCrowns > opponentCrowns;\n                    const isDraw = teamCrowns === opponentCrowns;\n                    const opponentName = battle.opponent?.[0]?.name || 'Oponente';\n                    // Parse Clash Royale API date format: \"20231215T123456.000Z\" -> \"2023-12-15T12:34:56.000Z\"\n                    const parseBattleTime = (timeStr: string) => {\n                      if (!timeStr) return new Date();\n                      const formatted = timeStr.replace(\n                        /^(\\d{4})(\\d{2})(\\d{2})T(\\d{2})(\\d{2})(\\d{2})\\.(\\d{3})Z$/,\n                        '$1-$2-$3T$4:$5:$6.$7Z'\n                      );\n                      const date = new Date(formatted);\n                      return isNaN(date.getTime()) ? new Date() : date;\n                    };\n                    const battleTime = parseBattleTime(battle.battleTime);\n\n                    return (\n                      <div \n                        key={idx}\n                        className=\"flex items-center justify-between p-3 rounded-lg border border-border/50 hover:bg-white/5 transition-colors cursor-pointer interactive-hover\"\n                        data-testid={`battle-${idx}`}\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <div className={cn(\n                            \"w-10 h-10 rounded flex items-center justify-center font-bold text-lg border shrink-0\",\n                            isWin && !isDraw\n                              ? \"bg-green-500/10 text-green-500 border-green-500/20\" \n                              : isDraw\n                              ? \"bg-gray-500/10 text-gray-500 border-gray-500/20\"\n                              : \"bg-red-500/10 text-red-500 border-red-500/20\"\n                          )}>\n                            {isWin && !isDraw ? \"W\" : isDraw ? \"D\" : \"L\"}\n                          </div>\n                          <div className=\"flex flex-col min-w-0\">\n                            <span className=\"text-sm font-medium truncate\">{opponentName}</span>\n                            <span className=\"text-xs text-muted-foreground flex items-center gap-1\">\n                              <Clock className=\"w-3 h-3\" />\n                              {battleTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}\n                            </span>\n                            {battle.team?.[0]?.cards && (\n                              <div className=\"flex gap-0.5 mt-1 flex-wrap\">\n                                {battle.team[0].cards.slice(0, 8).map((card: any, cardIdx: number) => (\n                                  <CardImage key={card?.id || cardIdx} card={card} size=\"small\" />\n                                ))}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"text-sm font-bold text-muted-foreground shrink-0\">\n                          {teamCrowns}-{opponentCrowns}\n                        </div>\n                      </div>\n                    );\n                  })\n                )}\n                <div className=\"pt-4 text-center\">\n                  <Link href=\"/decks\">\n                    <button className=\"text-sm text-primary hover:underline font-medium transition-colors hover:text-primary/80\" data-testid=\"link-view-history\">Ver histórico completo</button>\n                  </Link>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Favorite Players */}\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n               <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                     <Star className=\"w-5 h-5 text-yellow-500\" />\n                     Jogadores Favoritos\n                  </CardTitle>\n               </CardHeader>\n               <CardContent className=\"space-y-4\">\n                  {favoritesLoading ? (\n                    <div className=\"flex items-center justify-center py-8\">\n                      <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n                    </div>\n                  ) : (favorites as any[]).length === 0 ? (\n                    <p className=\"text-sm text-muted-foreground text-center py-4\">Nenhum jogador favoritado</p>\n                  ) : (\n                    (favorites as any[]).map((fav: any) => (\n                      <div key={fav.id} className=\"flex items-center justify-between p-3 rounded-lg bg-background/40 hover:bg-background/60 transition-colors cursor-pointer group\" data-testid={`favorite-${fav.id}`}>\n                        <div className=\"flex items-center gap-3\">\n                          <Avatar className=\"w-8 h-8 border border-border\">\n                            <AvatarFallback>{fav.name.substring(0, 2).toUpperCase()}</AvatarFallback>\n                          </Avatar>\n                          <div>\n                            <div className=\"font-bold text-sm\">{fav.name}</div>\n                            <div className=\"text-xs text-muted-foreground\">{fav.clan || 'Sem clan'}</div>\n                          </div>\n                        </div>\n                        <ChevronRight className=\"w-4 h-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      </div>\n                    ))\n                  )}\n                  <Link href=\"/community\">\n                     <Button variant=\"ghost\" size=\"sm\" className=\"w-full text-xs mt-2\" data-testid=\"button-explore-community\">Explorar Comunidade</Button>\n                  </Link>\n               </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </DashboardLayout>\n  );\n}\n\nfunction StatCard({ title, value, icon, trend, trendUp, subtext, arenaImage }: any) {\n  return (\n    <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm hover:border-primary/30 transition-colors\">\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-center justify-between space-y-0 pb-2\">\n          <p className=\"text-sm font-medium text-muted-foreground\">{title}</p>\n          <div className=\"flex items-center gap-2\">\n            {arenaImage && (\n              <img \n                src={arenaImage} \n                alt=\"Arena\" \n                className=\"w-8 h-8 object-contain\"\n                onError={(e) => { (e.target as HTMLImageElement).style.display = 'none'; }}\n              />\n            )}\n            {icon}\n          </div>\n        </div>\n        <div className=\"flex flex-col gap-1\">\n          <div className=\"text-2xl font-bold font-display\">{value}</div>\n          {trend && (\n            <p className={cn(\"text-xs font-medium\", trendUp ? \"text-green-500\" : \"text-red-500\")}>\n              {trend}\n            </p>\n          )}\n          {subtext && (\n            <p className=\"text-xs text-muted-foreground\">{subtext}</p>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction CardImage({ card, size = \"medium\" }: { card: any; size?: \"small\" | \"medium\" }) {\n  const sizeClass = size === \"small\" ? \"w-6 h-7\" : \"w-12 h-14\";\n  return (\n    <img\n      src={card?.iconUrls?.medium || ''}\n      alt={card?.name || 'Card'}\n      title={card?.name || 'Card'}\n      className={cn(sizeClass, \"object-contain rounded\")}\n      onError={(e) => { (e.target as HTMLImageElement).style.opacity = '0.3'; }}\n      data-testid={`card-img-${card?.id || 'unknown'}`}\n    />\n  );\n}\n","path":null,"size_bytes":18674,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\nimport { runMigrations } from 'stripe-replit-sync';\nimport { getStripeSync } from './stripeClient';\nimport { WebhookHandlers } from './webhookHandlers';\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\nasync function initStripe() {\n  const databaseUrl = process.env.DATABASE_URL;\n\n  if (!databaseUrl) {\n    console.warn('DATABASE_URL not set, skipping Stripe initialization');\n    return;\n  }\n\n  if (!process.env.REPLIT_CONNECTORS_HOSTNAME) {\n    console.warn('Stripe connector not available, skipping Stripe initialization');\n    return;\n  }\n\n  try {\n    console.log('Initializing Stripe schema...');\n    await runMigrations({ \n      databaseUrl,\n    });\n    console.log('Stripe schema ready');\n\n    const stripeSync = await getStripeSync();\n\n    console.log('Setting up managed webhook...');\n    const webhookBaseUrl = `https://${process.env.REPLIT_DOMAINS?.split(',')[0]}`;\n    const { webhook, uuid } = await stripeSync.findOrCreateManagedWebhook(\n      `${webhookBaseUrl}/api/stripe/webhook`,\n      {\n        enabled_events: ['*'],\n        description: 'Managed webhook for Stripe sync',\n      }\n    );\n    console.log(`Webhook configured: ${webhook.url} (UUID: ${uuid})`);\n\n    console.log('Syncing Stripe data...');\n    stripeSync.syncBackfill()\n      .then(() => {\n        console.log('Stripe data synced');\n      })\n      .catch((err: any) => {\n        console.error('Error syncing Stripe data:', err);\n      });\n  } catch (error) {\n    console.error('Failed to initialize Stripe:', error);\n  }\n}\n\ninitStripe();\n\napp.post(\n  '/api/stripe/webhook/:uuid',\n  express.raw({ type: 'application/json' }),\n  async (req, res) => {\n    const signature = req.headers['stripe-signature'];\n\n    if (!signature) {\n      return res.status(400).json({ error: 'Missing stripe-signature' });\n    }\n\n    try {\n      const sig = Array.isArray(signature) ? signature[0] : signature;\n\n      if (!Buffer.isBuffer(req.body)) {\n        console.error('STRIPE WEBHOOK ERROR: req.body is not a Buffer');\n        return res.status(500).json({ error: 'Webhook processing error' });\n      }\n\n      const { uuid } = req.params;\n      await WebhookHandlers.processWebhook(req.body as Buffer, sig, uuid);\n\n      res.status(200).json({ received: true });\n    } catch (error: any) {\n      console.error('Webhook error:', error.message);\n      res.status(400).json({ error: 'Webhook processing error' });\n    }\n  }\n);\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":4903,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5124,"size_tokens":null},"server/stripeService.ts":{"content":"// From Stripe connection integration\nimport { storage } from './storage';\nimport { getUncachableStripeClient } from './stripeClient';\n\nexport class StripeService {\n  async createCustomer(email: string, userId: string) {\n    const stripe = await getUncachableStripeClient();\n    return await stripe.customers.create({\n      email,\n      metadata: { userId },\n    });\n  }\n\n  async createCheckoutSession(\n    customerId: string, \n    priceId: string, \n    successUrl: string, \n    cancelUrl: string,\n    userId: string\n  ) {\n    const stripe = await getUncachableStripeClient();\n    return await stripe.checkout.sessions.create({\n      customer: customerId,\n      payment_method_types: ['card'],\n      line_items: [{ price: priceId, quantity: 1 }],\n      mode: 'subscription',\n      success_url: successUrl,\n      cancel_url: cancelUrl,\n      metadata: { userId },\n    });\n  }\n\n  async createCustomerPortalSession(customerId: string, returnUrl: string) {\n    const stripe = await getUncachableStripeClient();\n    return await stripe.billingPortal.sessions.create({\n      customer: customerId,\n      return_url: returnUrl,\n    });\n  }\n\n  async getOrCreateCustomer(userId: string, email: string) {\n    const subscription = await storage.getSubscription(userId);\n    \n    if (subscription?.stripeCustomerId) {\n      return subscription.stripeCustomerId;\n    }\n\n    const customer = await this.createCustomer(email, userId);\n    \n    await storage.createSubscription({\n      userId,\n      stripeCustomerId: customer.id,\n      plan: 'free',\n      status: 'inactive',\n    });\n\n    return customer.id;\n  }\n}\n\nexport const stripeService = new StripeService();\n","path":null,"size_bytes":1650,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","path":null,"size_bytes":1342,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"import * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3007,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1410,"size_tokens":null},"replit.md":{"content":"# CRStats - Clash Royale Intelligent Coach\n\n## Overview\n\nCRStats is a SaaS platform providing intelligent coaching for Clash Royale players. The application pulls player statistics via the official Clash Royale API, displays them in a clear dashboard, and uses AI to analyze battles and provide personalized coaching tips. It operates as a freemium SaaS with authentication, account management, and Stripe-powered subscription billing.\n\n**Core Features:**\n- Player statistics dashboard (trophies, win rate, decks, battles)\n- AI-powered coaching chat that analyzes player data and answers questions\n- Training drills generated from detected weaknesses\n- Subscription management with FREE and PRO tiers\n- Favorite players tracking and community rankings\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework:** React 18 with TypeScript (strict mode)\n- **Routing:** Wouter for client-side routing\n- **Styling:** Tailwind CSS with shadcn/ui component library (New York style)\n- **State Management:** TanStack React Query for server state\n- **Build Tool:** Vite with custom plugins for Replit integration\n\nThe frontend follows a page-based structure with shared components. Key directories:\n- `client/src/pages/` - Route components (dashboard, coach, settings, etc.)\n- `client/src/components/` - Reusable UI components including shadcn/ui\n- `client/src/hooks/` - Custom React hooks for data fetching and auth\n- `client/src/lib/` - Utilities, API client, and mock data\n\n### Backend Architecture\n- **Framework:** Express.js with TypeScript\n- **API Pattern:** RESTful endpoints under `/api/`\n- **Authentication:** Replit OpenID Connect (passport-based session auth)\n- **Session Storage:** PostgreSQL-backed sessions via connect-pg-simple\n\nKey server modules:\n- `server/routes.ts` - All API route definitions\n- `server/storage.ts` - Data access layer abstracting database operations\n- `server/replitAuth.ts` - Authentication middleware and session setup\n- `server/openai.ts` - AI coach integration using OpenAI API\n- `server/clashRoyaleApi.ts` - Clash Royale official API wrapper\n- `server/stripeService.ts` - Subscription and billing logic\n\n### Data Storage\n- **Database:** PostgreSQL with Drizzle ORM\n- **Schema Location:** `shared/schema.ts` (shared between client/server)\n- **Migrations:** Drizzle Kit with `drizzle-kit push` command\n\n**Core Tables:**\n- `users` - Basic user data (Replit Auth)\n- `sessions` - Session storage for auth\n- `profiles` - Extended player info (Clash Royale tag, display name)\n- `subscriptions` - Stripe subscription status (FREE/PRO)\n- `goals` - Player-defined goals\n- `favoritePlayers` - Tracked player tags\n- `notifications` - In-app notifications\n- `userSettings` - User preferences\n\n### Authentication Flow\n1. User clicks login → redirected to Replit OAuth\n2. On callback, user is created/updated in database\n3. Session stored in PostgreSQL\n4. Protected routes check `isAuthenticated` middleware\n\n### AI Integration\n- Uses OpenAI API (via Replit AI integration)\n- Coach endpoint receives player context (stats, battles) with messages\n- System prompt establishes \"Clash Royale trainer\" persona\n- Responses generated in Brazilian Portuguese\n\n### Billing Integration\n- Stripe integration via Replit Stripe connector\n- Managed webhooks for subscription lifecycle events\n- Customer portal for subscription management\n- Products: CRStats PRO monthly (R$19.90) and yearly plans\n\n## External Dependencies\n\n### APIs and Services\n- **Clash Royale API** (`CLASH_ROYALE_API_KEY`) - Player data, battles, cards\n- **OpenAI API** (via Replit AI integration) - AI coaching responses\n- **Stripe** (via Replit connector) - Payment processing, subscriptions\n- **Replit Auth** - OpenID Connect authentication\n\n### Database\n- **PostgreSQL** (`DATABASE_URL`) - Primary data store\n- Managed via Drizzle ORM with schema in `shared/schema.ts`\n\n### Environment Variables Required\n- `DATABASE_URL` - PostgreSQL connection string\n- `SESSION_SECRET` - Express session encryption key\n- `CLASH_ROYALE_API_KEY` - Official Clash Royale API access\n- `AI_INTEGRATIONS_OPENAI_BASE_URL` / `AI_INTEGRATIONS_OPENAI_API_KEY` - OpenAI access\n- Stripe credentials managed via Replit connector (automatic)\n\n### Key NPM Dependencies\n- `drizzle-orm` / `drizzle-kit` - Database ORM and migrations\n- `express` / `express-session` - Server framework\n- `passport` - Authentication middleware\n- `openai` - AI API client\n- `stripe` / `stripe-replit-sync` - Payment integration\n- `@tanstack/react-query` - Data fetching\n- `wouter` - Client routing\n- `tailwindcss` / `@radix-ui/*` - UI components\n\n## Recent Changes (December 2025)\n\n### Card Images Integration\n- Dashboard now displays official Clash Royale card images\n- Current deck section shows 8 cards with images from `iconUrls.medium`\n- Battle history shows deck thumbnails for each battle\n- Arena images loaded from RoyaleAPI CDN\n\n### Billing Page\n- New `/billing` route for subscription management\n- Plan comparison: FREE vs PRO features\n- Stripe checkout integration for upgrades (monthly R$19.90, yearly R$159.00)\n- Stripe customer portal for subscription management\n- Success/canceled redirect handling with toast notifications\n\n### Navigation Updates\n- Dynamic subscription status in sidebar (shows PRO badge or upgrade button)\n- Billing link added to navigation menu\n- Plan status displayed near user profile\n- \"Meu Perfil\" link added for player profile page\n\n### Player Profile Page (/me) - December 2025\nNew comprehensive player stats page inspired by DeepLOL/OP.GG:\n\n**Hero Header:**\n- Player name, tag, clan with badge\n- Arena image and current trophies\n- Summary chips: winrate, matches, streak, last played time\n\n**Four Tabs:**\n1. **Visão Geral** - Season summary, performance stats, tilt indicator, trophy chart, game mode breakdown\n2. **Histórico** - Match history with period filters, expandable battle details with deck images\n3. **Decks & Meta** - Most used decks with winrate, archetype strength/weakness analysis\n4. **Progresso** - Trophy evolution chart, play volume analysis, goals integration, PRO locked features\n\n**Features:**\n- Real-time data from Clash Royale API\n- PRO feature locks with blur effect and upgrade CTA\n- Responsive design for desktop and mobile\n\n### Internationalization (i18n) - December 2025\nNew i18n system with support for multiple languages:\n\n**Translation Files:**\n- `shared/i18n/translations/pt-BR.json` - Brazilian Portuguese (default)\n- `shared/i18n/translations/en-US.json` - US English\n\n**i18n Utilities (`shared/i18n/index.ts`):**\n- `t(key, locale, params)` - Type-safe translation function with parameter interpolation\n- `detectLocale(acceptLanguage)` - Detects locale from browser Accept-Language header\n- `getTranslations(locale)` - Get full translation object for a locale\n\n**React Hook (`client/src/hooks/use-locale.ts`):**\n- `useLocale()` - Provides locale, currency, translation functions, and pricing\n- Persists user preference to localStorage\n- Auto-detects from browser settings\n\n### Multi-Currency Pricing - December 2025\nSupport for multiple currencies in billing:\n\n**Pricing Module (`shared/pricing.ts`):**\n- Supported currencies: BRL, USD, EUR\n- `getPricing(currency)` - Get plan prices and Stripe price IDs\n- `formatPrice(amount, currency)` - Locale-aware price formatting\n- `getYearlySavingsPercent(currency)` - Calculate yearly discount\n\n**Price Tiers:**\n- BRL: R$19,90/month, R$159,00/year\n- USD: $4.99/month, $39.99/year\n- EUR: €4.49/month, €35.99/year\n\n### Icon Utilities - December 2025\nCentralized Clash Royale icon helpers (`client/src/lib/clashIcons.ts`):\n- `getCardImageUrl(cardName, size)` - Card images from RoyaleAPI CDN\n- `getArenaImageUrl(arenaId)` - Arena images\n- `getClanBadgeUrl(badgeId)` - Clan badge images\n- `getGameModeIcon(gameMode)` - Emoji icons for game modes\n- `getCardRarityColor(rarity)` - Color codes by card rarity","path":null,"size_bytes":7944,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/components/layout/DashboardLayout.tsx":{"content":"import React from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { \n  LayoutDashboard, \n  MessageSquare, \n  User, \n  Settings, \n  LogOut, \n  Swords, \n  Menu,\n  X,\n  Target,\n  Layers,\n  Globe,\n  Bell,\n  CreditCard,\n  Crown\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { mockNotifications } from \"@/lib/mockData\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\n\ninterface DashboardLayoutProps {\n  children: React.ReactNode;\n}\n\nexport default function DashboardLayout({ children }: DashboardLayoutProps) {\n  const [location, setLocation] = useLocation();\n  const [isMobileOpen, setIsMobileOpen] = React.useState(false);\n\n  const { data: subscription } = useQuery({\n    queryKey: ['subscription'],\n    queryFn: () => api.subscription.get(),\n  });\n\n  const isPro = (subscription as any)?.plan === 'PRO' || (subscription as any)?.plan === 'pro' || (subscription as any)?.status === 'active';\n\n  const navigation = [\n    { name: \"Dashboard\", href: \"/dashboard\", icon: LayoutDashboard },\n    { name: \"Meu Perfil\", href: \"/me\", icon: User },\n    { name: \"Coach IA\", href: \"/coach\", icon: MessageSquare },\n    { name: \"Treino\", href: \"/training\", icon: Target },\n    { name: \"Decks\", href: \"/decks\", icon: Layers },\n    { name: \"Comunidade\", href: \"/community\", icon: Globe },\n    { name: \"Billing\", href: \"/billing\", icon: CreditCard },\n    { name: \"Configurações\", href: \"/settings\", icon: Settings },\n  ];\n\n  const SidebarContent = () => (\n    <div className=\"flex flex-col h-full bg-sidebar border-r border-sidebar-border\">\n      <div className=\"p-6\">\n        <Link href=\"/\">\n          <div className=\"flex items-center gap-2 mb-8 cursor-pointer interactive-hover\">\n            <div className=\"w-8 h-8 rounded-lg bg-primary flex items-center justify-center\">\n              <Swords className=\"w-5 h-5 text-primary-foreground\" />\n            </div>\n            <span className=\"font-display font-bold text-xl text-sidebar-foreground tracking-tight\">\n              CRStats\n            </span>\n          </div>\n        </Link>\n\n        <nav className=\"space-y-2\">\n          {navigation.map((item) => {\n            const isActive = location === item.href;\n            return (\n              <Link \n                key={item.name} \n                href={item.href}\n                className={cn(\n                  \"flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200\",\n                  isActive\n                    ? \"bg-sidebar-accent text-sidebar-accent-foreground translate-x-1\"\n                    : \"text-sidebar-foreground/70 hover:text-sidebar-foreground hover:bg-sidebar-accent/50 hover:translate-x-1\"\n                )}\n              >\n                <item.icon className=\"w-4 h-4\" />\n                {item.name}\n              </Link>\n            );\n          })}\n        </nav>\n      </div>\n\n      <div className=\"mt-auto p-6 border-t border-sidebar-border\">\n        <div className={cn(\n          \"p-4 rounded-xl mb-4 border\",\n          isPro \n            ? \"bg-gradient-to-br from-yellow-500/10 to-orange-500/10 border-yellow-500/30\" \n            : \"bg-card/30 border-primary/20\"\n        )}>\n          <h4 className=\"font-bold text-sm mb-1 flex items-center gap-2\" data-testid=\"text-plan-status\">\n            {isPro ? (\n              <>\n                <Crown className=\"w-4 h-4 text-yellow-500\" />\n                <span className=\"text-yellow-500\">Plano PRO</span>\n              </>\n            ) : (\n              <span className=\"text-primary\">Plano Free</span>\n            )}\n          </h4>\n          {isPro ? (\n            <p className=\"text-xs text-muted-foreground\">Acesso ilimitado</p>\n          ) : (\n            <>\n              <p className=\"text-xs text-muted-foreground mb-3\">2/5 mensagens diárias</p>\n              <Link href=\"/billing\">\n                <Button size=\"sm\" className=\"w-full text-xs font-bold\" variant=\"outline\">Upgrade PRO</Button>\n              </Link>\n            </>\n          )}\n        </div>\n\n        <Link href=\"/profile\">\n          <div className=\"flex items-center gap-3 mb-4 cursor-pointer p-2 rounded-lg hover:bg-sidebar-accent/50 transition-colors\">\n            <Avatar className=\"w-8 h-8 border border-border\">\n              <AvatarImage src=\"https://github.com/shadcn.png\" />\n              <AvatarFallback>KS</AvatarFallback>\n            </Avatar>\n            <div className=\"flex flex-col\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm font-medium text-sidebar-foreground\">KingSlayer</span>\n                {isPro && (\n                  <Badge \n                    className=\"bg-gradient-to-r from-yellow-500 to-orange-500 text-white text-[10px] px-1.5 py-0\"\n                    data-testid=\"badge-subscription-pro\"\n                  >\n                    <Crown className=\"w-2.5 h-2.5 mr-0.5\" />\n                    PRO\n                  </Badge>\n                )}\n              </div>\n              <span className=\"text-xs text-sidebar-foreground/60\">Ver Perfil</span>\n            </div>\n          </div>\n        </Link>\n        <Button \n          variant=\"ghost\" \n          className=\"w-full justify-start text-sidebar-foreground/70 hover:text-destructive hover:bg-destructive/10 transition-colors\" \n          size=\"sm\"\n          onClick={() => { window.location.href = \"/api/logout\"; }}\n        >\n          <LogOut className=\"w-4 h-4 mr-2\" />\n          Sair\n        </Button>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-background flex\">\n      {/* Desktop Sidebar */}\n      <div className=\"hidden md:block w-64 fixed inset-y-0 z-50\">\n        <SidebarContent />\n      </div>\n\n      {/* Mobile Sidebar */}\n      <div className=\"md:hidden fixed top-0 left-0 right-0 z-50 h-16 bg-sidebar border-b border-sidebar-border flex items-center justify-between px-4\">\n        <Link href=\"/\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-8 h-8 rounded-lg bg-primary flex items-center justify-center\">\n              <Swords className=\"w-5 h-5 text-primary-foreground\" />\n            </div>\n            <span className=\"font-display font-bold text-lg text-sidebar-foreground\">\n              CRStats\n            </span>\n          </div>\n        </Link>\n        <div className=\"flex items-center gap-2\">\n          <NotificationsPopover />\n          <Sheet open={isMobileOpen} onOpenChange={setIsMobileOpen}>\n            <SheetTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\">\n                <Menu className=\"w-5 h-5\" />\n              </Button>\n            </SheetTrigger>\n            <SheetContent side=\"left\" className=\"p-0 w-64 border-r border-sidebar-border bg-sidebar\">\n              <SidebarContent />\n            </SheetContent>\n          </Sheet>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <main className=\"flex-1 md:ml-64 p-4 md:p-8 pt-20 md:pt-8 animate-in fade-in slide-in-from-bottom-4 duration-500\">\n        <div className=\"max-w-6xl mx-auto\">\n           {/* Desktop Header Actions */}\n           <div className=\"hidden md:flex justify-end mb-6 gap-4\">\n             <NotificationsPopover />\n           </div>\n          {children}\n        </div>\n      </main>\n    </div>\n  );\n}\n\nfunction NotificationsPopover() {\n  const unreadCount = mockNotifications.filter(n => !n.read).length;\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button variant=\"outline\" size=\"icon\" className=\"relative\">\n          <Bell className=\"w-4 h-4\" />\n          {unreadCount > 0 && (\n            <span className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border border-background animate-pulse\" />\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-80 p-0\" align=\"end\">\n        <div className=\"p-4 border-b border-border\">\n          <h4 className=\"font-bold\">Notificações</h4>\n        </div>\n        <div className=\"max-h-[300px] overflow-y-auto\">\n          {mockNotifications.map((notification) => (\n            <div key={notification.id} className={cn(\"p-4 border-b border-border/50 hover:bg-muted/50 transition-colors cursor-pointer\", !notification.read && \"bg-primary/5\")}>\n              <div className=\"flex justify-between items-start mb-1\">\n                <h5 className=\"text-sm font-medium\">{notification.title}</h5>\n                <span className=\"text-[10px] text-muted-foreground\">{notification.time}</span>\n              </div>\n              <p className=\"text-xs text-muted-foreground\">{notification.description}</p>\n            </div>\n          ))}\n        </div>\n        <div className=\"p-2 border-t border-border bg-muted/20\">\n          <Button variant=\"ghost\" size=\"sm\" className=\"w-full text-xs\">Marcar todas como lidas</Button>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\n\n","path":null,"size_bytes":9212,"size_tokens":null},"client/src/components/ui/sonner.tsx":{"content":"\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n","path":null,"size_bytes":894,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":768,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/pages/auth.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Swords, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function AuthPage() {\n  const [location, setLocation] = useLocation();\n  const searchParams = new URLSearchParams(window.location.search);\n  const isSignup = searchParams.get(\"signup\") === \"true\";\n  \n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n\n  const handleAuth = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    \n    // Simulate API call\n    setTimeout(() => {\n      setIsLoading(false);\n      toast({\n        title: isSignup ? \"Conta criada com sucesso!\" : \"Login realizado!\",\n        description: \"Redirecionando...\",\n      });\n      setLocation(\"/onboarding\");\n    }, 1500);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md animate-in fade-in zoom-in duration-500\">\n        <div className=\"flex justify-center mb-8\">\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-3 cursor-pointer\">\n              <div className=\"w-10 h-10 rounded-xl bg-primary flex items-center justify-center shadow-lg shadow-primary/20\">\n                <Swords className=\"w-6 h-6 text-primary-foreground\" />\n              </div>\n              <span className=\"font-display font-bold text-2xl tracking-tight text-foreground\">CRStats</span>\n            </div>\n          </Link>\n        </div>\n\n        <Card className=\"border-border/50 shadow-2xl bg-card/50 backdrop-blur-xl\">\n          <CardHeader className=\"space-y-1 text-center\">\n            <CardTitle className=\"text-2xl font-display\">\n              {isSignup ? \"Crie sua conta\" : \"Bem-vindo de volta\"}\n            </CardTitle>\n            <CardDescription>\n              {isSignup \n                ? \"Comece sua jornada para o topo do ranking\" \n                : \"Entre para continuar seu treinamento\"}\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleAuth} className=\"space-y-4\">\n              {isSignup && (\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"name\">Nome</Label>\n                  <Input id=\"name\" placeholder=\"Seu nome\" required className=\"bg-background/50\" />\n                </div>\n              )}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">Email</Label>\n                <Input id=\"email\" type=\"email\" placeholder=\"seu@email.com\" required className=\"bg-background/50\" />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"password\">Senha</Label>\n                <Input id=\"password\" type=\"password\" required className=\"bg-background/50\" />\n              </div>\n              \n              <Button type=\"submit\" className=\"w-full font-bold h-11\" disabled={isLoading}>\n                {isLoading ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Carregando...\n                  </>\n                ) : (\n                  isSignup ? \"Criar Conta\" : \"Entrar\"\n                )}\n              </Button>\n            </form>\n          </CardContent>\n          <CardFooter className=\"flex justify-center\">\n            <Link href={isSignup ? \"/auth\" : \"/auth?signup=true\"}>\n              <Button variant=\"link\" className=\"text-sm text-muted-foreground hover:text-primary\">\n                {isSignup \n                  ? \"Já tem uma conta? Entre aqui\" \n                  : \"Não tem conta? Cadastre-se grátis\"}\n              </Button>\n            </Link>\n          </CardFooter>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":4049,"size_tokens":null},"client/src/pages/landing.tsx":{"content":"import { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Swords, Zap, TrendingUp, ShieldCheck, ArrowRight, CheckCircle2 } from \"lucide-react\";\nimport heroBg from \"@assets/generated_images/dark_gaming_abstract_background_with_blue_and_gold_neon_accents.png\";\n\nexport default function LandingPage() {\n  return (\n    <div className=\"min-h-screen bg-background text-foreground flex flex-col\">\n      {/* Navbar */}\n      <header className=\"fixed top-0 w-full z-50 border-b border-white/10 bg-background/80 backdrop-blur-md\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-8 h-8 rounded-lg bg-primary flex items-center justify-center\">\n              <Swords className=\"w-5 h-5 text-primary-foreground\" />\n            </div>\n            <span className=\"font-display font-bold text-xl tracking-tight\">CRStats</span>\n          </div>\n          \n          <nav className=\"hidden md:flex items-center gap-8 text-sm font-medium text-muted-foreground\">\n            <a href=\"#features\" className=\"hover:text-foreground transition-colors\">Funcionalidades</a>\n            <a href=\"#how-it-works\" className=\"hover:text-foreground transition-colors\">Como funciona</a>\n            <a href=\"#pricing\" className=\"hover:text-foreground transition-colors\">Preços</a>\n          </nav>\n\n          <div className=\"flex items-center gap-4\">\n            <a href=\"/api/login\">\n              <Button variant=\"ghost\" className=\"hidden md:flex\">Entrar</Button>\n            </a>\n            <a href=\"/api/login\">\n              <Button className=\"font-bold\">Começar Grátis</Button>\n            </a>\n          </div>\n        </div>\n      </header>\n\n      {/* Hero Section */}\n      <section className=\"relative pt-32 pb-20 md:pt-48 md:pb-32 overflow-hidden\">\n        {/* Background Image with Overlay */}\n        <div className=\"absolute inset-0 z-0\">\n          <img \n            src={heroBg} \n            alt=\"Hero Background\" \n            className=\"w-full h-full object-cover opacity-40\"\n          />\n          <div className=\"absolute inset-0 bg-gradient-to-b from-background/0 via-background/80 to-background\" />\n        </div>\n\n        <div className=\"container mx-auto px-4 relative z-10 text-center\">\n          <div className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 border border-primary/20 text-primary text-xs font-bold uppercase tracking-wider mb-6 animate-in fade-in slide-in-from-bottom-4 duration-700\">\n            <Zap className=\"w-3 h-3\" />\n            IA Coach v1.0 Disponível\n          </div>\n          \n          <h1 className=\"font-display text-5xl md:text-7xl font-black tracking-tight mb-6 bg-gradient-to-r from-white via-white to-white/50 bg-clip-text text-transparent animate-in fade-in slide-in-from-bottom-8 duration-700 delay-100\">\n            Domine a Arena com<br />\n            <span className=\"text-primary block mt-2\">Coach de IA</span>\n          </h1>\n          \n          <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto mb-10 animate-in fade-in slide-in-from-bottom-8 duration-700 delay-200\">\n            Analise suas batalhas, descubra seus erros e receba dicas personalizadas para subir de troféus mais rápido do que nunca.\n          </p>\n          \n          <div className=\"flex flex-col md:flex-row items-center justify-center gap-4 animate-in fade-in slide-in-from-bottom-8 duration-700 delay-300\">\n            <Link href=\"/auth?signup=true\">\n              <Button size=\"lg\" className=\"h-12 px-8 text-base font-bold shadow-lg shadow-primary/20 interactive-hover\">\n                Analisar meu Perfil\n                <ArrowRight className=\"w-4 h-4 ml-2\" />\n              </Button>\n            </Link>\n            <Link href=\"#features\">\n              <Button variant=\"outline\" size=\"lg\" className=\"h-12 px-8 text-base interactive-hover\">\n                Ver Funcionalidades\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Features Grid */}\n      <section id=\"features\" className=\"py-24 bg-card/30 border-y border-white/5\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"font-display text-3xl md:text-4xl font-bold mb-4\">Tudo que você precisa para evoluir</h2>\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n              Nossa IA analisa cada movimento seu para entregar insights que coaches humanos levariam horas para encontrar.\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            <Link href=\"/auth?signup=true\">\n              <div className=\"cursor-pointer\">\n                <FeatureCard \n                  icon={<TrendingUp className=\"w-6 h-6 text-primary\" />}\n                  title=\"Análise de Winrate\"\n                  description=\"Entenda quais cartas e decks estão funcionando melhor para você em cada meta.\"\n                />\n              </div>\n            </Link>\n            <Link href=\"/auth?signup=true\">\n              <div className=\"cursor-pointer\">\n                <FeatureCard \n                  icon={<ShieldCheck className=\"w-6 h-6 text-secondary\" />}\n                  title=\"Coach de IA 24/7\"\n                  description=\"Converse com nosso coach inteligente para receber dicas específicas sobre matchups difíceis.\"\n                />\n              </div>\n            </Link>\n            <Link href=\"/auth?signup=true\">\n              <div className=\"cursor-pointer\">\n                <FeatureCard \n                  icon={<Swords className=\"w-6 h-6 text-purple-400\" />}\n                  title=\"Revisão de Batalhas\"\n                  description=\"Identifique exatamente onde você errou em suas últimas derrotas e como corrigir.\"\n                />\n              </div>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Pricing Section */}\n      <section id=\"pricing\" className=\"py-24 bg-background\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"font-display text-3xl md:text-4xl font-bold mb-4\">Planos Simples</h2>\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n              Comece grátis e evolua conforme suas necessidades.\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto\">\n            {/* Free Plan */}\n            <div className=\"p-8 rounded-2xl bg-card border border-border flex flex-col\">\n              <div className=\"mb-4\">\n                <h3 className=\"text-xl font-bold font-display\">Iniciante</h3>\n                <div className=\"text-3xl font-bold mt-2\">R$ 0 <span className=\"text-sm font-normal text-muted-foreground\">/mês</span></div>\n              </div>\n              <ul className=\"space-y-4 mb-8 flex-1\">\n                <li className=\"flex items-center gap-3 text-sm text-muted-foreground\">\n                  <CheckCircle2 className=\"w-4 h-4 text-primary\" /> 1 Perfil de Jogador\n                </li>\n                <li className=\"flex items-center gap-3 text-sm text-muted-foreground\">\n                  <CheckCircle2 className=\"w-4 h-4 text-primary\" /> 5 Mensagens de Coach/dia\n                </li>\n                <li className=\"flex items-center gap-3 text-sm text-muted-foreground\">\n                  <CheckCircle2 className=\"w-4 h-4 text-primary\" /> Últimas 10 batalhas\n                </li>\n              </ul>\n              <Link href=\"/auth?signup=true\">\n                <Button variant=\"outline\" className=\"w-full interactive-hover\">Começar Grátis</Button>\n              </Link>\n            </div>\n\n            {/* Pro Plan */}\n            <div className=\"p-8 rounded-2xl bg-gradient-to-br from-card to-primary/5 border border-primary/50 flex flex-col relative overflow-hidden interactive-hover\">\n              <div className=\"absolute top-0 right-0 bg-primary text-primary-foreground text-xs font-bold px-3 py-1 rounded-bl-lg\">\n                POPULAR\n              </div>\n              <div className=\"mb-4\">\n                <h3 className=\"text-xl font-bold font-display text-primary\">Pro Player</h3>\n                <div className=\"text-3xl font-bold mt-2\">R$ 19,90 <span className=\"text-sm font-normal text-muted-foreground\">/mês</span></div>\n              </div>\n              <ul className=\"space-y-4 mb-8 flex-1\">\n                <li className=\"flex items-center gap-3 text-sm\">\n                  <CheckCircle2 className=\"w-4 h-4 text-primary\" /> Perfis Ilimitados\n                </li>\n                <li className=\"flex items-center gap-3 text-sm\">\n                  <CheckCircle2 className=\"w-4 h-4 text-primary\" /> Coach IA Ilimitado\n                </li>\n                <li className=\"flex items-center gap-3 text-sm\">\n                  <CheckCircle2 className=\"w-4 h-4 text-primary\" /> Histórico de 60 dias\n                </li>\n                <li className=\"flex items-center gap-3 text-sm\">\n                  <CheckCircle2 className=\"w-4 h-4 text-primary\" /> Treinos Personalizados\n                </li>\n              </ul>\n              <Link href=\"/auth?signup=true\">\n                <Button className=\"w-full font-bold shadow-lg shadow-primary/20 interactive-hover\">Assinar Pro</Button>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-24\">\n        <div className=\"container mx-auto px-4 text-center\">\n          <div className=\"bg-gradient-to-br from-primary/10 via-primary/5 to-transparent border border-primary/20 rounded-2xl p-12 relative overflow-hidden\">\n            <div className=\"absolute top-0 right-0 w-64 h-64 bg-primary/20 blur-3xl rounded-full -mr-32 -mt-32\" />\n            <div className=\"absolute bottom-0 left-0 w-64 h-64 bg-secondary/20 blur-3xl rounded-full -ml-32 -mb-32\" />\n            \n            <h2 className=\"font-display text-3xl md:text-4xl font-bold mb-6 relative z-10\">Pronto para chegar na Rota das Lendas?</h2>\n            <p className=\"text-muted-foreground max-w-xl mx-auto mb-8 relative z-10\">\n              Junte-se a milhares de jogadores que já estão subindo de arena com o CRStats.\n            </p>\n            <Link href=\"/auth?signup=true\">\n              <Button size=\"lg\" className=\"font-bold h-14 px-10 text-lg relative z-10 interactive-hover shadow-lg shadow-primary/20\">\n                Começar Agora Grátis\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer className=\"py-12 border-t border-white/5 bg-background\">\n        <div className=\"container mx-auto px-4 flex flex-col md:flex-row items-center justify-between gap-6 text-muted-foreground text-sm\">\n          <div className=\"flex items-center gap-2\">\n            <Swords className=\"w-4 h-4\" />\n            <span className=\"font-bold text-foreground\">CRStats</span>\n            <span>© 2025</span>\n          </div>\n          <div className=\"flex gap-6\">\n            <a href=\"#\" className=\"hover:text-foreground\">Termos</a>\n            <a href=\"#\" className=\"hover:text-foreground\">Privacidade</a>\n            <a href=\"#\" className=\"hover:text-foreground\">Twitter</a>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n\nfunction FeatureCard({ icon, title, description }: { icon: React.ReactNode, title: string, description: string }) {\n  return (\n    <div className=\"p-6 rounded-xl bg-card border border-border hover:border-primary/50 transition-all duration-300 group interactive-hover\">\n      <div className=\"w-12 h-12 rounded-lg bg-background border border-border flex items-center justify-center mb-4 group-hover:scale-110 transition-transform\">\n        {icon}\n      </div>\n      <h3 className=\"font-display font-bold text-xl mb-2\">{title}</h3>\n      <p className=\"text-muted-foreground\">{description}</p>\n    </div>\n  );\n}\n","path":null,"size_bytes":12026,"size_tokens":null},"server/stripeClient.ts":{"content":"// From Stripe connection integration\nimport Stripe from 'stripe';\n\nlet connectionSettings: any;\n\nasync function getCredentials() {\n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME;\n  const xReplitToken = process.env.REPL_IDENTITY\n    ? 'repl ' + process.env.REPL_IDENTITY\n    : process.env.WEB_REPL_RENEWAL\n      ? 'depl ' + process.env.WEB_REPL_RENEWAL\n      : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  const connectorName = 'stripe';\n  const isProduction = process.env.REPLIT_DEPLOYMENT === '1';\n  const targetEnvironment = isProduction ? 'production' : 'development';\n\n  const url = new URL(`https://${hostname}/api/v2/connection`);\n  url.searchParams.set('include_secrets', 'true');\n  url.searchParams.set('connector_names', connectorName);\n  url.searchParams.set('environment', targetEnvironment);\n\n  const response = await fetch(url.toString(), {\n    headers: {\n      'Accept': 'application/json',\n      'X_REPLIT_TOKEN': xReplitToken\n    }\n  });\n\n  const data = await response.json();\n  \n  connectionSettings = data.items?.[0];\n\n  if (!connectionSettings || (!connectionSettings.settings.publishable || !connectionSettings.settings.secret)) {\n    throw new Error(`Stripe ${targetEnvironment} connection not found`);\n  }\n\n  return {\n    publishableKey: connectionSettings.settings.publishable,\n    secretKey: connectionSettings.settings.secret,\n  };\n}\n\nexport async function getUncachableStripeClient() {\n  const { secretKey } = await getCredentials();\n\n  return new Stripe(secretKey);\n}\n\nexport async function getStripePublishableKey() {\n  const { publishableKey } = await getCredentials();\n  return publishableKey;\n}\n\nexport async function getStripeSecretKey() {\n  const { secretKey } = await getCredentials();\n  return secretKey;\n}\n\nlet stripeSync: any = null;\n\nexport async function getStripeSync() {\n  if (!stripeSync) {\n    const { StripeSync } = await import('stripe-replit-sync');\n    const secretKey = await getStripeSecretKey();\n\n    stripeSync = new StripeSync({\n      poolConfig: {\n        connectionString: process.env.DATABASE_URL!,\n        max: 2,\n      },\n      stripeSecretKey: secretKey,\n    });\n  }\n  return stripeSync;\n}\n","path":null,"size_bytes":2215,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { metaImagesPlugin } from \"./vite-plugin-meta-images\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    tailwindcss(),\n    metaImagesPlugin(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  css: {\n    postcss: {\n      plugins: [],\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1330,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/ui/item.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction ItemGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      role=\"list\"\n      data-slot=\"item-group\"\n      className={cn(\"group/item-group flex flex-col\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"item-separator\"\n      orientation=\"horizontal\"\n      className={cn(\"my-0\", className)}\n      {...props}\n    />\n  )\n}\n\nconst itemVariants = cva(\n  \"group/item [a]:hover:bg-accent/50 focus-visible:border-ring focus-visible:ring-ring/50 [a]:transition-colors flex flex-wrap items-center rounded-md border border-transparent text-sm outline-none transition-colors duration-100 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border-border\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        default: \"gap-4 p-4 \",\n        sm: \"gap-2.5 px-4 py-3\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Item({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> &\n  VariantProps<typeof itemVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n  return (\n    <Comp\n      data-slot=\"item\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(itemVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nconst itemMediaVariants = cva(\n  \"flex shrink-0 items-center justify-center gap-2 group-has-[[data-slot=item-description]]/item:translate-y-0.5 group-has-[[data-slot=item-description]]/item:self-start [&_svg]:pointer-events-none\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted size-8 rounded-sm border [&_svg:not([class*='size-'])]:size-4\",\n        image:\n          \"size-10 overflow-hidden rounded-sm [&_img]:size-full [&_img]:object-cover\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction ItemMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof itemMediaVariants>) {\n  return (\n    <div\n      data-slot=\"item-media\"\n      data-variant={variant}\n      className={cn(itemMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction ItemContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-content\"\n      className={cn(\n        \"flex flex-1 flex-col gap-1 [&+[data-slot=item-content]]:flex-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-title\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"item-description\"\n      className={cn(\n        \"text-muted-foreground line-clamp-2 text-balance text-sm font-normal leading-normal\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-actions\"\n      className={cn(\"flex items-center gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-header\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-footer\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Item,\n  ItemMedia,\n  ItemContent,\n  ItemActions,\n  ItemGroup,\n  ItemSeparator,\n  ItemTitle,\n  ItemDescription,\n  ItemHeader,\n  ItemFooter,\n}\n","path":null,"size_bytes":4494,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":266,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  if (!itemContext) {\n    throw new Error(\"useFormField should be used within <FormItem>\")\n  }\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4175,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"server/db.ts":{"content":"import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n","path":null,"size_bytes":395,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/lib/mockData.ts":{"content":"import { LucideIcon, Trophy, Swords, Zap, Crown, User, Shield, BarChart3, MessageSquare } from \"lucide-react\";\n\nexport interface PlayerStats {\n  tag: string;\n  name: string;\n  trophies: number;\n  bestTrophies: number;\n  arena: string;\n  winRate: number;\n  cardsFound: number;\n  totalDonations: number;\n}\n\nexport interface Card {\n  id: number;\n  name: string;\n  level: number;\n  image: string; // URL placeholder\n  elixir: number;\n  rarity: \"common\" | \"rare\" | \"epic\" | \"legendary\" | \"champion\";\n}\n\nexport interface Battle {\n  id: string;\n  result: \"victory\" | \"defeat\" | \"draw\";\n  crowns: number;\n  opponentCrowns: number;\n  opponentName: string;\n  opponentTag: string;\n  date: string; // ISO string\n  trophyChange: number;\n  type: \"Ladder\" | \"Challenge\" | \"Tournament\";\n  deck: Card[];\n}\n\nexport interface Message {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  timestamp: string;\n}\n\n// Mock Cards\nexport const mockCards: Card[] = [\n  { id: 1, name: \"Hog Rider\", level: 14, elixir: 4, rarity: \"rare\", image: \"https://placehold.co/100x120/orange/white?text=Hog\" },\n  { id: 2, name: \"Fireball\", level: 13, elixir: 4, rarity: \"rare\", image: \"https://placehold.co/100x120/orange/white?text=Fireball\" },\n  { id: 3, name: \"Zap\", level: 14, elixir: 2, rarity: \"common\", image: \"https://placehold.co/100x120/blue/white?text=Zap\" },\n  { id: 4, name: \"Musketeer\", level: 12, elixir: 4, rarity: \"rare\", image: \"https://placehold.co/100x120/orange/white?text=Musk\" },\n  { id: 5, name: \"Cannon\", level: 13, elixir: 3, rarity: \"common\", image: \"https://placehold.co/100x120/gray/white?text=Cannon\" },\n  { id: 6, name: \"Ice Spirit\", level: 13, elixir: 1, rarity: \"common\", image: \"https://placehold.co/100x120/cyan/white?text=Ice\" },\n  { id: 7, name: \"Skeletons\", level: 13, elixir: 1, rarity: \"common\", image: \"https://placehold.co/100x120/gray/white?text=Skellies\" },\n  { id: 8, name: \"Log\", level: 11, elixir: 2, rarity: \"legendary\", image: \"https://placehold.co/100x120/purple/white?text=Log\" },\n];\n\nexport const mockPlayer: PlayerStats = {\n  tag: \"#2P090J0\",\n  name: \"KingSlayer\",\n  trophies: 5842,\n  bestTrophies: 6103,\n  arena: \"Arena 17 - Royal Crypt\",\n  winRate: 54.2,\n  cardsFound: 108,\n  totalDonations: 12540,\n};\n\nexport const mockBattles: Battle[] = [\n  {\n    id: \"b1\",\n    result: \"victory\",\n    crowns: 2,\n    opponentCrowns: 1,\n    opponentName: \"xX_Destroyer_Xx\",\n    opponentTag: \"#89U89U\",\n    date: new Date(Date.now() - 1000 * 60 * 15).toISOString(), // 15 mins ago\n    trophyChange: 30,\n    type: \"Ladder\",\n    deck: mockCards,\n  },\n  {\n    id: \"b2\",\n    result: \"defeat\",\n    crowns: 0,\n    opponentCrowns: 1,\n    opponentName: \"NoobMaster69\",\n    opponentTag: \"#9090JK\",\n    date: new Date(Date.now() - 1000 * 60 * 45).toISOString(), // 45 mins ago\n    trophyChange: -28,\n    type: \"Ladder\",\n    deck: mockCards,\n  },\n  {\n    id: \"b3\",\n    result: \"victory\",\n    crowns: 3,\n    opponentCrowns: 0,\n    opponentName: \"JuanPro\",\n    opponentTag: \"#JJJ888\",\n    date: new Date(Date.now() - 1000 * 60 * 60 * 2).toISOString(), // 2 hours ago\n    trophyChange: 29,\n    type: \"Ladder\",\n    deck: mockCards,\n  },\n  {\n    id: \"b4\",\n    result: \"draw\",\n    crowns: 1,\n    opponentCrowns: 1,\n    opponentName: \"ClashKing\",\n    opponentTag: \"#CK999\",\n    date: new Date(Date.now() - 1000 * 60 * 60 * 5).toISOString(), // 5 hours ago\n    trophyChange: 0,\n    type: \"Ladder\",\n    deck: mockCards,\n  },\n  {\n    id: \"b5\",\n    result: \"victory\",\n    crowns: 1,\n    opponentCrowns: 0,\n    opponentName: \"PrincessLover\",\n    opponentTag: \"#PL123\",\n    date: new Date(Date.now() - 1000 * 60 * 60 * 24).toISOString(), // 1 day ago\n    trophyChange: 31,\n    type: \"Ladder\",\n    deck: mockCards,\n  },\n];\n\nexport const mockChatHistory: Message[] = [\n  {\n    id: \"m1\",\n    role: \"assistant\",\n    content: \"Olá KingSlayer! Analisei suas últimas batalhas. Parece que você está tendo dificuldades contra decks de Lava Hound. Quer algumas dicas de como posicionar sua Mosqueteira melhor?\",\n    timestamp: new Date(Date.now() - 1000 * 60 * 60).toISOString(),\n  },\n  {\n    id: \"m2\",\n    role: \"user\",\n    content: \"Sim, por favor. Eles sempre conseguem chegar na minha torre.\",\n    timestamp: new Date(Date.now() - 1000 * 60 * 59).toISOString(),\n  },\n  {\n    id: \"m3\",\n    role: \"assistant\",\n    content: \"O segredo é o 'pull'. Use seu Canhão no centro para atrair o Lava Hound, mas guarde a Mosqueteira para o Balão ou as tropas de suporte que vêm atrás. Não gaste seu Gelo/Espírito muito cedo. Tente praticar o posicionamento 4-3 (4 tiles da torre, 3 tiles do rio).\",\n    timestamp: new Date(Date.now() - 1000 * 60 * 58).toISOString(),\n  }\n];\n\nexport const mockNotifications = [\n  { id: 1, title: \"Meta Atualizado\", description: \"O meta mudou! Veja os novos decks dominantes.\", time: \"2h atrás\", read: false, type: \"info\" },\n  { id: 2, title: \"Treino Concluído\", description: \"Você completou o treino 'Defesa de Corredor'.\", time: \"5h atrás\", read: true, type: \"success\" },\n  { id: 3, title: \"Novo Recorde!\", description: \"Você atingiu 5900 troféus. Parabéns!\", time: \"1d atrás\", read: true, type: \"success\" },\n];\n\nexport const mockGoals = [\n  { id: 1, title: \"Chegar na Arena 18\", current: 5842, target: 6000, type: \"trophies\" },\n  { id: 2, title: \"Vencer 5 partidas seguidas\", current: 3, target: 5, type: \"streak\" },\n];\n\nexport const mockFavorites = [\n  { tag: \"#M0R74L\", name: \"Mortal\", trophies: 7500, clan: \"Team Liquid\" },\n  { tag: \"#V1P3R\", name: \"Viper\", trophies: 7200, clan: \"SK Gaming\" },\n];\n\nexport const mockRankings = [\n  { rank: 1, name: \"Mohamed Light\", tag: \"#LIGHT\", trophies: 9000, clan: \"Light Clan\", winRate: 85 },\n  { rank: 2, name: \"Mugi\", tag: \"#MUGI\", trophies: 8950, clan: \"Crazy Raccoon\", winRate: 82 },\n  { rank: 3, name: \"Ian77\", tag: \"#IAN\", trophies: 8900, clan: \"SK Gaming\", winRate: 80 },\n  { rank: 4, name: \"LucasXGamer\", tag: \"#LUCAS\", trophies: 8850, clan: \"Team Queso\", winRate: 79 },\n  { rank: 5, name: \"Wallace\", tag: \"#WALL\", trophies: 8800, clan: \"SSG\", winRate: 78 },\n];\n\n","path":null,"size_bytes":6033,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1828,"size_tokens":null},"client/src/pages/billing.tsx":{"content":"import React, { useEffect, useState } from \"react\";\nimport { useLocation, useSearch } from \"wouter\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Check, Crown, Zap, Sparkles, Loader2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocale } from \"@/hooks/use-locale\";\n\nexport default function BillingPage() {\n  const search = useSearch();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { t, pricing, formatPrice, savingsPercent, currency } = useLocale();\n  const [loadingPlan, setLoadingPlan] = useState<\"monthly\" | \"yearly\" | \"portal\" | null>(null);\n\n  const { data: subscription, isLoading: subscriptionLoading } = useQuery({\n    queryKey: [\"subscription\"],\n    queryFn: () => api.subscription.get(),\n  });\n\n  const isPro = (subscription as any)?.plan === \"pro\" || (subscription as any)?.status === \"active\";\n\n  const freeFeatures = t('billing.free.features') as unknown as string[];\n  const proFeatures = t('billing.pro.features') as unknown as string[];\n\n  useEffect(() => {\n    const params = new URLSearchParams(search);\n    if (params.get(\"success\") === \"true\") {\n      toast({\n        title: t('billing.toast.activated'),\n        description: t('billing.toast.activatedDesc'),\n      });\n      setLocation(\"/billing\", { replace: true });\n    } else if (params.get(\"canceled\") === \"true\") {\n      toast({\n        title: t('billing.toast.canceled'),\n        description: t('billing.toast.canceledDesc'),\n        variant: \"destructive\",\n      });\n      setLocation(\"/billing\", { replace: true });\n    }\n  }, [search, toast, setLocation, t]);\n\n  const handleUpgrade = async (priceId: string, plan: \"monthly\" | \"yearly\") => {\n    setLoadingPlan(plan);\n    try {\n      const { url } = await api.stripe.createCheckout(priceId, currency);\n      window.location.href = url;\n    } catch (error: any) {\n      toast({\n        title: t('billing.toast.checkoutError'),\n        description: error.message || t('billing.toast.tryAgain'),\n        variant: \"destructive\",\n      });\n      setLoadingPlan(null);\n    }\n  };\n\n  const handleManageSubscription = async () => {\n    setLoadingPlan(\"portal\");\n    try {\n      const { url } = await api.stripe.createPortal();\n      window.location.href = url;\n    } catch (error: any) {\n      toast({\n        title: t('billing.toast.portalError'),\n        description: error.message || t('billing.toast.tryAgain'),\n        variant: \"destructive\",\n      });\n      setLoadingPlan(null);\n    }\n  };\n\n  return (\n    <DashboardLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-foreground\">{t('billing.title')}</h1>\n          <p className=\"text-muted-foreground mt-2\">\n            {t('billing.subtitle')}\n          </p>\n        </div>\n\n        {subscriptionLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n          </div>\n        ) : (\n          <>\n            <div className=\"flex items-center gap-3\" data-testid=\"text-current-plan\">\n              <span className=\"text-sm text-muted-foreground\">{t('billing.currentPlan')}:</span>\n              <Badge variant={isPro ? \"default\" : \"secondary\"} className={cn(isPro && \"bg-gradient-to-r from-yellow-500 to-orange-500\")}>\n                {isPro ? (\n                  <>\n                    <Crown className=\"w-3 h-3 mr-1\" />\n                    PRO\n                  </>\n                ) : (\n                  \"FREE\"\n                )}\n              </Badge>\n            </div>\n\n            <div className=\"grid md:grid-cols-2 gap-6 max-w-4xl\">\n              {/* FREE Plan */}\n              <Card className={cn(\"border-border/50 bg-card/50 backdrop-blur-sm\", !isPro && \"ring-2 ring-primary/20\")} data-testid=\"plan-free\">\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-xl font-display\">{t('billing.free.name')}</CardTitle>\n                    {!isPro && <Badge variant=\"outline\">{t('billing.currentPlanButton')}</Badge>}\n                  </div>\n                  <CardDescription>{t('billing.free.description')}</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <span className=\"text-3xl font-bold\">{formatPrice(0)}</span>\n                    <span className=\"text-muted-foreground\">{t('billing.perMonth')}</span>\n                  </div>\n                  <ul className=\"space-y-3\">\n                    {(Array.isArray(freeFeatures) ? freeFeatures : []).map((feature: string, idx: number) => (\n                      <li key={idx} className=\"flex items-center gap-2 text-sm\">\n                        <Check className=\"w-4 h-4 text-green-500\" />\n                        {feature}\n                      </li>\n                    ))}\n                  </ul>\n                  {!isPro && (\n                    <Button variant=\"outline\" className=\"w-full\" disabled>\n                      {t('billing.currentPlanButton')}\n                    </Button>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* PRO Plan */}\n              <Card className={cn(\"border-primary/50 bg-gradient-to-br from-card to-primary/5 backdrop-blur-sm relative overflow-hidden\", isPro && \"ring-2 ring-primary\")} data-testid=\"plan-pro\">\n                <div className=\"absolute top-0 right-0 px-3 py-1 bg-gradient-to-r from-yellow-500 to-orange-500 text-white text-xs font-bold rounded-bl-lg\">\n                  <Sparkles className=\"w-3 h-3 inline mr-1\" />\n                  {t('billing.pro.popular')}\n                </div>\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-xl font-display flex items-center gap-2\">\n                      <Crown className=\"w-5 h-5 text-yellow-500\" />\n                      {t('billing.pro.name')}\n                    </CardTitle>\n                    {isPro && <Badge>{t('billing.currentPlanButton')}</Badge>}\n                  </div>\n                  <CardDescription>{t('billing.pro.description')}</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div className=\"space-y-1\">\n                    <div>\n                      <span className=\"text-3xl font-bold\">{formatPrice(pricing.monthlyPrice)}</span>\n                      <span className=\"text-muted-foreground\">{t('billing.perMonth')}</span>\n                    </div>\n                    <div className=\"text-sm text-muted-foreground\">\n                      {t('common.or')} <span className=\"font-semibold text-green-500\">{formatPrice(pricing.yearlyPrice)}{t('billing.perYear')}</span>{\" \"}\n                      <Badge variant=\"secondary\" className=\"text-xs\">{t('billing.savePercent', { percent: savingsPercent })}</Badge>\n                    </div>\n                  </div>\n                  <ul className=\"space-y-3\">\n                    {(Array.isArray(proFeatures) ? proFeatures : []).map((feature: string, idx: number) => (\n                      <li key={idx} className=\"flex items-center gap-2 text-sm\">\n                        <Zap className=\"w-4 h-4 text-primary\" />\n                        {feature}\n                      </li>\n                    ))}\n                  </ul>\n                  {isPro ? (\n                    <Button \n                      className=\"w-full\" \n                      onClick={handleManageSubscription}\n                      disabled={loadingPlan === \"portal\"}\n                      data-testid=\"button-manage-subscription\"\n                    >\n                      {loadingPlan === \"portal\" ? (\n                        <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\n                      ) : null}\n                      {t('billing.manageSubscription')}\n                    </Button>\n                  ) : (\n                    <div className=\"space-y-2\">\n                      <Button \n                        className=\"w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600\"\n                        onClick={() => handleUpgrade(pricing.monthlyPriceId, \"monthly\")}\n                        disabled={loadingPlan !== null}\n                        data-testid=\"button-upgrade-monthly\"\n                      >\n                        {loadingPlan === \"monthly\" ? (\n                          <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\n                        ) : null}\n                        {t('billing.subscribeMonthly')}\n                      </Button>\n                      <Button \n                        variant=\"outline\" \n                        className=\"w-full border-green-500/50 text-green-500 hover:bg-green-500/10\"\n                        onClick={() => handleUpgrade(pricing.yearlyPriceId, \"yearly\")}\n                        disabled={loadingPlan !== null}\n                        data-testid=\"button-upgrade-yearly\"\n                      >\n                        {loadingPlan === \"yearly\" ? (\n                          <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\n                        ) : null}\n                        {t('billing.subscribeYearly')} ({t('billing.savePercent', { percent: savingsPercent })})\n                      </Button>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card className=\"border-border/50 bg-card/50 max-w-4xl\">\n              <CardContent className=\"p-6\">\n                <h3 className=\"font-semibold mb-2\">{t('billing.faq.title')}</h3>\n                <div className=\"space-y-4 text-sm text-muted-foreground\">\n                  <div>\n                    <p className=\"font-medium text-foreground\">{t('billing.faq.cancelQuestion')}</p>\n                    <p>{t('billing.faq.cancelAnswer')}</p>\n                  </div>\n                  <div>\n                    <p className=\"font-medium text-foreground\">{t('billing.faq.paymentQuestion')}</p>\n                    <p>{t('billing.faq.paymentAnswer')}</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </>\n        )}\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":10715,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4280,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"grid place-content-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1031,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1037,"size_tokens":null},"vite-plugin-meta-images.ts":{"content":"import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\n/**\n * Vite plugin that updates og:image and twitter:image meta tags\n * to point to the app's opengraph image with the correct Replit domain.\n */\nexport function metaImagesPlugin(): Plugin {\n  return {\n    name: 'vite-plugin-meta-images',\n    transformIndexHtml(html) {\n      const baseUrl = getDeploymentUrl();\n      if (!baseUrl) {\n        log('[meta-images] no Replit deployment domain found, skipping meta tag updates');\n        return html;\n      }\n\n      // Check if opengraph image exists in public directory\n      const publicDir = path.resolve(process.cwd(), 'client', 'public');\n      const opengraphPngPath = path.join(publicDir, 'opengraph.png');\n      const opengraphJpgPath = path.join(publicDir, 'opengraph.jpg');\n      const opengraphJpegPath = path.join(publicDir, 'opengraph.jpeg');\n\n      let imageExt: string | null = null;\n      if (fs.existsSync(opengraphPngPath)) {\n        imageExt = 'png';\n      } else if (fs.existsSync(opengraphJpgPath)) {\n        imageExt = 'jpg';\n      } else if (fs.existsSync(opengraphJpegPath)) {\n        imageExt = 'jpeg';\n      }\n\n      if (!imageExt) {\n        log('[meta-images] OpenGraph image not found, skipping meta tag updates');\n        return html;\n      }\n\n      const imageUrl = `${baseUrl}/opengraph.${imageExt}`;\n\n      log('[meta-images] updating meta image tags to:', imageUrl);\n\n      html = html.replace(\n        /<meta\\s+property=\"og:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta property=\"og:image\" content=\"${imageUrl}\" />`\n      );\n\n      html = html.replace(\n        /<meta\\s+name=\"twitter:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta name=\"twitter:image\" content=\"${imageUrl}\" />`\n      );\n\n      return html;\n    },\n  };\n}\n\nfunction getDeploymentUrl(): string | null {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    log('[meta-images] using internal app domain:', url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    log('[meta-images] using dev domain:', url);\n    return url;\n  }\n\n  return null;\n}\n\nfunction log(...args: any[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    console.log(...args);\n  }\n}\n","path":null,"size_bytes":2333,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload\n            .filter((item) => item.type !== \"none\")\n            .map((item, index) => {\n              const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n              const itemConfig = getPayloadConfigFromPayload(config, item, key)\n              const indicatorColor = color || item.payload.fill || item.color\n\n              return (\n                <div\n                  key={item.dataKey}\n                  className={cn(\n                    \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                    indicator === \"dot\" && \"items-center\"\n                  )}\n                >\n                  {formatter && item?.value !== undefined && item.name ? (\n                    formatter(item.value, item.name, item, index, item.payload)\n                  ) : (\n                    <>\n                      {itemConfig?.icon ? (\n                        <itemConfig.icon />\n                      ) : (\n                        !hideIndicator && (\n                          <div\n                            className={cn(\n                              \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                              {\n                                \"h-2.5 w-2.5\": indicator === \"dot\",\n                                \"w-1\": indicator === \"line\",\n                                \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                  indicator === \"dashed\",\n                                \"my-0.5\": nestLabel && indicator === \"dashed\",\n                              }\n                            )}\n                            style={\n                              {\n                                \"--color-bg\": indicatorColor,\n                                \"--color-border\": indicatorColor,\n                              } as React.CSSProperties\n                            }\n                          />\n                        )\n                      )}\n                      <div\n                        className={cn(\n                          \"flex flex-1 justify-between leading-none\",\n                          nestLabel ? \"items-end\" : \"items-center\"\n                        )}\n                      >\n                        <div className=\"grid gap-1.5\">\n                          {nestLabel ? tooltipLabel : null}\n                          <span className=\"text-muted-foreground\">\n                            {itemConfig?.label || item.name}\n                          </span>\n                        </div>\n                        {item.value && (\n                          <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                            {item.value.toLocaleString()}\n                          </span>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )\n            })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload\n          .filter((item) => item.type !== \"none\")\n          .map((item) => {\n            const key = `${nameKey || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n            return (\n              <div\n                key={item.value}\n                className={cn(\n                  \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n                )}\n              >\n                {itemConfig?.icon && !hideIcon ? (\n                  <itemConfig.icon />\n                ) : (\n                  <div\n                    className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                    style={{\n                      backgroundColor: item.color,\n                    }}\n                  />\n                )}\n                {itemConfig?.label}\n              </div>\n            )\n          })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10763,"size_tokens":null},"client/src/lib/authUtils.ts":{"content":"// From javascript_log_in_with_replit blueprint\nexport function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","path":null,"size_bytes":164,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1877,"size_tokens":null},"client/src/pages/public-profile.tsx":{"content":"import React from \"react\";\nimport { Link, useRoute } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Trophy, Swords, Shield, Crown, ArrowLeft } from \"lucide-react\";\nimport { mockPlayer, mockBattles } from \"@/lib/mockData\";\nimport { cn } from \"@/lib/utils\";\n\nexport default function PublicProfilePage() {\n  const [match, params] = useRoute(\"/p/:tag\");\n  const tag = params?.tag ? `#${params.tag}` : \"\";\n\n  // In real app, fetch data by tag. Here we use mockPlayer for demo\n  const player = { ...mockPlayer, tag: tag || mockPlayer.tag };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-4 py-8\">\n        <Link href=\"/dashboard\">\n          <Button variant=\"ghost\" className=\"mb-6\">\n            <ArrowLeft className=\"w-4 h-4 mr-2\" /> Voltar para Dashboard\n          </Button>\n        </Link>\n\n        {/* Profile Header */}\n        <div className=\"flex flex-col md:flex-row items-start md:items-center justify-between gap-6 mb-8 p-8 rounded-2xl bg-card border border-border relative overflow-hidden\">\n          <div className=\"absolute top-0 right-0 w-64 h-64 bg-primary/5 blur-3xl rounded-full -mr-32 -mt-32\" />\n          \n          <div className=\"flex items-center gap-6 relative z-10\">\n            <Avatar className=\"w-24 h-24 border-4 border-background shadow-xl\">\n              <AvatarImage src={`https://api.dicebear.com/7.x/avataaars/svg?seed=${player.tag}`} />\n              <AvatarFallback>PL</AvatarFallback>\n            </Avatar>\n            <div>\n              <div className=\"flex items-center gap-3 mb-1\">\n                <h1 className=\"text-3xl font-display font-bold\">{player.name}</h1>\n                <Badge variant=\"outline\" className=\"font-mono\">{player.tag}</Badge>\n              </div>\n              <p className=\"text-muted-foreground flex items-center gap-2\">\n                <Crown className=\"w-4 h-4 text-yellow-500\" />\n                {player.arena}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex gap-4 relative z-10\">\n             <div className=\"text-center p-4 bg-background/50 rounded-xl border border-border\">\n                <div className=\"text-xs text-muted-foreground uppercase tracking-wider font-bold mb-1\">Troféus</div>\n                <div className=\"text-2xl font-display font-bold flex items-center gap-1\">\n                   <Trophy className=\"w-5 h-5 text-yellow-500\" />\n                   {player.trophies}\n                </div>\n             </div>\n             <div className=\"text-center p-4 bg-background/50 rounded-xl border border-border\">\n                <div className=\"text-xs text-muted-foreground uppercase tracking-wider font-bold mb-1\">Win Rate</div>\n                <div className=\"text-2xl font-display font-bold text-green-500\">\n                   {player.winRate}%\n                </div>\n             </div>\n          </div>\n        </div>\n\n        {/* Content Grid */}\n        <div className=\"grid md:grid-cols-3 gap-8\">\n           <Card className=\"md:col-span-2 border-border/50 bg-card/30\">\n              <CardHeader>\n                 <CardTitle>Histórico Recente</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                 {mockBattles.map((battle) => (\n                    <div key={battle.id} className=\"flex items-center justify-between p-4 rounded-lg bg-background/50 border border-border/50\">\n                       <div className=\"flex items-center gap-4\">\n                          <Badge variant={battle.result === \"victory\" ? \"default\" : \"secondary\"} className={\n                             battle.result === \"victory\" ? \"bg-green-500/20 text-green-500 hover:bg-green-500/30\" : \"bg-red-500/20 text-red-500 hover:bg-red-500/30\"\n                          }>\n                             {battle.result === \"victory\" ? \"VITÓRIA\" : \"DERROTA\"}\n                          </Badge>\n                          <div>\n                             <div className=\"font-bold text-sm\">vs {battle.opponentName}</div>\n                             <div className=\"text-xs text-muted-foreground\">{new Date(battle.date).toLocaleDateString()}</div>\n                          </div>\n                       </div>\n                       <div className=\"font-bold font-mono\">\n                          {battle.trophyChange > 0 ? \"+\" : \"\"}{battle.trophyChange}\n                       </div>\n                    </div>\n                 ))}\n              </CardContent>\n           </Card>\n\n           <div className=\"space-y-6\">\n              <Card className=\"border-primary/50 bg-primary/5\">\n                 <CardHeader>\n                    <CardTitle className=\"text-primary\">Desafie este Jogador</CardTitle>\n                 </CardHeader>\n                 <CardContent>\n                    <p className=\"text-sm text-muted-foreground mb-4\">\n                       Quer saber como vencer o {player.name}? Use o Coach IA para analisar o estilo de jogo dele.\n                    </p>\n                    <Link href=\"/coach\">\n                       <Button className=\"w-full font-bold\">Analisar com IA</Button>\n                    </Link>\n                 </CardContent>\n              </Card>\n           </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":5479,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5745,"size_tokens":null},"shared/schema.ts":{"content":"// Database schema for CRStats - from javascript_log_in_with_replit and javascript_database blueprints\nimport { sql } from 'drizzle-orm';\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  text,\n  integer,\n  boolean,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { relations } from \"drizzle-orm\";\n\n// ============================================================================\n// SESSION & AUTH TABLES (Required by Replit Auth - DO NOT DROP)\n// ============================================================================\n\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// ============================================================================\n// PROFILES TABLE (Extended user information)\n// ============================================================================\n\nexport const profiles = pgTable(\"profiles\", {\n  userId: varchar(\"user_id\").primaryKey().references(() => users.id, { onDelete: \"cascade\" }),\n  displayName: varchar(\"display_name\"),\n  clashTag: varchar(\"clash_tag\"), // Clash Royale player tag like #2P090J0\n  region: varchar(\"region\").default(\"BR\"),\n  language: varchar(\"language\").default(\"pt\"),\n  role: varchar(\"role\").default(\"user\"), // user | admin\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertProfileSchema = createInsertSchema(profiles).omit({\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertProfile = z.infer<typeof insertProfileSchema>;\nexport type Profile = typeof profiles.$inferSelect;\n\n// ============================================================================\n// SUBSCRIPTIONS TABLE (Stripe billing)\n// ============================================================================\n\nexport const subscriptions = pgTable(\"subscriptions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  stripeCustomerId: varchar(\"stripe_customer_id\"),\n  stripeSubscriptionId: varchar(\"stripe_subscription_id\").unique(),\n  plan: varchar(\"plan\").notNull().default(\"free\"), // free | pro\n  status: varchar(\"status\").notNull().default(\"inactive\"), // active | inactive | canceled | past_due\n  currentPeriodEnd: timestamp(\"current_period_end\"),\n  cancelAtPeriodEnd: boolean(\"cancel_at_period_end\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertSubscriptionSchema = createInsertSchema(subscriptions).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertSubscription = z.infer<typeof insertSubscriptionSchema>;\nexport type Subscription = typeof subscriptions.$inferSelect;\n\n// ============================================================================\n// GOALS TABLE (User goals/targets)\n// ============================================================================\n\nexport const goals = pgTable(\"goals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  type: varchar(\"type\").notNull(), // trophies | streak | winrate | custom\n  targetValue: integer(\"target_value\").notNull(),\n  currentValue: integer(\"current_value\").default(0),\n  completed: boolean(\"completed\").default(false),\n  completedAt: timestamp(\"completed_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertGoalSchema = createInsertSchema(goals).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertGoal = z.infer<typeof insertGoalSchema>;\nexport type Goal = typeof goals.$inferSelect;\n\n// ============================================================================\n// FAVORITE PLAYERS TABLE\n// ============================================================================\n\nexport const favoritePlayers = pgTable(\"favorite_players\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  playerTag: varchar(\"player_tag\").notNull(), // Clash Royale player tag\n  name: varchar(\"name\").notNull(),\n  trophies: integer(\"trophies\"),\n  clan: varchar(\"clan\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertFavoritePlayerSchema = createInsertSchema(favoritePlayers).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertFavoritePlayer = z.infer<typeof insertFavoritePlayerSchema>;\nexport type FavoritePlayer = typeof favoritePlayers.$inferSelect;\n\n// ============================================================================\n// NOTIFICATIONS TABLE\n// ============================================================================\n\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  type: varchar(\"type\").notNull(), // info | success | warning | error\n  read: boolean(\"read\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type Notification = typeof notifications.$inferSelect;\n\n// ============================================================================\n// USER SETTINGS TABLE\n// ============================================================================\n\nexport const userSettings = pgTable(\"user_settings\", {\n  userId: varchar(\"user_id\").primaryKey().references(() => users.id, { onDelete: \"cascade\" }),\n  theme: varchar(\"theme\").default(\"dark\"), // light | dark | system\n  preferredLanguage: varchar(\"preferred_language\").default(\"pt\"),\n  defaultLandingPage: varchar(\"default_landing_page\").default(\"dashboard\"), // dashboard | community | goals | coach\n  showAdvancedStats: boolean(\"show_advanced_stats\").default(false),\n  notificationsEnabled: boolean(\"notifications_enabled\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertUserSettingsSchema = createInsertSchema(userSettings).omit({\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertUserSettings = z.infer<typeof insertUserSettingsSchema>;\nexport type UserSettings = typeof userSettings.$inferSelect;\n\n// ============================================================================\n// RELATIONS\n// ============================================================================\n\nexport const usersRelations = relations(users, ({ one, many }) => ({\n  profile: one(profiles, {\n    fields: [users.id],\n    references: [profiles.userId],\n  }),\n  subscription: one(subscriptions, {\n    fields: [users.id],\n    references: [subscriptions.userId],\n  }),\n  goals: many(goals),\n  favoritePlayers: many(favoritePlayers),\n  notifications: many(notifications),\n  settings: one(userSettings, {\n    fields: [users.id],\n    references: [userSettings.userId],\n  }),\n}));\n\nexport const profilesRelations = relations(profiles, ({ one }) => ({\n  user: one(users, {\n    fields: [profiles.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const subscriptionsRelations = relations(subscriptions, ({ one }) => ({\n  user: one(users, {\n    fields: [subscriptions.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const goalsRelations = relations(goals, ({ one }) => ({\n  user: one(users, {\n    fields: [goals.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const favoritePlayersRelations = relations(favoritePlayers, ({ one }) => ({\n  user: one(users, {\n    fields: [favoritePlayers.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const notificationsRelations = relations(notifications, ({ one }) => ({\n  user: one(users, {\n    fields: [notifications.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const userSettingsRelations = relations(userSettings, ({ one }) => ({\n  user: one(users, {\n    fields: [userSettings.userId],\n    references: [users.id],\n  }),\n}));\n\n// ============================================================================\n// PLAYER SYNC STATE TABLE (Track last sync timestamp)\n// ============================================================================\n\nexport const playerSyncState = pgTable(\"player_sync_state\", {\n  userId: varchar(\"user_id\").primaryKey().references(() => users.id, { onDelete: \"cascade\" }),\n  lastSyncedAt: timestamp(\"last_synced_at\").defaultNow(),\n});\n\nexport type PlayerSyncState = typeof playerSyncState.$inferSelect;\n\n// ============================================================================\n// COACH MESSAGES TABLE (Chat history with daily limit tracking)\n// ============================================================================\n\nexport const coachMessages = pgTable(\"coach_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  role: varchar(\"role\").notNull(), // 'user' | 'assistant'\n  content: text(\"content\").notNull(),\n  contextType: varchar(\"context_type\"), // 'last_battle' | 'push' | 'general' | null\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => [\n  index(\"IDX_coach_messages_user_created\").on(table.userId, table.createdAt),\n]);\n\nexport const insertCoachMessageSchema = createInsertSchema(coachMessages).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertCoachMessage = z.infer<typeof insertCoachMessageSchema>;\nexport type CoachMessage = typeof coachMessages.$inferSelect;\n\n// ============================================================================\n// PUSH ANALYSES TABLE (AI analysis of push sessions)\n// ============================================================================\n\nexport const pushAnalyses = pgTable(\"push_analyses\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  pushStartTime: timestamp(\"push_start_time\").notNull(),\n  pushEndTime: timestamp(\"push_end_time\").notNull(),\n  battlesCount: integer(\"battles_count\").notNull(),\n  wins: integer(\"wins\").notNull(),\n  losses: integer(\"losses\").notNull(),\n  netTrophies: integer(\"net_trophies\").notNull(),\n  resultJson: jsonb(\"result_json\").notNull(), // { summary, strengths[], mistakes[], recommendations[] }\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => [\n  index(\"IDX_push_analyses_user_created\").on(table.userId, table.createdAt),\n]);\n\nexport const insertPushAnalysisSchema = createInsertSchema(pushAnalyses).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertPushAnalysis = z.infer<typeof insertPushAnalysisSchema>;\nexport type PushAnalysis = typeof pushAnalyses.$inferSelect;\n\n// Push analysis result structure\nexport const pushAnalysisResultSchema = z.object({\n  summary: z.string(),\n  strengths: z.array(z.string()),\n  mistakes: z.array(z.string()),\n  recommendations: z.array(z.string()),\n});\nexport type PushAnalysisResult = z.infer<typeof pushAnalysisResultSchema>;\n\n// ============================================================================\n// TRAINING PLANS TABLE (Auto-generated from push analysis)\n// ============================================================================\n\nexport const trainingPlans = pgTable(\"training_plans\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  title: text(\"title\").notNull(),\n  source: varchar(\"source\").notNull().default(\"push_analysis\"), // 'push_analysis' | 'manual'\n  status: varchar(\"status\").notNull().default(\"active\"), // 'active' | 'completed' | 'archived'\n  pushAnalysisId: varchar(\"push_analysis_id\").references(() => pushAnalyses.id, { onDelete: \"set null\" }),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  index(\"IDX_training_plans_user_status\").on(table.userId, table.status),\n]);\n\nexport const insertTrainingPlanSchema = createInsertSchema(trainingPlans).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertTrainingPlan = z.infer<typeof insertTrainingPlanSchema>;\nexport type TrainingPlan = typeof trainingPlans.$inferSelect;\n\n// ============================================================================\n// TRAINING DRILLS TABLE (Individual exercises in a plan)\n// ============================================================================\n\nexport const trainingDrills = pgTable(\"training_drills\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  planId: varchar(\"plan_id\").notNull().references(() => trainingPlans.id, { onDelete: \"cascade\" }),\n  focusArea: varchar(\"focus_area\").notNull(), // 'tilt' | 'macro' | 'deck' | 'matchup' | 'fundamentals'\n  description: text(\"description\").notNull(),\n  targetGames: integer(\"target_games\").notNull().default(3),\n  completedGames: integer(\"completed_games\").notNull().default(0),\n  mode: varchar(\"mode\").default(\"ladder\"), // 'ladder' | 'challenge' | 'friendly'\n  priority: integer(\"priority\").default(1), // 1-3, higher = more important\n  status: varchar(\"status\").notNull().default(\"pending\"), // 'pending' | 'in_progress' | 'completed'\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  index(\"IDX_training_drills_plan_status\").on(table.planId, table.status),\n]);\n\nexport const insertTrainingDrillSchema = createInsertSchema(trainingDrills).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertTrainingDrill = z.infer<typeof insertTrainingDrillSchema>;\nexport type TrainingDrill = typeof trainingDrills.$inferSelect;\n\n// ============================================================================\n// NEW RELATIONS\n// ============================================================================\n\nexport const playerSyncStateRelations = relations(playerSyncState, ({ one }) => ({\n  user: one(users, {\n    fields: [playerSyncState.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const coachMessagesRelations = relations(coachMessages, ({ one }) => ({\n  user: one(users, {\n    fields: [coachMessages.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const pushAnalysesRelations = relations(pushAnalyses, ({ one, many }) => ({\n  user: one(users, {\n    fields: [pushAnalyses.userId],\n    references: [users.id],\n  }),\n  trainingPlans: many(trainingPlans),\n}));\n\nexport const trainingPlansRelations = relations(trainingPlans, ({ one, many }) => ({\n  user: one(users, {\n    fields: [trainingPlans.userId],\n    references: [users.id],\n  }),\n  pushAnalysis: one(pushAnalyses, {\n    fields: [trainingPlans.pushAnalysisId],\n    references: [pushAnalyses.id],\n  }),\n  drills: many(trainingDrills),\n}));\n\nexport const trainingDrillsRelations = relations(trainingDrills, ({ one }) => ({\n  plan: one(trainingPlans, {\n    fields: [trainingDrills.planId],\n    references: [trainingPlans.id],\n  }),\n}));\n","path":null,"size_bytes":16093,"size_tokens":null},"client/src/hooks/useSettings.ts":{"content":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { api } from '../lib/api';\nimport { toast } from 'sonner';\n\nexport function useSettings() {\n  return useQuery({\n    queryKey: ['settings'],\n    queryFn: () => api.settings.get(),\n  });\n}\n\nexport function useUpdateSettings() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: (data: any) => api.settings.update(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['settings'] });\n      toast.success('Configurações atualizadas com sucesso!');\n    },\n    onError: (error: Error) => {\n      toast.error(`Erro ao atualizar configurações: ${error.message}`);\n    },\n  });\n}\n","path":null,"size_bytes":718,"size_tokens":null},"client/src/components/ui/field.tsx":{"content":"\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field data-[invalid=true]:text-destructive flex w-full gap-3\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px has-[>[data-slot=field-content]]:items-start\",\n        ],\n        responsive: [\n          \"@md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto flex-col [&>*]:w-full [&>.sr-only]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>[data-slot=field]]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm font-normal leading-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"nth-last-2:-mt-1 last:mt-0 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors) {\n      return null\n    }\n\n    if (errors?.length === 1 && errors[0]?.message) {\n      return errors[0].message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n","path":null,"size_bytes":6044,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/pages/profile.tsx":{"content":"import React from \"react\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { mockPlayer } from \"@/lib/mockData\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Crown, CreditCard, Zap } from \"lucide-react\";\n\nexport default function ProfilePage() {\n  return (\n    <DashboardLayout>\n      <div className=\"max-w-2xl mx-auto space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-foreground\">Meu Perfil</h1>\n          <p className=\"text-muted-foreground\">Gerencie sua conta e assinatura</p>\n        </div>\n\n        {/* User Info Card */}\n        <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n          <CardHeader>\n            <CardTitle>Dados Pessoais</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <div className=\"flex items-center gap-4\">\n              <Avatar className=\"w-20 h-20 border-2 border-border\">\n                <AvatarImage src=\"https://github.com/shadcn.png\" />\n                <AvatarFallback>KS</AvatarFallback>\n              </Avatar>\n              <div>\n                <Button variant=\"outline\" size=\"sm\">Alterar Foto</Button>\n              </div>\n            </div>\n\n            <div className=\"grid gap-4\">\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"name\">Nome de Exibição</Label>\n                <Input id=\"name\" defaultValue=\"KingSlayer\" className=\"bg-background/50\" />\n              </div>\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"email\">Email</Label>\n                <Input id=\"email\" defaultValue=\"player@example.com\" disabled className=\"bg-muted\" />\n              </div>\n            </div>\n            \n            <Button>Salvar Alterações</Button>\n          </CardContent>\n        </Card>\n\n        {/* Player Tag Connection */}\n        <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n          <CardHeader>\n            <CardTitle>Conta Clash Royale</CardTitle>\n            <CardDescription>Esta é a conta que estamos monitorando</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center justify-between p-4 border border-border rounded-lg bg-background/30\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-10 h-10 rounded bg-primary/20 flex items-center justify-center\">\n                  <Crown className=\"w-5 h-5 text-primary\" />\n                </div>\n                <div>\n                  <div className=\"font-bold\">{mockPlayer.name}</div>\n                  <div className=\"text-xs font-mono text-muted-foreground\">{mockPlayer.tag}</div>\n                </div>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" className=\"text-destructive hover:text-destructive\">Desconectar</Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Subscription Plan */}\n        <Card className=\"border-primary/20 bg-gradient-to-br from-card/50 to-primary/5 backdrop-blur-sm relative overflow-hidden\">\n          <div className=\"absolute top-0 right-0 p-4 opacity-10\">\n            <Zap className=\"w-24 h-24\" />\n          </div>\n          <CardHeader>\n            <CardTitle className=\"flex items-center justify-between\">\n              Plano Atual\n              <Badge variant=\"outline\" className=\"border-primary text-primary bg-primary/10\">FREE</Badge>\n            </CardTitle>\n            <CardDescription>Você está no plano gratuito básico</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between text-sm\">\n                <span>Mensagens diárias do Coach</span>\n                <span className=\"font-bold\">2 / 5</span>\n              </div>\n              <div className=\"h-2 w-full bg-muted rounded-full overflow-hidden\">\n                <div className=\"h-full bg-primary w-[40%]\" />\n              </div>\n            </div>\n\n            <div className=\"pt-4 border-t border-border/50\">\n              <h4 className=\"font-bold mb-2\">Vantagens do PRO</h4>\n              <ul className=\"text-sm space-y-1 text-muted-foreground mb-4\">\n                <li className=\"flex items-center gap-2\">\n                  <Zap className=\"w-3 h-3 text-primary\" /> Coach de IA ilimitado\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <Zap className=\"w-3 h-3 text-primary\" /> Histórico de batalhas completo\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <Zap className=\"w-3 h-3 text-primary\" /> Análise avançada de decks\n                </li>\n              </ul>\n              <Button className=\"w-full font-bold shadow-lg shadow-primary/20 interactive-hover\">\n                <CreditCard className=\"w-4 h-4 mr-2\" />\n                Fazer Upgrade para PRO\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":5388,"size_tokens":null},"scripts/seed-products.ts":{"content":"// Script to create Stripe products and prices for CRStats\n// Run this script manually when you need to create products:\n// npx tsx scripts/seed-products.ts\n\nimport { getUncachableStripeClient } from '../server/stripeClient';\n\nasync function createProducts() {\n  const stripe = await getUncachableStripeClient();\n\n  console.log('Creating CRStats PRO subscription product...');\n\n  // Check if product already exists\n  const existingProducts = await stripe.products.search({ \n    query: \"name:'CRStats PRO'\" \n  });\n  \n  if (existingProducts.data.length > 0) {\n    console.log('CRStats PRO product already exists:', existingProducts.data[0].id);\n    return;\n  }\n\n  // Create the PRO subscription product\n  const product = await stripe.products.create({\n    name: 'CRStats PRO',\n    description: 'Acesso completo ao Coach IA, análises avançadas e estatísticas detalhadas de Clash Royale',\n    metadata: {\n      tier: 'pro',\n      features: 'ai_coach,advanced_stats,battle_analysis,unlimited_favorites',\n    },\n  });\n\n  console.log('Created product:', product.id);\n\n  // Create monthly price\n  const monthlyPrice = await stripe.prices.create({\n    product: product.id,\n    unit_amount: 1990, // R$19.90 in cents\n    currency: 'brl',\n    recurring: { interval: 'month' },\n    metadata: {\n      plan: 'monthly',\n    },\n  });\n\n  console.log('Created monthly price:', monthlyPrice.id, '- R$19.90/month');\n\n  // Create yearly price (discount)\n  const yearlyPrice = await stripe.prices.create({\n    product: product.id,\n    unit_amount: 15900, // R$159.00 in cents (save 2 months)\n    currency: 'brl',\n    recurring: { interval: 'year' },\n    metadata: {\n      plan: 'yearly',\n    },\n  });\n\n  console.log('Created yearly price:', yearlyPrice.id, '- R$159.00/year');\n\n  console.log('\\nProducts created successfully!');\n  console.log('Monthly Price ID:', monthlyPrice.id);\n  console.log('Yearly Price ID:', yearlyPrice.id);\n}\n\ncreateProducts().catch(console.error);\n","path":null,"size_bytes":1956,"size_tokens":null},"client/src/hooks/useGoals.ts":{"content":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { api } from '../lib/api';\nimport { toast } from 'sonner';\n\nexport function useGoals() {\n  return useQuery({\n    queryKey: ['goals'],\n    queryFn: () => api.goals.list(),\n  });\n}\n\nexport function useCreateGoal() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: (data: any) => api.goals.create(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['goals'] });\n      toast.success('Meta criada com sucesso!');\n    },\n    onError: (error: Error) => {\n      toast.error(`Erro ao criar meta: ${error.message}`);\n    },\n  });\n}\n\nexport function useUpdateGoal() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => api.goals.update(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['goals'] });\n      toast.success('Meta atualizada com sucesso!');\n    },\n    onError: (error: Error) => {\n      toast.error(`Erro ao atualizar meta: ${error.message}`);\n    },\n  });\n}\n\nexport function useDeleteGoal() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: (id: string) => api.goals.delete(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['goals'] });\n      toast.success('Meta deletada com sucesso!');\n    },\n    onError: (error: Error) => {\n      toast.error(`Erro ao deletar meta: ${error.message}`);\n    },\n  });\n}\n","path":null,"size_bytes":1522,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1598,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":2001,"size_tokens":null},"client/src/pages/community.tsx":{"content":"import React from \"react\";\nimport DashboardLayout from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { mockRankings, mockCards } from \"@/lib/mockData\";\nimport { Trophy, TrendingUp, Users, Crown } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function CommunityPage() {\n  return (\n    <DashboardLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-foreground\">Comunidade</h1>\n          <p className=\"text-muted-foreground\">Rankings globais, clãs e meta decks.</p>\n        </div>\n\n        <Tabs defaultValue=\"rankings\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 lg:w-[400px]\">\n            <TabsTrigger value=\"rankings\">Top Jogadores</TabsTrigger>\n            <TabsTrigger value=\"clans\">Top Clãs</TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"rankings\" className=\"mt-6\">\n            <Card className=\"border-border/50 bg-card/50 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Trophy className=\"w-5 h-5 text-yellow-500\" />\n                  Ranking Global\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-0\">\n                <div className=\"divide-y divide-border/50\">\n                  {mockRankings.map((player) => (\n                    <div key={player.rank} className=\"p-4 flex items-center justify-between hover:bg-muted/30 transition-colors\">\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"w-8 h-8 flex items-center justify-center font-bold text-muted-foreground\">\n                          #{player.rank}\n                        </div>\n                        <Avatar className=\"w-10 h-10 border border-border\">\n                          <AvatarFallback>{player.name.substring(0,2).toUpperCase()}</AvatarFallback>\n                        </Avatar>\n                        <div>\n                          <Link href={`/p/${player.tag.replace(\"#\", \"\")}`}>\n                            <div className=\"font-bold cursor-pointer hover:underline\">{player.name}</div>\n                          </Link>\n                          <div className=\"text-xs text-muted-foreground\">{player.clan}</div>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-6 text-right\">\n                        <div className=\"hidden md:block\">\n                          <div className=\"text-xs text-muted-foreground\">Win Rate</div>\n                          <div className=\"font-bold text-green-500\">{player.winRate}%</div>\n                        </div>\n                        <div className=\"flex items-center gap-2 min-w-[100px] justify-end\">\n                          <Trophy className=\"w-4 h-4 text-yellow-500\" />\n                          <span className=\"font-bold font-display\">{player.trophies}</span>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n          \n          <TabsContent value=\"clans\" className=\"mt-6\">\n             <div className=\"flex flex-col items-center justify-center py-12 text-center bg-card/30 rounded-lg border border-border border-dashed\">\n                <Users className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-bold\">Em breve</h3>\n                <p className=\"text-muted-foreground\">O ranking de clãs estará disponível na próxima atualização.</p>\n             </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":4110,"size_tokens":null},"server/storage.ts":{"content":"// From javascript_database and javascript_log_in_with_replit blueprints\nimport {\n  users,\n  profiles,\n  subscriptions,\n  goals,\n  favoritePlayers,\n  notifications,\n  userSettings,\n  playerSyncState,\n  coachMessages,\n  pushAnalyses,\n  trainingPlans,\n  trainingDrills,\n  type User,\n  type UpsertUser,\n  type Profile,\n  type InsertProfile,\n  type Subscription,\n  type InsertSubscription,\n  type Goal,\n  type InsertGoal,\n  type FavoritePlayer,\n  type InsertFavoritePlayer,\n  type Notification,\n  type InsertNotification,\n  type UserSettings,\n  type InsertUserSettings,\n  type PlayerSyncState,\n  type CoachMessage,\n  type InsertCoachMessage,\n  type PushAnalysis,\n  type InsertPushAnalysis,\n  type TrainingPlan,\n  type InsertTrainingPlan,\n  type TrainingDrill,\n  type InsertTrainingDrill,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc, gte, sql } from \"drizzle-orm\";\n\n// Interface for storage operations\nexport interface IStorage {\n  // User operations (Required by Replit Auth)\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  \n  // Profile operations\n  getProfile(userId: string): Promise<Profile | undefined>;\n  createProfile(profile: InsertProfile): Promise<Profile>;\n  updateProfile(userId: string, profile: Partial<InsertProfile>): Promise<Profile | undefined>;\n  \n  // Subscription operations\n  getSubscription(userId: string): Promise<Subscription | undefined>;\n  createSubscription(subscription: InsertSubscription): Promise<Subscription>;\n  updateSubscription(id: string, subscription: Partial<InsertSubscription>): Promise<Subscription | undefined>;\n  getSubscriptionByStripeId(stripeSubscriptionId: string): Promise<Subscription | undefined>;\n  isPro(userId: string): Promise<boolean>;\n  \n  // Goals operations\n  getGoals(userId: string): Promise<Goal[]>;\n  createGoal(goal: InsertGoal): Promise<Goal>;\n  updateGoal(id: string, goal: Partial<InsertGoal>): Promise<Goal | undefined>;\n  deleteGoal(id: string): Promise<void>;\n  \n  // Favorite Players operations\n  getFavoritePlayers(userId: string): Promise<FavoritePlayer[]>;\n  createFavoritePlayer(player: InsertFavoritePlayer): Promise<FavoritePlayer>;\n  deleteFavoritePlayer(id: string): Promise<void>;\n  \n  // Notifications operations\n  getNotifications(userId: string): Promise<Notification[]>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n  markNotificationAsRead(id: string): Promise<void>;\n  deleteNotification(id: string): Promise<void>;\n  \n  // User Settings operations\n  getUserSettings(userId: string): Promise<UserSettings | undefined>;\n  createUserSettings(settings: InsertUserSettings): Promise<UserSettings>;\n  updateUserSettings(userId: string, settings: Partial<InsertUserSettings>): Promise<UserSettings | undefined>;\n  \n  // Player Sync State operations\n  getSyncState(userId: string): Promise<PlayerSyncState | undefined>;\n  updateSyncState(userId: string): Promise<PlayerSyncState>;\n  \n  // Coach Messages operations\n  getCoachMessages(userId: string, limit?: number): Promise<CoachMessage[]>;\n  createCoachMessage(message: InsertCoachMessage): Promise<CoachMessage>;\n  countCoachMessagesToday(userId: string): Promise<number>;\n  \n  // Push Analyses operations\n  getLatestPushAnalysis(userId: string): Promise<PushAnalysis | undefined>;\n  getPushAnalyses(userId: string, limit?: number): Promise<PushAnalysis[]>;\n  createPushAnalysis(analysis: InsertPushAnalysis): Promise<PushAnalysis>;\n  countPushAnalysesToday(userId: string): Promise<number>;\n  \n  // Training Plans operations\n  getActivePlan(userId: string): Promise<TrainingPlan | undefined>;\n  getTrainingPlans(userId: string): Promise<TrainingPlan[]>;\n  createTrainingPlan(plan: InsertTrainingPlan): Promise<TrainingPlan>;\n  updateTrainingPlan(id: string, plan: Partial<InsertTrainingPlan>): Promise<TrainingPlan | undefined>;\n  archiveOldPlans(userId: string): Promise<void>;\n  \n  // Training Drills operations\n  getDrillsByPlan(planId: string): Promise<TrainingDrill[]>;\n  createTrainingDrill(drill: InsertTrainingDrill): Promise<TrainingDrill>;\n  updateTrainingDrill(id: string, drill: Partial<InsertTrainingDrill>): Promise<TrainingDrill | undefined>;\n  countActiveDrills(planId: string): Promise<number>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // ============================================================================\n  // User operations (Required by Replit Auth)\n  // ============================================================================\n  \n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  // ============================================================================\n  // Profile operations\n  // ============================================================================\n  \n  async getProfile(userId: string): Promise<Profile | undefined> {\n    const [profile] = await db.select().from(profiles).where(eq(profiles.userId, userId));\n    return profile;\n  }\n\n  async createProfile(profileData: InsertProfile): Promise<Profile> {\n    const [profile] = await db.insert(profiles).values(profileData).returning();\n    return profile;\n  }\n\n  async updateProfile(userId: string, profileData: Partial<InsertProfile>): Promise<Profile | undefined> {\n    const [profile] = await db\n      .insert(profiles)\n      .values({ userId, ...profileData })\n      .onConflictDoUpdate({\n        target: profiles.userId,\n        set: { ...profileData, updatedAt: new Date() },\n      })\n      .returning();\n    return profile;\n  }\n\n  // ============================================================================\n  // Subscription operations\n  // ============================================================================\n  \n  async getSubscription(userId: string): Promise<Subscription | undefined> {\n    const [subscription] = await db\n      .select()\n      .from(subscriptions)\n      .where(eq(subscriptions.userId, userId))\n      .orderBy(desc(subscriptions.createdAt))\n      .limit(1);\n    return subscription;\n  }\n\n  async createSubscription(subscriptionData: InsertSubscription): Promise<Subscription> {\n    const [subscription] = await db.insert(subscriptions).values(subscriptionData).returning();\n    return subscription;\n  }\n\n  async updateSubscription(id: string, subscriptionData: Partial<InsertSubscription>): Promise<Subscription | undefined> {\n    const [subscription] = await db\n      .update(subscriptions)\n      .set({ ...subscriptionData, updatedAt: new Date() })\n      .where(eq(subscriptions.id, id))\n      .returning();\n    return subscription;\n  }\n\n  async getSubscriptionByStripeId(stripeSubscriptionId: string): Promise<Subscription | undefined> {\n    const [subscription] = await db\n      .select()\n      .from(subscriptions)\n      .where(eq(subscriptions.stripeSubscriptionId, stripeSubscriptionId));\n    return subscription;\n  }\n\n  async isPro(userId: string): Promise<boolean> {\n    const subscription = await this.getSubscription(userId);\n    return subscription?.plan === 'pro' && subscription?.status === 'active';\n  }\n\n  // ============================================================================\n  // Goals operations\n  // ============================================================================\n  \n  async getGoals(userId: string): Promise<Goal[]> {\n    return await db.select().from(goals).where(eq(goals.userId, userId)).orderBy(desc(goals.createdAt));\n  }\n\n  async createGoal(goalData: InsertGoal): Promise<Goal> {\n    const [goal] = await db.insert(goals).values(goalData).returning();\n    return goal;\n  }\n\n  async updateGoal(id: string, goalData: Partial<InsertGoal>): Promise<Goal | undefined> {\n    const [goal] = await db\n      .update(goals)\n      .set({ ...goalData, updatedAt: new Date() })\n      .where(eq(goals.id, id))\n      .returning();\n    return goal;\n  }\n\n  async deleteGoal(id: string): Promise<void> {\n    await db.delete(goals).where(eq(goals.id, id));\n  }\n\n  // ============================================================================\n  // Favorite Players operations\n  // ============================================================================\n  \n  async getFavoritePlayers(userId: string): Promise<FavoritePlayer[]> {\n    return await db.select().from(favoritePlayers).where(eq(favoritePlayers.userId, userId)).orderBy(desc(favoritePlayers.createdAt));\n  }\n\n  async createFavoritePlayer(playerData: InsertFavoritePlayer): Promise<FavoritePlayer> {\n    const [player] = await db.insert(favoritePlayers).values(playerData).returning();\n    return player;\n  }\n\n  async deleteFavoritePlayer(id: string): Promise<void> {\n    await db.delete(favoritePlayers).where(eq(favoritePlayers.id, id));\n  }\n\n  // ============================================================================\n  // Notifications operations\n  // ============================================================================\n  \n  async getNotifications(userId: string): Promise<Notification[]> {\n    return await db.select().from(notifications).where(eq(notifications.userId, userId)).orderBy(desc(notifications.createdAt));\n  }\n\n  async createNotification(notificationData: InsertNotification): Promise<Notification> {\n    const [notification] = await db.insert(notifications).values(notificationData).returning();\n    return notification;\n  }\n\n  async markNotificationAsRead(id: string): Promise<void> {\n    await db.update(notifications).set({ read: true }).where(eq(notifications.id, id));\n  }\n\n  async deleteNotification(id: string): Promise<void> {\n    await db.delete(notifications).where(eq(notifications.id, id));\n  }\n\n  // ============================================================================\n  // User Settings operations\n  // ============================================================================\n  \n  async getUserSettings(userId: string): Promise<UserSettings | undefined> {\n    const [settings] = await db.select().from(userSettings).where(eq(userSettings.userId, userId));\n    return settings;\n  }\n\n  async createUserSettings(settingsData: InsertUserSettings): Promise<UserSettings> {\n    const [settings] = await db.insert(userSettings).values(settingsData).returning();\n    return settings;\n  }\n\n  async updateUserSettings(userId: string, settingsData: Partial<InsertUserSettings>): Promise<UserSettings | undefined> {\n    const [settings] = await db\n      .update(userSettings)\n      .set({ ...settingsData, updatedAt: new Date() })\n      .where(eq(userSettings.userId, userId))\n      .returning();\n    return settings;\n  }\n\n  // ============================================================================\n  // Player Sync State operations\n  // ============================================================================\n  \n  async getSyncState(userId: string): Promise<PlayerSyncState | undefined> {\n    const [state] = await db.select().from(playerSyncState).where(eq(playerSyncState.userId, userId));\n    return state;\n  }\n\n  async updateSyncState(userId: string): Promise<PlayerSyncState> {\n    const [state] = await db\n      .insert(playerSyncState)\n      .values({ userId, lastSyncedAt: new Date() })\n      .onConflictDoUpdate({\n        target: playerSyncState.userId,\n        set: { lastSyncedAt: new Date() },\n      })\n      .returning();\n    return state;\n  }\n\n  // ============================================================================\n  // Coach Messages operations\n  // ============================================================================\n  \n  async getCoachMessages(userId: string, limit: number = 50): Promise<CoachMessage[]> {\n    return await db\n      .select()\n      .from(coachMessages)\n      .where(eq(coachMessages.userId, userId))\n      .orderBy(desc(coachMessages.createdAt))\n      .limit(limit);\n  }\n\n  async createCoachMessage(messageData: InsertCoachMessage): Promise<CoachMessage> {\n    const [message] = await db.insert(coachMessages).values(messageData).returning();\n    return message;\n  }\n\n  async countCoachMessagesToday(userId: string): Promise<number> {\n    const todayStart = new Date();\n    todayStart.setHours(0, 0, 0, 0);\n    \n    const result = await db\n      .select({ count: sql<number>`count(*)::int` })\n      .from(coachMessages)\n      .where(\n        and(\n          eq(coachMessages.userId, userId),\n          eq(coachMessages.role, 'user'),\n          gte(coachMessages.createdAt, todayStart)\n        )\n      );\n    return result[0]?.count || 0;\n  }\n\n  // ============================================================================\n  // Push Analyses operations\n  // ============================================================================\n  \n  async getLatestPushAnalysis(userId: string): Promise<PushAnalysis | undefined> {\n    const [analysis] = await db\n      .select()\n      .from(pushAnalyses)\n      .where(eq(pushAnalyses.userId, userId))\n      .orderBy(desc(pushAnalyses.createdAt))\n      .limit(1);\n    return analysis;\n  }\n\n  async getPushAnalyses(userId: string, limit: number = 10): Promise<PushAnalysis[]> {\n    return await db\n      .select()\n      .from(pushAnalyses)\n      .where(eq(pushAnalyses.userId, userId))\n      .orderBy(desc(pushAnalyses.createdAt))\n      .limit(limit);\n  }\n\n  async createPushAnalysis(analysisData: InsertPushAnalysis): Promise<PushAnalysis> {\n    const [analysis] = await db.insert(pushAnalyses).values(analysisData).returning();\n    return analysis;\n  }\n\n  async countPushAnalysesToday(userId: string): Promise<number> {\n    const todayStart = new Date();\n    todayStart.setHours(0, 0, 0, 0);\n    \n    const result = await db\n      .select({ count: sql<number>`count(*)::int` })\n      .from(pushAnalyses)\n      .where(\n        and(\n          eq(pushAnalyses.userId, userId),\n          gte(pushAnalyses.createdAt, todayStart)\n        )\n      );\n    return result[0]?.count || 0;\n  }\n\n  // ============================================================================\n  // Training Plans operations\n  // ============================================================================\n  \n  async getActivePlan(userId: string): Promise<TrainingPlan | undefined> {\n    const [plan] = await db\n      .select()\n      .from(trainingPlans)\n      .where(\n        and(\n          eq(trainingPlans.userId, userId),\n          eq(trainingPlans.status, 'active')\n        )\n      )\n      .orderBy(desc(trainingPlans.createdAt))\n      .limit(1);\n    return plan;\n  }\n\n  async getTrainingPlans(userId: string): Promise<TrainingPlan[]> {\n    return await db\n      .select()\n      .from(trainingPlans)\n      .where(eq(trainingPlans.userId, userId))\n      .orderBy(desc(trainingPlans.createdAt));\n  }\n\n  async createTrainingPlan(planData: InsertTrainingPlan): Promise<TrainingPlan> {\n    const [plan] = await db.insert(trainingPlans).values(planData).returning();\n    return plan;\n  }\n\n  async updateTrainingPlan(id: string, planData: Partial<InsertTrainingPlan>): Promise<TrainingPlan | undefined> {\n    const [plan] = await db\n      .update(trainingPlans)\n      .set({ ...planData, updatedAt: new Date() })\n      .where(eq(trainingPlans.id, id))\n      .returning();\n    return plan;\n  }\n\n  async archiveOldPlans(userId: string): Promise<void> {\n    await db\n      .update(trainingPlans)\n      .set({ status: 'archived', updatedAt: new Date() })\n      .where(\n        and(\n          eq(trainingPlans.userId, userId),\n          eq(trainingPlans.status, 'active')\n        )\n      );\n  }\n\n  // ============================================================================\n  // Training Drills operations\n  // ============================================================================\n  \n  async getDrillsByPlan(planId: string): Promise<TrainingDrill[]> {\n    return await db\n      .select()\n      .from(trainingDrills)\n      .where(eq(trainingDrills.planId, planId))\n      .orderBy(desc(trainingDrills.priority));\n  }\n\n  async createTrainingDrill(drillData: InsertTrainingDrill): Promise<TrainingDrill> {\n    const [drill] = await db.insert(trainingDrills).values(drillData).returning();\n    return drill;\n  }\n\n  async updateTrainingDrill(id: string, drillData: Partial<InsertTrainingDrill>): Promise<TrainingDrill | undefined> {\n    const [drill] = await db\n      .update(trainingDrills)\n      .set({ ...drillData, updatedAt: new Date() })\n      .where(eq(trainingDrills.id, id))\n      .returning();\n    return drill;\n  }\n\n  async countActiveDrills(planId: string): Promise<number> {\n    const result = await db\n      .select({ count: sql<number>`count(*)::int` })\n      .from(trainingDrills)\n      .where(\n        and(\n          eq(trainingDrills.planId, planId),\n          sql`${trainingDrills.status} != 'completed'`\n        )\n      );\n    return result[0]?.count || 0;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":17075,"size_tokens":null},"client/src/hooks/useClashPlayer.ts":{"content":"import { useQuery } from '@tanstack/react-query';\nimport { api } from '../lib/api';\n\nexport function useClashPlayer(tag: string | null | undefined, enabled = true) {\n  return useQuery({\n    queryKey: ['clash-player', tag],\n    queryFn: () => {\n      if (!tag) throw new Error('Player tag is required');\n      return api.clash.getPlayer(tag);\n    },\n    enabled: enabled && !!tag,\n    staleTime: 5 * 60 * 1000,\n    retry: 1,\n  });\n}\n\nexport function useClashBattles(tag: string | null | undefined, enabled = true) {\n  return useQuery({\n    queryKey: ['clash-battles', tag],\n    queryFn: () => {\n      if (!tag) throw new Error('Player tag is required');\n      return api.clash.getBattles(tag);\n    },\n    enabled: enabled && !!tag,\n    staleTime: 2 * 60 * 1000,\n    retry: 1,\n  });\n}\n\nexport function useClashCards() {\n  return useQuery({\n    queryKey: ['clash-cards'],\n    queryFn: () => api.clash.getCards(),\n    staleTime: 60 * 60 * 1000,\n    retry: 1,\n  });\n}\n","path":null,"size_bytes":963,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"import * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8608,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route, Redirect } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\nimport NotFound from \"@/pages/not-found\";\nimport LandingPage from \"@/pages/landing\";\nimport AuthPage from \"@/pages/auth\";\nimport OnboardingPage from \"@/pages/onboarding\";\nimport DashboardPage from \"@/pages/dashboard\";\nimport CoachPage from \"@/pages/coach\";\nimport ProfilePage from \"@/pages/profile\";\nimport TrainingPage from \"@/pages/training\";\nimport DecksPage from \"@/pages/decks\";\nimport CommunityPage from \"@/pages/community\";\nimport SettingsPage from \"@/pages/settings\";\nimport PublicProfilePage from \"@/pages/public-profile\";\nimport BillingPage from \"@/pages/billing\";\nimport MePage from \"@/pages/me\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  // Show loading state while checking auth\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Carregando...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <Switch>\n      {/* Public routes */}\n      <Route path=\"/\" component={isAuthenticated ? DashboardPage : LandingPage} />\n      <Route path=\"/p/:tag\" component={PublicProfilePage} />\n      \n      {/* Protected routes - redirect to login if not authenticated */}\n      {isAuthenticated ? (\n        <>\n          <Route path=\"/dashboard\" component={DashboardPage} />\n          <Route path=\"/coach\" component={CoachPage} />\n          <Route path=\"/training\" component={TrainingPage} />\n          <Route path=\"/decks\" component={DecksPage} />\n          <Route path=\"/community\" component={CommunityPage} />\n          <Route path=\"/settings\" component={SettingsPage} />\n          <Route path=\"/profile\" component={ProfilePage} />\n          <Route path=\"/onboarding\" component={OnboardingPage} />\n          <Route path=\"/billing\" component={BillingPage} />\n          <Route path=\"/me\" component={MePage} />\n        </>\n      ) : (\n        <>\n          <Route path=\"/dashboard\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/coach\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/training\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/decks\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/community\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/settings\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/profile\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/onboarding\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/billing\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n          <Route path=\"/me\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n        </>\n      )}\n      \n      {/* Legacy auth page - redirect to API login */}\n      <Route path=\"/auth\">{() => { window.location.href = \"/api/login\"; return null; }}</Route>\n      \n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <ErrorBoundary>\n      <QueryClientProvider client={queryClient}>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </QueryClientProvider>\n    </ErrorBoundary>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":3980,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           // @replit: no hover, and add primary border\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          // @replit Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color. Uses shadow-xs. no shadow on active\n          // No hover state\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          // @replit border, no hover, no shadow, secondary border.\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // @replit no hover, transparent border\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        // @replit changed sizes\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2356,"size_tokens":null},"client/src/components/ui/spinner.tsx":{"content":"import { Loader2Icon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Spinner({ className, ...props }: React.ComponentProps<\"svg\">) {\n  return (\n    <Loader2Icon\n      role=\"status\"\n      aria-label=\"Loading\"\n      className={cn(\"size-4 animate-spin\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Spinner }\n","path":null,"size_bytes":331,"size_tokens":null},"server/replitAuth.ts":{"content":"// From javascript_log_in_with_replit blueprint\nimport * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  // Keep track of registered strategies\n  const registeredStrategies = new Set<string>();\n\n  // Helper function to ensure strategy exists for a domain\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","path":null,"size_bytes":4520,"size_tokens":null},"server/webhookHandlers.ts":{"content":"// From Stripe connection integration\nimport { getStripeSync } from './stripeClient';\n\nexport class WebhookHandlers {\n  static async processWebhook(payload: Buffer, signature: string, uuid: string): Promise<void> {\n    if (!Buffer.isBuffer(payload)) {\n      throw new Error(\n        'STRIPE WEBHOOK ERROR: Payload must be a Buffer. ' +\n        'Received type: ' + typeof payload + '. ' +\n        'This usually means express.json() parsed the body before reaching this handler. ' +\n        'FIX: Ensure webhook route is registered BEFORE app.use(express.json()).'\n      );\n    }\n\n    const sync = await getStripeSync();\n    await sync.processWebhook(payload, signature, uuid);\n  }\n}\n","path":null,"size_bytes":682,"size_tokens":null},"server/openai.ts":{"content":"import OpenAI from \"openai\";\n\nconst openai = new OpenAI({\n  baseURL: process.env.AI_INTEGRATIONS_OPENAI_BASE_URL,\n  apiKey: process.env.AI_INTEGRATIONS_OPENAI_API_KEY,\n});\n\nexport interface ChatMessage {\n  role: \"user\" | \"assistant\" | \"system\";\n  content: string;\n}\n\nexport async function generateCoachResponse(\n  messages: ChatMessage[],\n  playerContext?: {\n    playerTag?: string;\n    trophies?: number;\n    arena?: string;\n    currentDeck?: string[];\n    recentBattles?: any[];\n  }\n): Promise<string> {\n  const systemPrompt = `Você é um coach especialista de Clash Royale, ajudando jogadores a melhorar suas habilidades.\n\nSeu papel é:\n- Fornecer dicas estratégicas personalizadas\n- Analisar batalhas e decks\n- Sugerir melhorias de gameplay\n- Explicar matchups e counter-plays\n- Dar conselhos sobre progressão no jogo\n\n${playerContext ? `\nContexto do jogador:\n- Tag: ${playerContext.playerTag || 'Não informado'}\n- Troféus: ${playerContext.trophies || 'Não informado'}\n- Arena: ${playerContext.arena || 'Não informado'}\n${playerContext.currentDeck ? `- Deck atual: ${playerContext.currentDeck.join(', ')}` : ''}\n${playerContext.recentBattles ? `- Batalhas recentes: ${playerContext.recentBattles.length} batalhas registradas` : ''}\n` : ''}\n\nResponda sempre em português brasileiro de forma amigável e educativa. Seja conciso mas informativo.`;\n\n  try {\n    const response = await openai.chat.completions.create({\n      model: \"gpt-4o-mini\",\n      messages: [\n        { role: \"system\", content: systemPrompt },\n        ...messages.map(m => ({ role: m.role, content: m.content })),\n      ],\n      temperature: 0.7,\n      max_tokens: 500,\n    });\n\n    return response.choices[0]?.message?.content || \"Desculpe, não consegui gerar uma resposta. Tente novamente.\";\n  } catch (error) {\n    console.error(\"OpenAI API error:\", error);\n    throw new Error(\"Falha ao gerar resposta do coach\");\n  }\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4887,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1267,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/lib/api.ts":{"content":"// API client utilities for CRStats\n\nconst API_BASE = '/api';\n\nasync function fetchAPI<T>(endpoint: string, options?: RequestInit): Promise<T> {\n  const response = await fetch(`${API_BASE}${endpoint}`, {\n    ...options,\n    headers: {\n      'Content-Type': 'application/json',\n      ...options?.headers,\n    },\n    credentials: 'include',\n  });\n\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: 'Request failed' }));\n    throw new Error(error.message || error.error || `HTTP ${response.status}`);\n  }\n\n  return response.json();\n}\n\nexport const api = {\n  // Auth endpoints\n  auth: {\n    getUser: () => fetchAPI('/auth/user'),\n  },\n\n  // Profile endpoints\n  profile: {\n    get: () => fetchAPI('/profile'),\n    create: (data: any) => fetchAPI('/profile', { method: 'POST', body: JSON.stringify(data) }),\n    update: (data: any) => fetchAPI('/profile', { method: 'PATCH', body: JSON.stringify(data) }),\n  },\n\n  // Subscription endpoints\n  subscription: {\n    get: () => fetchAPI('/subscription'),\n  },\n\n  // Goals endpoints\n  goals: {\n    list: () => fetchAPI('/goals'),\n    create: (data: any) => fetchAPI('/goals', { method: 'POST', body: JSON.stringify(data) }),\n    update: (id: string, data: any) => fetchAPI(`/goals/${id}`, { method: 'PATCH', body: JSON.stringify(data) }),\n    delete: (id: string) => fetchAPI(`/goals/${id}`, { method: 'DELETE' }),\n  },\n\n  // Favorites endpoints\n  favorites: {\n    list: () => fetchAPI('/favorites'),\n    create: (data: any) => fetchAPI('/favorites', { method: 'POST', body: JSON.stringify(data) }),\n    delete: (id: string) => fetchAPI(`/favorites/${id}`, { method: 'DELETE' }),\n  },\n\n  // Notifications endpoints\n  notifications: {\n    list: () => fetchAPI('/notifications'),\n    markRead: (id: string) => fetchAPI(`/notifications/${id}/read`, { method: 'POST' }),\n  },\n\n  // Settings endpoints\n  settings: {\n    get: () => fetchAPI('/settings'),\n    update: (data: any) => fetchAPI('/settings', { method: 'PATCH', body: JSON.stringify(data) }),\n  },\n\n  // Clash Royale API endpoints\n  clash: {\n    getPlayer: (tag: string) => fetchAPI(`/clash/player/${encodeURIComponent(tag)}`),\n    getBattles: (tag: string) => fetchAPI(`/clash/player/${encodeURIComponent(tag)}/battles`),\n    getCards: () => fetchAPI('/clash/cards'),\n  },\n\n  // AI Coach endpoints\n  coach: {\n    chat: (messages: { role: string; content: string }[], playerTag?: string) =>\n      fetchAPI<{ message: string; timestamp: string; remainingMessages?: number }>('/coach/chat', {\n        method: 'POST',\n        body: JSON.stringify({ messages, playerTag }),\n      }),\n  },\n\n  // Stripe billing endpoints\n  stripe: {\n    getConfig: () => fetchAPI<{ publishableKey: string }>('/stripe/config'),\n    getProducts: () => fetchAPI<{ data: any[] }>('/stripe/products'),\n    getPrices: () => fetchAPI<{ data: any[] }>('/stripe/prices'),\n    getProductsWithPrices: () => fetchAPI<{ data: any[] }>('/stripe/products-with-prices'),\n    createCheckout: (priceId: string, currency?: string) =>\n      fetchAPI<{ url: string }>('/stripe/checkout', {\n        method: 'POST',\n        body: JSON.stringify({ priceId, currency }),\n      }),\n    createPortal: () =>\n      fetchAPI<{ url: string }>('/stripe/portal', {\n        method: 'POST',\n      }),\n  },\n};\n","path":null,"size_bytes":3281,"size_tokens":null},"client/src/pages/onboarding.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Hash, Search, Loader2, CheckCircle2, AlertCircle } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api } from \"@/lib/api\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\n\ninterface PlayerData {\n  tag: string;\n  name: string;\n  trophies: number;\n  arena?: { name: string; id: number };\n  clan?: { name: string; tag: string };\n  expLevel: number;\n}\n\nexport default function OnboardingPage() {\n  const [, setLocation] = useLocation();\n  const [tag, setTag] = useState(\"\");\n  const [step, setStep] = useState<\"input\" | \"searching\" | \"confirm\" | \"error\">(\"input\");\n  const [playerData, setPlayerData] = useState<PlayerData | null>(null);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const searchMutation = useMutation({\n    mutationFn: async (playerTag: string) => {\n      const data = await api.clash.getPlayer(playerTag);\n      return data as PlayerData;\n    },\n    onSuccess: (data) => {\n      setPlayerData(data);\n      setStep(\"confirm\");\n    },\n    onError: (error: Error) => {\n      setErrorMessage(error.message || \"Jogador não encontrado. Verifique a tag.\");\n      setStep(\"error\");\n    },\n  });\n\n  const saveMutation = useMutation({\n    mutationFn: async (data: { clashTag: string; displayName: string }) => {\n      return api.profile.update(data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['profile'] });\n      queryClient.invalidateQueries({ queryKey: ['user'] });\n      toast({\n        title: \"Perfil conectado!\",\n        description: \"Carregando suas estatísticas...\",\n      });\n      setTimeout(() => {\n        setLocation(\"/dashboard\");\n      }, 500);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro ao salvar perfil\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    },\n  });\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    let normalizedTag = tag.trim().toUpperCase();\n    if (!normalizedTag.startsWith(\"#\")) {\n      normalizedTag = \"#\" + normalizedTag;\n    }\n    \n    if (normalizedTag.length < 4) {\n      toast({\n        title: \"Tag inválida\",\n        description: \"A tag deve ter pelo menos 3 caracteres além do #\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n    \n    setTag(normalizedTag);\n    setStep(\"searching\");\n    searchMutation.mutate(normalizedTag);\n  };\n\n  const handleConfirm = () => {\n    if (!playerData) return;\n    \n    saveMutation.mutate({\n      clashTag: playerData.tag,\n      displayName: playerData.name,\n    });\n  };\n\n  const handleRetry = () => {\n    setStep(\"input\");\n    setErrorMessage(\"\");\n    setPlayerData(null);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col items-center justify-center p-4\">\n      <div className=\"w-full max-w-lg animate-in fade-in slide-in-from-bottom-8 duration-500\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"font-display text-3xl font-bold mb-2\">Conecte seu Perfil</h1>\n          <p className=\"text-muted-foreground\">\n            Precisamos da sua Tag de Jogador para analisar suas batalhas.\n          </p>\n        </div>\n\n        <Card className=\"border-border/50 shadow-2xl\">\n          <CardHeader>\n            <CardTitle>Buscar Jogador</CardTitle>\n            <CardDescription>\n              Você pode encontrar sua tag no seu perfil dentro do jogo, logo abaixo do seu nome.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {step === \"input\" && (\n              <form onSubmit={handleSearch} className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"tag\">Player Tag</Label>\n                  <div className=\"relative\">\n                    <Hash className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                    <Input \n                      id=\"tag\" \n                      placeholder=\"2P090J0\" \n                      className=\"pl-9 font-mono uppercase\"\n                      value={tag.replace(\"#\", \"\")}\n                      onChange={(e) => setTag(e.target.value.toUpperCase().replace(\"#\", \"\"))}\n                      data-testid=\"input-player-tag\"\n                    />\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">Ex: #2P090J0 ou 2P090J0</p>\n                </div>\n                <Button type=\"submit\" className=\"w-full h-11\" data-testid=\"button-search-player\">\n                  <Search className=\"w-4 h-4 mr-2\" />\n                  Buscar Perfil\n                </Button>\n              </form>\n            )}\n\n            {step === \"searching\" && (\n              <div className=\"py-8 flex flex-col items-center justify-center text-center space-y-4\">\n                <Loader2 className=\"w-10 h-10 animate-spin text-primary\" />\n                <p className=\"text-sm text-muted-foreground\">Buscando dados na Supercell...</p>\n              </div>\n            )}\n\n            {step === \"error\" && (\n              <div className=\"space-y-6 animate-in fade-in\">\n                <div className=\"flex items-center gap-4 p-4 rounded-lg bg-destructive/10 border border-destructive/20\">\n                  <AlertCircle className=\"w-8 h-8 text-destructive shrink-0\" />\n                  <div>\n                    <h3 className=\"font-bold text-lg text-destructive\">Jogador não encontrado</h3>\n                    <p className=\"text-sm text-muted-foreground\">{errorMessage}</p>\n                  </div>\n                </div>\n                <Button variant=\"outline\" className=\"w-full\" onClick={handleRetry} data-testid=\"button-retry-search\">\n                  Tentar novamente\n                </Button>\n              </div>\n            )}\n\n            {step === \"confirm\" && playerData && (\n              <div className=\"space-y-6 animate-in fade-in\">\n                <div className=\"flex items-center gap-4 p-4 rounded-lg bg-secondary/10 border border-secondary/20\">\n                  <div className=\"w-12 h-12 rounded bg-secondary/20 flex items-center justify-center text-2xl\">\n                    👑\n                  </div>\n                  <div>\n                    <h3 className=\"font-bold text-lg\" data-testid=\"text-player-name\">{playerData.name}</h3>\n                    <p className=\"text-sm text-muted-foreground\">Tag: {playerData.tag}</p>\n                    <p className=\"text-xs text-primary font-medium mt-1\">\n                      {playerData.arena?.name || 'Arena'} • {playerData.trophies} Troféus\n                    </p>\n                    {playerData.clan && (\n                      <p className=\"text-xs text-muted-foreground mt-0.5\">\n                        Clan: {playerData.clan.name}\n                      </p>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"flex gap-3\">\n                  <Button variant=\"outline\" className=\"flex-1\" onClick={handleRetry} data-testid=\"button-not-me\">\n                    Não sou eu\n                  </Button>\n                  <Button \n                    className=\"flex-1\" \n                    onClick={handleConfirm}\n                    disabled={saveMutation.isPending}\n                    data-testid=\"button-confirm-player\"\n                  >\n                    {saveMutation.isPending ? (\n                      <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\n                    ) : (\n                      <CheckCircle2 className=\"w-4 h-4 mr-2\" />\n                    )}\n                    Confirmar\n                  </Button>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <div className=\"mt-8 text-center\">\n          <p className=\"text-xs text-muted-foreground\">\n            Não tem o jogo instalado?{\" \"}\n            <a \n              href=\"https://supercell.com/en/games/clashroyale/\" \n              target=\"_blank\" \n              rel=\"noopener noreferrer\"\n              className=\"underline hover:text-foreground\"\n            >\n              Baixar Clash Royale\n            </a>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":8530,"size_tokens":null},"shared/pricing.ts":{"content":"import type { Locale, SupportedCurrency } from './i18n';\n\nexport interface PricingPlan {\n  monthlyPrice: number;\n  yearlyPrice: number;\n  monthlyPriceId: string;\n  yearlyPriceId: string;\n  currency: SupportedCurrency;\n  symbol: string;\n  locale: string;\n}\n\nexport const PRICING: Record<SupportedCurrency, PricingPlan> = {\n  BRL: {\n    monthlyPrice: 49.90,\n    yearlyPrice: 399.00,\n    monthlyPriceId: 'price_1SdgN5CnrOGKyenCuyccxmyj',\n    yearlyPriceId: 'price_1SdgN5CnrOGKyenCIuDeQl5A',\n    currency: 'BRL',\n    symbol: 'R$',\n    locale: 'pt-BR',\n  },\n  USD: {\n    monthlyPrice: 10.00,\n    yearlyPrice: 80.00,\n    monthlyPriceId: 'price_1SdwJRCnrOGKyenCp6kzFRYo',\n    yearlyPriceId: 'price_1SdwJSCnrOGKyenCSagffo1v',\n    currency: 'USD',\n    symbol: '$',\n    locale: 'en-US',\n  },\n  EUR: {\n    monthlyPrice: 9.00,\n    yearlyPrice: 72.00,\n    monthlyPriceId: 'price_1SdwJSCnrOGKyenCRrOmhorG',\n    yearlyPriceId: 'price_1SdwJSCnrOGKyenCCj30dZj5',\n    currency: 'EUR',\n    symbol: '€',\n    locale: 'de-DE',\n  },\n};\n\nexport function getPricing(currency: SupportedCurrency): PricingPlan {\n  return PRICING[currency] || PRICING.BRL;\n}\n\nexport function formatPrice(amount: number, currency: SupportedCurrency): string {\n  const plan = PRICING[currency];\n  \n  try {\n    return new Intl.NumberFormat(plan.locale, {\n      style: 'currency',\n      currency: currency,\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(amount);\n  } catch {\n    return `${plan.symbol}${amount.toFixed(2)}`;\n  }\n}\n\nexport function getYearlySavingsPercent(currency: SupportedCurrency): number {\n  const plan = PRICING[currency];\n  const monthlyTotal = plan.monthlyPrice * 12;\n  const savings = ((monthlyTotal - plan.yearlyPrice) / monthlyTotal) * 100;\n  return Math.round(savings);\n}\n\nexport function getCurrencyFromLocale(locale: Locale): SupportedCurrency {\n  switch (locale) {\n    case 'pt-BR':\n      return 'BRL';\n    case 'en-US':\n    default:\n      return 'USD';\n  }\n}\n\nexport const SUPPORTED_CURRENCIES: SupportedCurrency[] = ['BRL', 'USD', 'EUR'];\n","path":null,"size_bytes":2055,"size_tokens":null},"client/src/lib/clashIcons.ts":{"content":"const ROYALE_API_CDN = 'https://cdn.royaleapi.com/static';\n\nexport function getCardImageUrl(cardName: string, size: 'small' | 'medium' | 'large' = 'medium'): string {\n  const slug = cardName\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-|-$/g, '');\n  \n  const sizeMap = {\n    small: 'cards-75',\n    medium: 'cards-150',\n    large: 'cards',\n  };\n  \n  return `${ROYALE_API_CDN}/${sizeMap[size]}/${slug}.png`;\n}\n\nexport function getCardImageFromApi(iconUrl?: { medium?: string; small?: string }): string | null {\n  return iconUrl?.medium || iconUrl?.small || null;\n}\n\nexport function getArenaImageUrl(arenaId: number): string {\n  return `${ROYALE_API_CDN}/arenas/arena${arenaId}.png`;\n}\n\nexport function getArenaImageByName(arenaName: string): string {\n  const arenaMap: Record<string, number> = {\n    'Goblin Stadium': 1,\n    'Bone Pit': 2,\n    'Barbarian Bowl': 3,\n    \"P.E.K.K.A's Playhouse\": 4,\n    'Spell Valley': 5,\n    \"Builder's Workshop\": 6,\n    'Royal Arena': 7,\n    'Frozen Peak': 8,\n    'Jungle Arena': 9,\n    'Hog Mountain': 10,\n    'Electro Valley': 11,\n    'Spooky Town': 12,\n    'Rascals Hideout': 13,\n    'Serenity Peak': 14,\n    \"Miner's Mine\": 15,\n    \"Executioner's Kitchen\": 16,\n    'Royal Crypt': 17,\n    'Silent Sanctuary': 18,\n    'Dragon Spa': 19,\n    'Boot Camp': 20,\n    'Clash Fest': 21,\n    'Legendary Arena': 22,\n  };\n  \n  const arenaId = arenaMap[arenaName] || 1;\n  return getArenaImageUrl(arenaId);\n}\n\nexport function getGameModeIcon(gameMode: string): string {\n  const modeIcons: Record<string, string> = {\n    'Ladder': '🏆',\n    'PathOfLegend': '⚔️',\n    'Challenge': '🎯',\n    'Tournament': '🏅',\n    'ClanWar': '⚔️',\n    'Friendly': '🤝',\n    'SpecialEvent': '🎉',\n    '2v2': '👥',\n    'Draft': '🎲',\n    'TripleDraft': '🎲',\n    'SuddenDeath': '💀',\n    'DoubleElixir': '💧',\n    'TripleElixir': '💧💧',\n    'Rage': '😡',\n    'Mirror': '🪞',\n  };\n  \n  return modeIcons[gameMode] || '🎮';\n}\n\nexport function getClanBadgeUrl(badgeId: number): string {\n  return `${ROYALE_API_CDN}/badges/${badgeId}.png`;\n}\n\nexport function getLeagueImageUrl(league: string): string {\n  const leagueSlug = league\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-|-$/g, '');\n  \n  return `${ROYALE_API_CDN}/leagues/${leagueSlug}.png`;\n}\n\nexport function getCardRarityColor(rarity: string): string {\n  const colors: Record<string, string> = {\n    'Common': '#B0B0B0',\n    'Rare': '#FFA500',\n    'Epic': '#9B30FF',\n    'Legendary': '#FFD700',\n    'Champion': '#00BFFF',\n  };\n  \n  return colors[rarity] || '#FFFFFF';\n}\n\nexport function getElixirCostColor(cost: number): string {\n  if (cost <= 2) return '#4CAF50';\n  if (cost <= 4) return '#2196F3';\n  if (cost <= 6) return '#9C27B0';\n  return '#F44336';\n}\n\nexport const CARD_BACK_URL = `${ROYALE_API_CDN}/cards-150/card-back.png`;\n","path":null,"size_bytes":2870,"size_tokens":null},"client/src/hooks/use-locale.ts":{"content":"import { useState, useEffect, useMemo } from 'react';\nimport { \n  type Locale, \n  type SupportedCurrency,\n  DEFAULT_LOCALE,\n  t,\n  getTranslations,\n  detectLocale,\n  supportedLocales,\n  localeNames\n} from '@shared/i18n';\nimport { getPricing, formatPrice, getYearlySavingsPercent, getCurrencyFromLocale } from '@shared/pricing';\n\nexport function useLocale() {\n  const [locale, setLocale] = useState<Locale>(() => {\n    if (typeof window !== 'undefined') {\n      const stored = localStorage.getItem('locale');\n      if (stored && supportedLocales.includes(stored as Locale)) {\n        return stored as Locale;\n      }\n      return detectLocale(navigator.language);\n    }\n    return DEFAULT_LOCALE;\n  });\n\n  const [currency, setCurrency] = useState<SupportedCurrency>(() => {\n    if (typeof window !== 'undefined') {\n      const stored = localStorage.getItem('currency');\n      if (stored && ['BRL', 'USD', 'EUR'].includes(stored)) {\n        return stored as SupportedCurrency;\n      }\n    }\n    return getCurrencyFromLocale(locale);\n  });\n\n  useEffect(() => {\n    localStorage.setItem('locale', locale);\n    document.documentElement.lang = locale;\n  }, [locale]);\n\n  useEffect(() => {\n    localStorage.setItem('currency', currency);\n  }, [currency]);\n\n  const translations = useMemo(() => getTranslations(locale), [locale]);\n  const pricing = useMemo(() => getPricing(currency), [currency]);\n\n  const translate = (key: string, params?: Record<string, string | number>): string => {\n    return t(key, locale, params);\n  };\n\n  const format = (amount: number): string => {\n    return formatPrice(amount, currency);\n  };\n\n  const savingsPercent = useMemo(() => getYearlySavingsPercent(currency), [currency]);\n\n  return {\n    locale,\n    setLocale,\n    currency,\n    setCurrency,\n    t: translate,\n    translations,\n    pricing,\n    formatPrice: format,\n    savingsPercent,\n    supportedLocales,\n    localeNames,\n  };\n}\n\nexport type LocaleContextType = ReturnType<typeof useLocale>;\n","path":null,"size_bytes":1976,"size_tokens":null},"shared/i18n/index.ts":{"content":"import ptBR from './translations/pt-BR.json';\nimport enUS from './translations/en-US.json';\n\nexport type Locale = 'pt-BR' | 'en-US';\nexport type SupportedCurrency = 'BRL' | 'USD' | 'EUR';\n\nconst translations: Record<Locale, typeof ptBR> = {\n  'pt-BR': ptBR,\n  'en-US': enUS,\n};\n\nexport const DEFAULT_LOCALE: Locale = 'pt-BR';\n\nexport function detectLocale(acceptLanguage?: string | null): Locale {\n  if (!acceptLanguage) return DEFAULT_LOCALE;\n  \n  const normalized = acceptLanguage.toLowerCase();\n  \n  if (normalized.startsWith('pt')) return 'pt-BR';\n  if (normalized.startsWith('en')) return 'en-US';\n  \n  const parts = acceptLanguage.split(',');\n  for (const part of parts) {\n    const lang = part.split(';')[0].trim().toLowerCase();\n    if (lang.startsWith('pt')) return 'pt-BR';\n    if (lang.startsWith('en')) return 'en-US';\n  }\n  \n  return DEFAULT_LOCALE;\n}\n\nexport function detectCurrency(locale: Locale): SupportedCurrency {\n  switch (locale) {\n    case 'pt-BR':\n      return 'BRL';\n    case 'en-US':\n    default:\n      return 'USD';\n  }\n}\n\nexport function getCurrencyFromTimezone(): SupportedCurrency {\n  try {\n    const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;\n    if (tz.startsWith('America/Sao_Paulo') || tz.includes('Brazil')) return 'BRL';\n    if (tz.startsWith('Europe/')) return 'EUR';\n    return 'USD';\n  } catch {\n    return 'USD';\n  }\n}\n\ntype NestedKeyOf<T> = T extends object\n  ? { [K in keyof T]: K extends string \n      ? T[K] extends object \n        ? `${K}.${NestedKeyOf<T[K]>}` | K\n        : K \n      : never \n    }[keyof T]\n  : never;\n\ntype TranslationKey = NestedKeyOf<typeof ptBR>;\n\nfunction getNestedValue(obj: any, path: string): string | undefined {\n  const keys = path.split('.');\n  let current = obj;\n  for (const key of keys) {\n    if (current === undefined || current === null) return undefined;\n    current = current[key];\n  }\n  return typeof current === 'string' ? current : undefined;\n}\n\nexport function t(\n  key: string,\n  locale: Locale = DEFAULT_LOCALE,\n  params?: Record<string, string | number>\n): string {\n  const translation = translations[locale] || translations[DEFAULT_LOCALE];\n  let value = getNestedValue(translation, key);\n  \n  if (!value) {\n    value = getNestedValue(translations[DEFAULT_LOCALE], key);\n  }\n  \n  if (!value) {\n    console.warn(`Missing translation for key: ${key}`);\n    return key;\n  }\n  \n  if (params) {\n    return value.replace(/\\{(\\w+)\\}/g, (_, paramKey) => {\n      return params[paramKey]?.toString() ?? `{${paramKey}}`;\n    });\n  }\n  \n  return value;\n}\n\nexport function getTranslations(locale: Locale = DEFAULT_LOCALE) {\n  return translations[locale] || translations[DEFAULT_LOCALE];\n}\n\nexport const localeNames: Record<Locale, string> = {\n  'pt-BR': 'Português (Brasil)',\n  'en-US': 'English (US)',\n};\n\nexport const supportedLocales: Locale[] = ['pt-BR', 'en-US'];\n","path":null,"size_bytes":2857,"size_tokens":null},"client/src/hooks/usePlayerSync.ts":{"content":"import { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\n\ninterface SyncData {\n  player: any;\n  battles: any[];\n  pushSessions: any[];\n  stats: {\n    totalMatches: number;\n    wins: number;\n    losses: number;\n    winRate: number;\n    streak: { type: 'wins' | 'losses' | 'none'; count: number };\n    tiltLevel: 'high' | 'medium' | 'none';\n  };\n  lastSyncedAt: string;\n  goals: any[];\n}\n\nexport function usePlayerSync() {\n  const queryClient = useQueryClient();\n  \n  const syncStateQuery = useQuery({\n    queryKey: [\"syncState\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/player/sync-state\", { credentials: \"include\" });\n      if (!res.ok) return null;\n      return res.json();\n    },\n  });\n\n  const syncMutation = useMutation({\n    mutationFn: async (): Promise<SyncData> => {\n      const res = await fetch(\"/api/player/sync\", {\n        method: \"POST\",\n        credentials: \"include\",\n      });\n      if (!res.ok) {\n        const error = await res.json();\n        throw new Error(error.error || \"Sync failed\");\n      }\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"syncState\"] });\n      queryClient.invalidateQueries({ queryKey: [\"clashPlayer\"] });\n      queryClient.invalidateQueries({ queryKey: [\"clashBattles\"] });\n      queryClient.invalidateQueries({ queryKey: [\"goals\"] });\n    },\n  });\n\n  return {\n    syncState: syncStateQuery.data,\n    isSyncing: syncMutation.isPending,\n    syncError: syncMutation.error,\n    syncData: syncMutation.data,\n    sync: syncMutation.mutate,\n    lastSyncedAt: syncStateQuery.data?.lastSyncedAt,\n  };\n}\n","path":null,"size_bytes":1641,"size_tokens":null},"scripts/create-stripe-prices.ts":{"content":"import Stripe from 'stripe';\n\nasync function getCredentials() {\n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME;\n  const xReplitToken = process.env.REPL_IDENTITY\n    ? 'repl ' + process.env.REPL_IDENTITY\n    : process.env.WEB_REPL_RENEWAL\n      ? 'depl ' + process.env.WEB_REPL_RENEWAL\n      : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  const connectorName = 'stripe';\n  const targetEnvironment = 'development';\n\n  const url = new URL(`https://${hostname}/api/v2/connection`);\n  url.searchParams.set('include_secrets', 'true');\n  url.searchParams.set('connector_names', connectorName);\n  url.searchParams.set('environment', targetEnvironment);\n\n  const response = await fetch(url.toString(), {\n    headers: {\n      'Accept': 'application/json',\n      'X_REPLIT_TOKEN': xReplitToken\n    }\n  });\n\n  const data = await response.json();\n  const connectionSettings = data.items?.[0];\n\n  if (!connectionSettings || !connectionSettings.settings.secret) {\n    throw new Error('Stripe connection not found');\n  }\n\n  return connectionSettings.settings.secret;\n}\n\nasync function main() {\n  console.log('Getting Stripe credentials...');\n  const secretKey = await getCredentials();\n  const stripe = new Stripe(secretKey);\n\n  console.log('Looking for existing CRStats PRO product...');\n  \n  const products = await stripe.products.list({ limit: 100 });\n  let product = products.data.find(p => p.name === 'CRStats PRO');\n\n  if (!product) {\n    console.log('Creating CRStats PRO product...');\n    product = await stripe.products.create({\n      name: 'CRStats PRO',\n      description: 'Premium coaching and analytics for Clash Royale',\n    });\n    console.log('Product created:', product.id);\n  } else {\n    console.log('Product found:', product.id);\n  }\n\n  const pricesToCreate = [\n    { currency: 'usd', amount: 1000, interval: 'month', name: 'USD Monthly' },\n    { currency: 'usd', amount: 8000, interval: 'year', name: 'USD Yearly' },\n    { currency: 'eur', amount: 900, interval: 'month', name: 'EUR Monthly' },\n    { currency: 'eur', amount: 7200, interval: 'year', name: 'EUR Yearly' },\n  ];\n\n  const createdPrices: Record<string, string> = {};\n\n  for (const priceData of pricesToCreate) {\n    console.log(`Creating ${priceData.name} price...`);\n    \n    const price = await stripe.prices.create({\n      product: product.id,\n      currency: priceData.currency,\n      unit_amount: priceData.amount,\n      recurring: {\n        interval: priceData.interval as 'month' | 'year',\n      },\n      nickname: priceData.name,\n    });\n\n    const key = `${priceData.currency.toUpperCase()}_${priceData.interval === 'month' ? 'monthly' : 'yearly'}`;\n    createdPrices[key] = price.id;\n    console.log(`  ${priceData.name}: ${price.id}`);\n  }\n\n  console.log('\\n=== CREATED PRICE IDS ===');\n  console.log('USD Monthly:', createdPrices.USD_monthly);\n  console.log('USD Yearly:', createdPrices.USD_yearly);\n  console.log('EUR Monthly:', createdPrices.EUR_monthly);\n  console.log('EUR Yearly:', createdPrices.EUR_yearly);\n  console.log('\\nUpdate these in shared/pricing.ts!');\n}\n\nmain().catch(console.error);\n","path":null,"size_bytes":3147,"size_tokens":null},"client/src/components/ErrorBoundary.tsx":{"content":"import React, { Component, ErrorInfo, ReactNode } from 'react';\nimport { AlertCircle, RefreshCw } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  public state: State = {\n    hasError: false,\n  };\n\n  public static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\n  }\n\n  private handleRetry = () => {\n    this.setState({ hasError: false, error: undefined });\n  };\n\n  public render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      return (\n        <div className=\"min-h-[400px] flex items-center justify-center p-6\">\n          <Card className=\"max-w-md w-full border-destructive/50 bg-destructive/5\">\n            <CardContent className=\"pt-6\">\n              <div className=\"flex flex-col items-center text-center gap-4\">\n                <div className=\"w-12 h-12 rounded-full bg-destructive/10 flex items-center justify-center\">\n                  <AlertCircle className=\"w-6 h-6 text-destructive\" />\n                </div>\n                <div className=\"space-y-2\">\n                  <h3 className=\"font-semibold text-lg\">Algo deu errado</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Ocorreu um erro inesperado. Tente novamente ou recarregue a página.\n                  </p>\n                  {this.state.error && (\n                    <p className=\"text-xs text-destructive/70 font-mono bg-destructive/10 p-2 rounded\">\n                      {this.state.error.message}\n                    </p>\n                  )}\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button variant=\"outline\" onClick={this.handleRetry}>\n                    <RefreshCw className=\"w-4 h-4 mr-2\" />\n                    Tentar novamente\n                  </Button>\n                  <Button variant=\"ghost\" onClick={() => window.location.reload()}>\n                    Recarregar página\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;\n","path":null,"size_bytes":2580,"size_tokens":null},"client/src/components/SyncButton.tsx":{"content":"import { RefreshCw } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ptBR, enUS } from \"date-fns/locale\";\nimport { Button } from \"@/components/ui/button\";\nimport { Spinner } from \"@/components/ui/spinner\";\nimport { usePlayerSync } from \"@/hooks/usePlayerSync\";\nimport { useLocale } from \"@/hooks/use-locale\";\n\ninterface SyncButtonProps {\n  variant?: \"default\" | \"outline\" | \"secondary\" | \"ghost\";\n  size?: \"default\" | \"sm\" | \"lg\";\n  showLastSync?: boolean;\n  className?: string;\n}\n\nexport function SyncButton({ \n  variant = \"outline\", \n  size = \"default\",\n  showLastSync = true,\n  className \n}: SyncButtonProps) {\n  const { sync, isSyncing, lastSyncedAt } = usePlayerSync();\n  const { t, locale } = useLocale();\n\n  const handleSync = () => {\n    sync(undefined, {\n      onSuccess: () => {\n        toast.success(t(\"sync.success\"));\n      },\n      onError: (error) => {\n        toast.error(t(\"sync.error\"), {\n          description: error.message,\n        });\n      },\n    });\n  };\n\n  const getRelativeTime = () => {\n    if (!lastSyncedAt) return t(\"sync.never\");\n    \n    try {\n      const date = new Date(lastSyncedAt);\n      const distance = formatDistanceToNow(date, { \n        addSuffix: false,\n        locale: locale === \"pt-BR\" ? ptBR : enUS \n      });\n      return t(\"sync.lastSync\", { time: distance });\n    } catch {\n      return t(\"sync.never\");\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col items-start gap-1\">\n      <Button\n        variant={variant}\n        size={size}\n        onClick={handleSync}\n        disabled={isSyncing}\n        className={className}\n        data-testid=\"button-sync\"\n      >\n        {isSyncing ? (\n          <>\n            <Spinner className=\"mr-1\" />\n            <span data-testid=\"text-syncing\">{t(\"sync.syncing\")}</span>\n          </>\n        ) : (\n          <>\n            <RefreshCw className=\"h-4 w-4 mr-1\" />\n            <span data-testid=\"text-sync-label\">{t(\"sync.button\")}</span>\n          </>\n        )}\n      </Button>\n      {showLastSync && lastSyncedAt && (\n        <span \n          className=\"text-xs text-muted-foreground\" \n          data-testid=\"text-last-sync\"\n        >\n          {getRelativeTime()}\n        </span>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":2270,"size_tokens":null},"client/src/components/TiltAlert.tsx":{"content":"import { AlertTriangle, AlertCircle, CheckCircle } from \"lucide-react\";\nimport { Alert, AlertTitle, AlertDescription } from \"@/components/ui/alert\";\nimport { useLocale } from \"@/hooks/use-locale\";\nimport { cn } from \"@/lib/utils\";\n\ninterface TiltAlertProps {\n  tiltLevel: 'high' | 'medium' | 'none';\n  consecutiveLosses?: number;\n  className?: string;\n}\n\nexport function TiltAlert({ tiltLevel, consecutiveLosses, className }: TiltAlertProps) {\n  const { t } = useLocale();\n\n  if (tiltLevel === 'none') {\n    return (\n      <Alert\n        className={cn(\n          \"border-green-500/50 bg-green-500/10 text-green-700 dark:text-green-400\",\n          className\n        )}\n        data-testid=\"alert-tilt-none\"\n      >\n        <CheckCircle className=\"h-4 w-4\" />\n        <AlertTitle data-testid=\"text-tilt-title\">{t(\"tilt.noTilt\")}</AlertTitle>\n        <AlertDescription data-testid=\"text-tilt-description\">\n          {t(\"tilt.noTiltDesc\")}\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  if (tiltLevel === 'medium') {\n    return (\n      <Alert\n        className={cn(\n          \"border-yellow-500/50 bg-yellow-500/10 text-yellow-700 dark:text-yellow-400\",\n          className\n        )}\n        data-testid=\"alert-tilt-medium\"\n      >\n        <AlertCircle className=\"h-4 w-4\" />\n        <AlertTitle data-testid=\"text-tilt-title\">{t(\"tilt.alertMedium\")}</AlertTitle>\n        <AlertDescription data-testid=\"text-tilt-description\">\n          {t(\"tilt.alertMediumDesc\")}\n          {consecutiveLosses && consecutiveLosses > 0 && (\n            <span className=\"block mt-1 font-medium\" data-testid=\"text-consecutive-losses\">\n              {t(\"tilt.consecutiveLosses\", { n: consecutiveLosses })}\n            </span>\n          )}\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  return (\n    <Alert\n      variant=\"destructive\"\n      className={cn(\n        \"border-red-500/50 bg-red-500/10\",\n        className\n      )}\n      data-testid=\"alert-tilt-high\"\n    >\n      <AlertTriangle className=\"h-4 w-4\" />\n      <AlertTitle data-testid=\"text-tilt-title\">{t(\"tilt.alertHigh\")}</AlertTitle>\n      <AlertDescription data-testid=\"text-tilt-description\">\n        {t(\"tilt.alertHighDesc\")}\n        {consecutiveLosses && consecutiveLosses > 0 && (\n          <span className=\"block mt-1 font-medium\" data-testid=\"text-consecutive-losses\">\n            {t(\"tilt.consecutiveLosses\", { n: consecutiveLosses })}\n          </span>\n        )}\n      </AlertDescription>\n    </Alert>\n  );\n}\n","path":null,"size_bytes":2475,"size_tokens":null}},"version":2}